<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
      
        <title>PyGame - DesSoft - Design de Software</title>
      
    
    <link rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Fira+Sans+Extra+Condensed:700|Oxygen+Mono|Source+Sans+Pro:700|Source+Serif+Pro&amp;display=swap">
    <link rel="stylesheet" href="../../assets/css/main.css">
    <script>
      // SETUP GLOBAL CONSTANTS
      var base_url = '../..';
      
      var telemetryEnabled = false;
      var backendUrl = "";
      var courseSlug = "";
      
      
      var dashboardEnabled = false;
      var tagTree = {};
      

      // SETUP PLUGIN
      window.initialized = false;
      if (!window.initializers) window.initializers = [];
      window.registerInitializer = (initialize) => {
        if (window.initialized) initialize();
        else window.initializers.push(initialize);
      };
    </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true
        }
      });
    </script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="https://unpkg.com/hyperscript.org"></script>
    <script src="https://unpkg.com/htmx.org@1.8.4"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="../../assets/js/main.js"></script>
    
    <link rel="stylesheet" href="../../css/termynal.css"><link rel="stylesheet" href="../../css/custom.css">
  </head>
  <body>
    <div class="ah-main-container">
      <header class="ah-header">
        <button class="ah-menu-btn ah-button ah-button--borderless"
                aria-label="toggle menu">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
  <!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
  <path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/>
</svg>
        </button>
        <a href="../.."
           title="DesSoft - Design de Software"
           class="ah-logo"
           aria-label="DesSoft - Design de Software">
          DesSoft - Design de Software
        </a>
        <div class="ah-header--right">
          
          
          
          <button id="resetHandoutButton">
            <span class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
  <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"/>
</svg></span>
          </button>
          

          
        </div>
      </header>
      <nav class="ah-navigation preload">
        <div class="ah-nav-container">
          <button class="ah-menu-btn ah-button ah-button--borderless close-menu"
                  aria-label="close menu">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512">
  <!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
  <path d="M310.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L160 210.7 54.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L114.7 256 9.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 301.3 265.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L205.3 256 310.6 150.6z"/>
</svg>
          </button>
          <ul class="ah-nav-body">
            
              
  
    <li>
      <a href="../..">Home</a>
    </li>
  

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Informações</span>
    <ul>
      
        
  
    <li>
      <a href="../../about/">Composição da Nota</a>
    </li>
  

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item opened">
    <span class="ah-togglable-handle">Conteúdo</span>
    <ul>
      
        
  
    <li>
      <a href="../../introducao/handout/">Introdução</a>
    </li>
  

      
        
  
    <li>
      <a href="../../funcao/handout/">Funções</a>
    </li>
  

      
        
  
    <li>
      <a href="../../input/handout/">Entrada e saída</a>
    </li>
  

      
        
  
    <li>
      <a href="../../if/handout/">Desvios condicionais (if)</a>
    </li>
  

      
        
  
    <li>
      <a href="../../while/handout/">Laços de Repetição (while)</a>
    </li>
  

      
        
  
    <li>
      <a href="../../lista/handout/">Armazenamento de dados em listas</a>
    </li>
  

      
        
  
    <li>
      <a href="../../for/handout/">Iterando em coleções com "for"</a>
    </li>
  

      
        
  
    <li>
      <a href="../../dicionario/handout/">Armazenamento em dicionários</a>
    </li>
  

      
        
  
    <li>
      <a href="../../string/handout/">Strings e Fatiamento</a>
    </li>
  

      
        
  
    <li>
      <a href="../../arquivo/handout/">Armazenamento permanente em arquivos</a>
    </li>
  

      
        
  

    <li class="active ah-togglable-item opened">
      <span class="ah-togglable-handle">PyGame</span>
      <ul>
        
          
            
            
              <li class="ah-toc-item">
                <a href="#estrutura-basica-de-um-jogo">Estrutura básica de um jogo</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#instalacao">Instalação</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#preparo-para-o-tutorial">Preparo para o tutorial</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#criando-uma-janela">Criando uma janela</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#desenhando-na-tela">Desenhando na tela</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#desenhando-um-texto">Desenhando um texto</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#desenhando-uma-imagem">Desenhando uma imagem</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#recriando-o-asteroids">Recriando o Asteroids</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#controlando-a-velocidade-do-jogo">Controlando a velocidade do jogo</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#adicionando-mais-meteoros">Adicionando mais meteoros</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#adicionando-mais-meteoros-ainda">Adicionando mais meteoros ainda</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#adicionando-a-nave">Adicionando a nave</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#movimento-da-nave">Movimento da nave</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#tratamento-de-colisoes-da-nave-com-os-meteoros">Tratamento de colisões da nave com os meteoros</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#fazendo-a-nave-atirar">Fazendo a nave atirar</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#adicionando-som">Adicionando som</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#refatorando-mais-uma-vez-o-codigo">Refatorando mais uma vez o código</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#adicionando-animacoes">Adicionando animações</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#adicionando-estados">Adicionando estados</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#adicionando-um-placar">Adicionando um placar</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#sistema-de-vidas">Sistema de vidas</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#melhorando-a-colisao">Melhorando a colisão</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#separando-o-codigo-em-mais-funcoes">Separando o código em mais funções</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#separando-o-codigo-em-arquivos-diferentes">Separando o código em arquivos diferentes</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#adicionando-uma-tela-inicial">Adicionando uma tela inicial</a>
              </li>
            
        
          
            
            
        
      </ul>
    </li>
  

      
    </ul>
  </li>

            
          </ul>
        </div>
      </nav>
      <main class="ah-content ah-typeset">
        
          <div class="ah-title-box">
            <ul class="ah-breadcrumbs">
              
                
                  
                    <li>Conteúdo</li>
                  
                
                <li></li>
            </ul>
            
            
          </div>
          
            <section class="progress-section show">
<h1 id="12-pygame">12. PyGame</h1>
<p>Neste handout vamos começar a nos preparar para desenvolver o projeto final de Design de Software. Para isso vamos apresentar uma biblioteca de desenvolvimento de jogos em Python chamada pygame. Ao final deste handout você terá implementado um jogo simples baseado no Asteroids usando pygame.</p>
<h2 id="estrutura-basica-de-um-jogo">Estrutura básica de um jogo</h2>
<p>Vamos começar entendendo a estrutura de um jogo qualquer. Note que este conhecimento independe da biblioteca ou linguagem de programação utilizada. Essa estrutura pode ser resumida da seguinte maneira:</p>
<p><img src="../raw/pygame/estrutura.png" width="50%"></p>
<p>Nas seções a seguir explicamos o que o programa faz em cada um desses blocos.</p>
<h3 id="inicializacao">Inicialização</h3>
<ul>
<li><strong>Importa e inicia pacotes:</strong> por exemplo, realiza os <code class="language-python highlight"><span class="n">imports</span></code> no Python;</li>
<li><strong>Inicia estruturas de dados:</strong> por exemplo, inicia listas, dicionários, variáveis, etc. com seus valores padrão;</li>
<li><strong>Inicia assets:</strong> exemplos de <em>assets</em> são imagens, sons, sprites, modelos 3D, etc. que são utilizados pelo jogo;</li>
<li><strong>Gera tela principal:</strong> criar a janela onde o jogo será apresentado;</li>
<li><strong>Dispara loop principal:</strong> depois que toda a inicialização está concluída o jogo propriamente dito se inicia.</li>
</ul>
<h3 id="loop-principal">Loop principal</h3>
<p>O jogo e toda a interação acontece durante esta fase. O loop principal, também chamado de <em>game loop</em>, se repete enquanto o jogo estiver rodando. Em geral, ao final de uma iteração do loop principal será gerado um novo frame para ser apresentado para o usuário.</p>
<ul>
<li><strong>Trata eventos:</strong> por exemplo, movimentos/cliques de mouse, input de teclado, timer, clique do usuário no X para fechar a janela, etc.</li>
<li><strong>Verifica consequências:</strong> verifica se houve colisões, aplica as ações do usuário (por exemplo, muda a direção do personagem se o jogador apertou uma tecla), etc. de acordo com as regras e mecânica do jogo;</li>
<li><strong>Atualiza estado do jogo:</strong> move os objetos na tela, atualiza os estados dos <em>assets</em> (por exemplo, muda a animação) e as estruturas de dados utilizadas (por exemplo, atualiza a lista de personagens vivos);</li>
<li><strong>Gera saídas:</strong> exibe as mudanças para o jogador (gera uma nova imagem/frame, toca um som, etc.).</li>
</ul>
<h3 id="finalizacao">Finalização</h3>
<p>Na finalização pode ser realizado o fechamento de arquivos, salvar o placar do jogo, fechar a janela do jogo, etc.</p>
<p><img src="../raw/pygame/pygame-logo.png" width="30%"></p>
<p>O <a href="https://www.pygame.org/docs/">pygame</a> é um <em>framework</em> (ou <em>game engine</em>) para desenvolvimento de jogos em Python, baseado na biblioteca SDL2 (Simple DirectMedia Layer).</p>
<h2 id="instalacao">Instalação</h2>
<p>Abra o seu terminal (Linux ou MacOS) ou Anaconda Prompt (Windows) e digite:</p>
<div class="language-text highlight"><pre><span></span><code>pip install pygame
</code></pre></div>
<h2 id="preparo-para-o-tutorial">Preparo para o tutorial</h2>
<p>Antes de seguir com o tutorial de pygame, faça o download do arquivo <a href="../raw/pygame/referencia.zip"><code>referencia.zip</code> (disponível neste link)</a>. Descompacte os arquivos em uma pasta, sem alterar a estrutura de pastas.</p>
<div class="admonition danger">
<p class="admonition-title">Importante</p>
<p>Consulte a <a href="https://www.pygame.org/docs">documentação</a> se não entender algum dos comandos.</p>
</div>
<h2 id="criando-uma-janela">Criando uma janela</h2>
<p>Veremos que será necessário utilizarmos muitos comandos para fazer coisas aparentemente simples, como mostrar uma janela em branco. Não se assuste. Muito desse código se repete de maneira muito semelhante em qualquer jogo que você for desenvolver. Vamos começar então com o exemplo que acabamos de comentar: como mostrar uma janela do pygame. Abra o arquivo <code class="language-python highlight"><span class="n">referencia</span><span class="o">/</span><span class="n">jogo_v1</span><span class="o">.</span><span class="n">py</span></code>. Esse arquivo contém comentários que separam o código nos blocos descritos no início deste handout.</p>
<p><img src="../raw/pygame/jogo_v1.png"></p>
<p>Vamos entender o que esses comandos fazem:</p>
<details class="info">
<summary>Código <code>referencia/jogo_v1.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="mi">500</span><span class="p">,</span> <span class="mi">400</span><span class="p">))</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Hello World!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="n">game</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="k">while</span> <span class="n">game</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>            <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<ul>
<li><code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span></code> (linha 5): o framework pygame é iniciado. Apenas após este comando é que os recursos do pacote podem ser utilizados;</li>
<li><code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="mi">500</span><span class="p">,</span> <span class="mi">400</span><span class="p">))</span></code> (linha 8): cria uma janela com 500 pixels de largura e 400 pixels de altura;</li>
<li><code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Hello World!&#39;</span><span class="p">)</span></code> (linha 9): define o título da janela (que aparece na barra superior) como o texto <code class="language-python highlight"><span class="s1">&#39;Hello World!&#39;</span></code>;</li>
<li><code class="language-python highlight"><span class="n">game</span> <span class="o">=</span> <span class="kc">True</span></code> (linha 12): a variável <code class="language-python highlight"><span class="n">game</span></code> será utilizada para indicar que o jogo deve continuar;</li>
<li><code class="language-python highlight"><span class="k">while</span> <span class="n">game</span><span class="p">:</span></code> (linha 15): continua o jogo enquanto <code class="language-python highlight"><span class="n">game</span></code> for <code class="language-python highlight"><span class="kc">True</span></code>;</li>
<li><code class="language-python highlight"><span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span></code> (linha 17): <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">()</span></code> devolve uma lista com todos os eventos (cliques/movimentos de mouse, teclas apertadas, botões da janela apertados, etc.) que ocorreram desde a última vez que essa função foi chamada. O <code class="language-python highlight"><span class="k">for</span></code> percorre cada um desses eventos, aplicando as consequências necessárias a cada caso;</li>
<li><code class="language-python highlight"><span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span></code> (linha 19): verifica se o tipo do evento é <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span></code>, ou seja, se o usuário clicou no botão de fechar a janela (consulte a <a href="https://www.pygame.org/docs/ref/event.html#pygame.event.EventType">documentação</a> para ver mais eventos possíveis);</li>
<li><code class="language-python highlight"><span class="n">game</span> <span class="o">=</span> <span class="kc">False</span></code> (linha 20): muda o valor para <code class="language-python highlight"><span class="kc">False</span></code> para que a próxima iteração do loop principal não seja mais executada. Depois disso o programa termina;</li>
<li><code class="language-python highlight"><span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span></code> (linha 23): preenche a janela com a cor branca. As cores são valores RGB (Red, Green, Blue) que variam entre 0 e 255. Note que existe um parênteses ao redor dos três valores. Esse parênteses é muito importante, pois define uma <em>tupla</em> (uma sequência de valores, semelhante a uma lista);</li>
<li><code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></code> (linha 26): tudo o que é feito na tela (<code class="language-python highlight"><span class="n">window</span></code>) não é mostrado para o usuário imediatamente, assim é possível desenhar várias coisas e somente depois de terminar de desenhar mostramos a nova tela (ou frame) para o usuário. Essa função é responsável por mostrar a nova tela que foi desenhada;</li>
<li><code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span></code> (linha 29): finaliza o pygame. É importante chamar essa função para que ele feche todos os recursos que abriu (por exemplo a janela).</li>
</ul>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_1" id="exercise_1_0">
<p class="admonition-title">EXERCÍCIO 1</p>
<form class="exercise-form">
<p>Aplique as seguintes modificações ao código do <code class="language-python highlight"><span class="n">jogo_v1</span><span class="o">.</span><span class="n">py</span></code>:</p>
<ol>
<li>Utilize uma janela de 600 X 300 pixels;</li>
<li>Mude o título para <code class="language-python highlight"><span class="n">Jogo</span> <span class="n">da</span><span class="o">/</span><span class="n">do</span> <span class="n">NOME</span></code> (onde <code class="language-python highlight"><span class="n">NOME</span></code> é o seu nome);</li>
<li>Mude a cor da janela para azul ao invés de branco;</li>
<li>Faça o jogo fechar assim que o usuário apertar qualquer tecla do teclado. Dica: procure pelo evento <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">KEYUP</span></code>.</li>
</ol>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="desenhando-na-tela">Desenhando na tela</h2>
<p>Vamos começar desenhando polígono na tela. Para isso precisamos entender o sistema de coordenadas da tela do pygame (imagem extraída de: <a href="https://medium.com/iothincvit/pygame-for-beginners-234da7d3c56f">https://medium.com/iothincvit/pygame-for-beginners-234da7d3c56f</a>):</p>
<p><img alt="" src="../raw/pygame/coordenadas.png" /></p>
<p>No pygame, o canto superior esquerdo da janela é a origem (ponto <code class="language-python highlight"><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></code>). O eixo X aumenta <strong>para a direita</strong> e o eixo Y aumenta <strong>para baixo</strong>. Assim, se queremos mostrar uma informação "mais para baixo", devemos <strong>aumentar</strong> o valor de Y.</p>
<p>Abra o arquivo <code class="language-python highlight"><span class="n">jogo_v2</span><span class="o">.</span><span class="n">py</span></code>. A única diferença para a versão 1 são as linhas 24 a 26. Nas linhas 24 e 25 nós definimos uma cor (vermelha) e os vértices de um polígono. Na linha 26 chamamos a função <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">polygon</span></code>, que recebe uma superfície na qual o polígono será desenhado (no nosso caso, a janela), a cor e os vértices do polígono.</p>
<details class="info">
<summary>Código <code>referencia/jogo_v2.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span>
<span class="normal"><a href="#__codelineno-1-17">17</a></span>
<span class="normal"><a href="#__codelineno-1-18">18</a></span>
<span class="normal"><a href="#__codelineno-1-19">19</a></span>
<span class="normal"><a href="#__codelineno-1-20">20</a></span>
<span class="normal"><a href="#__codelineno-1-21">21</a></span>
<span class="normal"><a href="#__codelineno-1-22">22</a></span>
<span class="normal"><a href="#__codelineno-1-23">23</a></span>
<span class="normal"><a href="#__codelineno-1-24">24</a></span>
<span class="normal"><a href="#__codelineno-1-25">25</a></span>
<span class="normal"><a href="#__codelineno-1-26">26</a></span>
<span class="normal"><a href="#__codelineno-1-27">27</a></span>
<span class="normal"><a href="#__codelineno-1-28">28</a></span>
<span class="normal"><a href="#__codelineno-1-29">29</a></span>
<span class="normal"><a href="#__codelineno-1-30">30</a></span>
<span class="normal"><a href="#__codelineno-1-31">31</a></span>
<span class="normal"><a href="#__codelineno-1-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="mi">500</span><span class="p">,</span> <span class="mi">400</span><span class="p">))</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Hello World!&#39;</span><span class="p">)</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="n">game</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a><span class="k">while</span> <span class="n">game</span><span class="p">:</span>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-1-17" name="__codelineno-1-17"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-1-18" name="__codelineno-1-18"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-1-19" name="__codelineno-1-19"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-1-20" name="__codelineno-1-20"></a>            <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-1-21" name="__codelineno-1-21"></a>
<a id="__codelineno-1-22" name="__codelineno-1-22"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-1-23" name="__codelineno-1-23"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-1-24" name="__codelineno-1-24"></a>    <span class="n">cor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-1-25" name="__codelineno-1-25"></a>    <span class="n">vertices</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">400</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)]</span>
<a id="__codelineno-1-26" name="__codelineno-1-26"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">polygon</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">cor</span><span class="p">,</span> <span class="n">vertices</span><span class="p">)</span>
<a id="__codelineno-1-27" name="__codelineno-1-27"></a>
<a id="__codelineno-1-28" name="__codelineno-1-28"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-1-29" name="__codelineno-1-29"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-1-30" name="__codelineno-1-30"></a>
<a id="__codelineno-1-31" name="__codelineno-1-31"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-1-32" name="__codelineno-1-32"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_2" id="exercise_2_0">
<p class="admonition-title">EXERCÍCIO 2</p>
<form class="exercise-form">
<p>Modifique o código do <code class="language-python highlight"><span class="n">jogo_v2</span><span class="o">.</span><span class="n">py</span></code> para que ele desenhe a bandeira do Brasil (simplificada, só a parte verde, amarela e azul). Dica: você provavelmente vai querer utilizar a função <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">circle</span></code>(consulte a <a href="https://www.pygame.org/docs/ref/draw.html">documentação</a> para entender como utilizá-la).</p>
<p>Tente mudar a ordem dos desenhos (desenhe primeiro o círculo, depois o polígono). O que acontece? A ordem dos desenhos importa. O novo desenho é sempre feito sobrepondo os desenhos anteriores.</p>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="desenhando-um-texto">Desenhando um texto</h2>
<p>Talvez você tenha estranhado o título desta seção, mas qualquer texto deve realmente ser desenhado para aparecer na tela. Os caracteres de um texto também são desenhados como pixels. Vamos entender o arquivo <code class="language-python highlight"><span class="n">jogo_v3</span><span class="o">.</span><span class="n">py</span></code>. Antes de abrir o arquivo, execute-o para ver o resultado.</p>
<details class="info">
<summary>Código <code>referencia/jogo_v3.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span>
<span class="normal"><a href="#__codelineno-2-18">18</a></span>
<span class="normal"><a href="#__codelineno-2-19">19</a></span>
<span class="normal"><a href="#__codelineno-2-20">20</a></span>
<span class="normal"><a href="#__codelineno-2-21">21</a></span>
<span class="normal"><a href="#__codelineno-2-22">22</a></span>
<span class="normal"><a href="#__codelineno-2-23">23</a></span>
<span class="normal"><a href="#__codelineno-2-24">24</a></span>
<span class="normal"><a href="#__codelineno-2-25">25</a></span>
<span class="normal"><a href="#__codelineno-2-26">26</a></span>
<span class="normal"><a href="#__codelineno-2-27">27</a></span>
<span class="normal"><a href="#__codelineno-2-28">28</a></span>
<span class="normal"><a href="#__codelineno-2-29">29</a></span>
<span class="normal"><a href="#__codelineno-2-30">30</a></span>
<span class="normal"><a href="#__codelineno-2-31">31</a></span>
<span class="normal"><a href="#__codelineno-2-32">32</a></span>
<span class="normal"><a href="#__codelineno-2-33">33</a></span>
<span class="normal"><a href="#__codelineno-2-34">34</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="mi">500</span><span class="p">,</span> <span class="mi">400</span><span class="p">))</span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Hello World!&#39;</span><span class="p">)</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="n">game</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a>
<a id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-2-15" name="__codelineno-2-15"></a><span class="n">font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">SysFont</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
<a id="__codelineno-2-16" name="__codelineno-2-16"></a><span class="n">text</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;HELLO WORLD&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
<a id="__codelineno-2-17" name="__codelineno-2-17"></a>
<a id="__codelineno-2-18" name="__codelineno-2-18"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-2-19" name="__codelineno-2-19"></a><span class="k">while</span> <span class="n">game</span><span class="p">:</span>
<a id="__codelineno-2-20" name="__codelineno-2-20"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-2-21" name="__codelineno-2-21"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-2-22" name="__codelineno-2-22"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-2-23" name="__codelineno-2-23"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-2-24" name="__codelineno-2-24"></a>            <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-2-25" name="__codelineno-2-25"></a>
<a id="__codelineno-2-26" name="__codelineno-2-26"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-2-27" name="__codelineno-2-27"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-2-28" name="__codelineno-2-28"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<a id="__codelineno-2-29" name="__codelineno-2-29"></a>
<a id="__codelineno-2-30" name="__codelineno-2-30"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-2-31" name="__codelineno-2-31"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-2-32" name="__codelineno-2-32"></a>
<a id="__codelineno-2-33" name="__codelineno-2-33"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-2-34" name="__codelineno-2-34"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<p>Agora que você já viu o <code class="language-python highlight"><span class="n">HELLO</span> <span class="n">WORLD</span></code> na tela, vamos entender o código. As mudanças estão nas linhas 15, 16 e 28:</p>
<ul>
<li><code class="language-python highlight"><span class="n">font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">SysFont</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span></code> (linha 15): carrega uma nova fonte de texto. Como não passamos nada como o primeiro argumento (<code class="language-python highlight"><span class="kc">None</span></code>), o PyGame vai utilizar a fonte padrão. O segundo argumento é o tamanho da fonte;</li>
<li><code class="language-python highlight"><span class="n">text</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;HELLO WORLD&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span></code> (linha 16): cria uma imagem a partir da fonte criada na linha anterior com o texto <code class="language-python highlight"><span class="s1">&#39;HELLO WORLD&#39;</span></code>. O segundo argumento neste momento pode ser sempre <code class="language-python highlight"><span class="kc">True</span></code> (ele faz com que as curvas sejam desenhadas de maneira mais suave). O terceiro argumento é a cor;</li>
<li><code class="language-python highlight"><span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span></code> (linha 28): desenha em <code class="language-python highlight"><span class="n">window</span></code> a imagem <code class="language-python highlight"><span class="n">text</span></code> na posição <code class="language-python highlight"><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span></code> (lembrando que a origem - ponto (0, 0) - é no canto superior esquerdo). A imagem é delimitada por um retângulo. A posição passada como segundo argumento define a localização do ponto superior esquerdo desse retângulo. Por padrão, sempre que nos referimos à posição da imagem (coordenada <span class="arithmatex">\((x, y)\)</span>) queremos dizer o seu canto superior esquerdo.</li>
</ul>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_3" id="exercise_3_0">
<p class="admonition-title">EXERCÍCIO 3</p>
<form class="exercise-form">
<p>Modifique o <code class="language-python highlight"><span class="n">jogo_v3</span><span class="o">.</span><span class="n">py</span></code> para que ele desenhe o texto <code class="language-python highlight"><span class="n">HELLO</span></code> em uma posição (por exemplo, no ponto (10, 10), onde ele já está) e o texto <code class="language-python highlight"><span class="n">WORLD</span></code> em outro lugar da janela (por exemplo, no ponto (100, 100)).</p>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="desenhando-uma-imagem">Desenhando uma imagem</h2>
<p>Como vimos na seção anterior, <code class="language-python highlight"><span class="n">text</span></code> já era uma imagem que foi desenhada na tela. Assim, não precisamos mudar muito o código para desenhar uma imagem qualquer. Execute o arquivo <code class="language-python highlight"><span class="n">jogo_v4</span><span class="o">.</span><span class="n">py</span></code> e depois abra o código. A principal mudança está na linha 17, na qual carregamos uma imagem de um arquivo ao invés de desenhar um texto em uma imagem. O <code class="language-python highlight"><span class="o">.</span><span class="n">convert</span><span class="p">()</span></code> no final da linha é uma otimização para acelerar o desenho da imagem. É uma boa prática sempre chamar esse método ao carregar uma imagem. Alternativamente pode-se utilizar o <code class="language-python highlight"><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span></code> quando a imagem possui transparência.</p>
<details class="info">
<summary>Código <code>referencia/jogo_v4.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span>
<span class="normal"><a href="#__codelineno-3-18">18</a></span>
<span class="normal"><a href="#__codelineno-3-19">19</a></span>
<span class="normal"><a href="#__codelineno-3-20">20</a></span>
<span class="normal"><a href="#__codelineno-3-21">21</a></span>
<span class="normal"><a href="#__codelineno-3-22">22</a></span>
<span class="normal"><a href="#__codelineno-3-23">23</a></span>
<span class="normal"><a href="#__codelineno-3-24">24</a></span>
<span class="normal"><a href="#__codelineno-3-25">25</a></span>
<span class="normal"><a href="#__codelineno-3-26">26</a></span>
<span class="normal"><a href="#__codelineno-3-27">27</a></span>
<span class="normal"><a href="#__codelineno-3-28">28</a></span>
<span class="normal"><a href="#__codelineno-3-29">29</a></span>
<span class="normal"><a href="#__codelineno-3-30">30</a></span>
<span class="normal"><a href="#__codelineno-3-31">31</a></span>
<span class="normal"><a href="#__codelineno-3-32">32</a></span>
<span class="normal"><a href="#__codelineno-3-33">33</a></span>
<span class="normal"><a href="#__codelineno-3-34">34</a></span>
<span class="normal"><a href="#__codelineno-3-35">35</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">500</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">400</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Hello World!&#39;</span><span class="p">)</span>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a><span class="n">game</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a>
<a id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-3-17" name="__codelineno-3-17"></a><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/logo-madfox.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-3-18" name="__codelineno-3-18"></a>
<a id="__codelineno-3-19" name="__codelineno-3-19"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-3-20" name="__codelineno-3-20"></a><span class="k">while</span> <span class="n">game</span><span class="p">:</span>
<a id="__codelineno-3-21" name="__codelineno-3-21"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-3-22" name="__codelineno-3-22"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-3-23" name="__codelineno-3-23"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-3-24" name="__codelineno-3-24"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-3-25" name="__codelineno-3-25"></a>            <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-3-26" name="__codelineno-3-26"></a>
<a id="__codelineno-3-27" name="__codelineno-3-27"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-3-28" name="__codelineno-3-28"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-3-29" name="__codelineno-3-29"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<a id="__codelineno-3-30" name="__codelineno-3-30"></a>
<a id="__codelineno-3-31" name="__codelineno-3-31"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-3-32" name="__codelineno-3-32"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-3-33" name="__codelineno-3-33"></a>
<a id="__codelineno-3-34" name="__codelineno-3-34"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-3-35" name="__codelineno-3-35"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<p>Aproveitamos para começar a organizar melhor o código. Foram criadas duas constantes, <code class="language-python highlight"><span class="n">WIDTH</span></code> e <code class="language-python highlight"><span class="n">HEIGHT</span></code>, para guardar o valor da largura e altura da janela. Assim, sempre que precisarmos dessa informação podemos usar as constantes ao invés de colocar os números diretamente. Isso facilita muito quando queremos alterar o tamanho da janela. Nesse caso não será necessário procurar em todos os lugares do código onde o número aparece. Basta mudar o valor da constante.</p>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_4" id="exercise_4_0">
<p class="admonition-title">EXERCÍCIO 4</p>
<form class="exercise-form">
<p>A imagem está grande demais. Modifique o <code class="language-python highlight"><span class="n">jogo_v4</span><span class="o">.</span><span class="n">py</span></code> para mostrar uma imagem menor. Dica: use o comando <code class="language-python highlight"><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="mi">125</span><span class="p">,</span> <span class="mi">166</span><span class="p">))</span></code> para obter uma nova imagem de 125 X 166 pixels.</p>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="recriando-o-asteroids">Recriando o Asteroids</h2>
<p>Asteroids é um jogo de nave que foi muito famoso na década de 80. Consiste em destruir os meteoros que vem em sua direção através de tiros. Nesse tutorial, vamos replicar uma versão simplificada do jogo usando o pygame. Esse tutorial foi baseado no site <a href="http://kidscancode.org/lessons/">KidsCanCode</a>, o qual possui mais tutoriais com mais técnicas de desenvolvimento de jogos.</p>
<p>O arquivo <code class="language-python highlight"><span class="n">jogo_v5</span><span class="o">.</span><span class="n">py</span></code> apresenta uma primeira versão com um único meteoro que fica caindo do topo da tela. Quando sai da tela, ele retorna à posição inicial. Execute o <code class="language-python highlight"><span class="n">jogo_v5</span><span class="o">.</span><span class="n">py</span></code> e depois abra o arquivo para entender o que ele faz.</p>
<details class="info">
<summary>Código <code>referencia/jogo_v5.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span>
<span class="normal"><a href="#__codelineno-4-28">28</a></span>
<span class="normal"><a href="#__codelineno-4-29">29</a></span>
<span class="normal"><a href="#__codelineno-4-30">30</a></span>
<span class="normal"><a href="#__codelineno-4-31">31</a></span>
<span class="normal"><a href="#__codelineno-4-32">32</a></span>
<span class="normal"><a href="#__codelineno-4-33">33</a></span>
<span class="normal"><a href="#__codelineno-4-34">34</a></span>
<span class="normal"><a href="#__codelineno-4-35">35</a></span>
<span class="normal"><a href="#__codelineno-4-36">36</a></span>
<span class="normal"><a href="#__codelineno-4-37">37</a></span>
<span class="normal"><a href="#__codelineno-4-38">38</a></span>
<span class="normal"><a href="#__codelineno-4-39">39</a></span>
<span class="normal"><a href="#__codelineno-4-40">40</a></span>
<span class="normal"><a href="#__codelineno-4-41">41</a></span>
<span class="normal"><a href="#__codelineno-4-42">42</a></span>
<span class="normal"><a href="#__codelineno-4-43">43</a></span>
<span class="normal"><a href="#__codelineno-4-44">44</a></span>
<span class="normal"><a href="#__codelineno-4-45">45</a></span>
<span class="normal"><a href="#__codelineno-4-46">46</a></span>
<span class="normal"><a href="#__codelineno-4-47">47</a></span>
<span class="normal"><a href="#__codelineno-4-48">48</a></span>
<span class="normal"><a href="#__codelineno-4-49">49</a></span>
<span class="normal"><a href="#__codelineno-4-50">50</a></span>
<span class="normal"><a href="#__codelineno-4-51">51</a></span>
<span class="normal"><a href="#__codelineno-4-52">52</a></span>
<span class="normal"><a href="#__codelineno-4-53">53</a></span>
<span class="normal"><a href="#__codelineno-4-54">54</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">480</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="n">METEOR_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a><span class="n">METEOR_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="n">font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">SysFont</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="n">background</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/starfield.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="n">meteor_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/meteorBrown_med1.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="n">meteor_img_small</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">,</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a><span class="n">game</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a><span class="n">meteor_x</span> <span class="o">=</span> <span class="mi">200</span>
<a id="__codelineno-4-25" name="__codelineno-4-25"></a><span class="c1"># y negativo significa que está acima do topo da janela. O meteoro começa fora da janela</span>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a><span class="n">meteor_y</span> <span class="o">=</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span>
<a id="__codelineno-4-27" name="__codelineno-4-27"></a><span class="n">meteor_speedx</span> <span class="o">=</span> <span class="mi">3</span>
<a id="__codelineno-4-28" name="__codelineno-4-28"></a><span class="n">meteor_speedy</span> <span class="o">=</span> <span class="mi">4</span>
<a id="__codelineno-4-29" name="__codelineno-4-29"></a>
<a id="__codelineno-4-30" name="__codelineno-4-30"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-4-31" name="__codelineno-4-31"></a><span class="k">while</span> <span class="n">game</span><span class="p">:</span>
<a id="__codelineno-4-32" name="__codelineno-4-32"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-4-33" name="__codelineno-4-33"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-4-34" name="__codelineno-4-34"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-4-35" name="__codelineno-4-35"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-4-36" name="__codelineno-4-36"></a>            <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-4-37" name="__codelineno-4-37"></a>
<a id="__codelineno-4-38" name="__codelineno-4-38"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-4-39" name="__codelineno-4-39"></a>    <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-4-40" name="__codelineno-4-40"></a>    <span class="n">meteor_x</span> <span class="o">+=</span> <span class="n">meteor_speedx</span>
<a id="__codelineno-4-41" name="__codelineno-4-41"></a>    <span class="n">meteor_y</span> <span class="o">+=</span> <span class="n">meteor_speedy</span>
<a id="__codelineno-4-42" name="__codelineno-4-42"></a>    <span class="c1"># Se o meteoro passar do final da tela, volta para cima</span>
<a id="__codelineno-4-43" name="__codelineno-4-43"></a>    <span class="k">if</span> <span class="n">meteor_y</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="n">meteor_x</span> <span class="o">+</span> <span class="n">METEOR_WIDTH</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">meteor_x</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-4-44" name="__codelineno-4-44"></a>        <span class="n">meteor_x</span> <span class="o">=</span> <span class="mi">200</span>
<a id="__codelineno-4-45" name="__codelineno-4-45"></a>        <span class="n">meteor_y</span> <span class="o">=</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span>
<a id="__codelineno-4-46" name="__codelineno-4-46"></a>
<a id="__codelineno-4-47" name="__codelineno-4-47"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-4-48" name="__codelineno-4-48"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-4-49" name="__codelineno-4-49"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">background</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-4-50" name="__codelineno-4-50"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">meteor_img_small</span><span class="p">,</span> <span class="p">(</span><span class="n">meteor_x</span><span class="p">,</span> <span class="n">meteor_y</span><span class="p">))</span>
<a id="__codelineno-4-51" name="__codelineno-4-51"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-4-52" name="__codelineno-4-52"></a>
<a id="__codelineno-4-53" name="__codelineno-4-53"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-4-54" name="__codelineno-4-54"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<p>Este arquivo possui algumas modificações:</p>
<ul>
<li>Linhas 18 a 20: carrega as imagens de fundo e do meteoro;</li>
<li>Linhas 24 a 28: inicializa as variáveis que armazenam a posição e a velocidade do meteoro;</li>
<li>Linhas 40 e 41: atualiza a posição do meteoro;</li>
<li>Linhas 43 a 45: verifica se o meteoro saiu da tela. Nesse caso, faz ele voltar para a posição inicial.</li>
<li>Linhas 49 e 50: desenha a imagem de fundo e depois a imagem do meteoro (note que a imagem de fundo só cobre a janela inteira porque mudamos o tamanho da janela para 480 X 600 pixels - caso contrário uma parte dela ficaria com a cor de fundo).</li>
</ul>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_5" id="exercise_5_0">
<p class="admonition-title">EXERCÍCIO 5</p>
<form class="exercise-form">
<p>O meteoro sempre começa na mesma posição e sempre se move na mesma direção. Vamos deixar o jogo mais interessante sorteando uma posição aleatória. Sorteie valores aleatórios para <code class="language-python highlight"><span class="n">meteor_x</span></code>, <code class="language-python highlight"><span class="n">meteor_y</span></code>, <code class="language-python highlight"><span class="n">meteor_speedx</span></code>, <code class="language-python highlight"><span class="n">meteor_speedy</span></code> na inicialização do jogo (a partir da linha 24) e quando o meteoro sai da tela (<code class="language-python highlight"><span class="k">if</span></code> da linha 43). Sugestões de valores aleatórios:</p>
<ul>
<li><code class="language-python highlight"><span class="n">meteor_x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span></code> - o valor de x pode estar entre 0 e a largura da janela menos a largura da imagem do meteoro. Lembre-se que <code class="language-python highlight"><span class="n">x</span></code> é a esquerda do retângulo que define a imagem;</li>
<li><code class="language-python highlight"><span class="n">meteor_y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span></code> - valores negativos significam que o meteoro está acima da janela. Vamos sortear valores de maneira que ele sempre comece o movimento de fora da janela, ou seja, o mais baixo possível é <code class="language-python highlight"><span class="o">-</span><span class="n">METEOR_HEIGHT</span></code>. Lembrando que <code class="language-python highlight"><span class="n">y</span></code> é a coordenada de cima do retângulo da imagem;</li>
<li><code class="language-python highlight"><span class="n">meteor_speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span></code> - se os valores da componente x da velocidade forem muito altos o meteoro vai se mover para um dos lados sem descer muito;</li>
<li><code class="language-python highlight"><span class="n">meteor_speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span></code> - velocidades positivas em y significam que o meteoro vai se mover para baixo.</li>
</ul>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="controlando-a-velocidade-do-jogo">Controlando a velocidade do jogo</h2>
<p>Você percebeu que o meteoro se move muito rapidamente? Isso acontece porque estamos em um loop infinito, cuja velocidade de execução depende da CPU (processador), memória e outras características do equipamento onde estiver sendo executado. Dessa forma a velocidade de deslocamento da nave vai variar conforme a máquina em que o jogo for executado e os programas que estejam nela rodando.</p>
<p>Para controlar o número de iterações do loop por segundo usaremos o seguinte artifício: será criado um relógio, a partir da classe <code class="language-python highlight"><span class="n">Clock</span></code> do pygame. Essa classe possui um método chamado <code class="language-python highlight"><span class="n">tick</span></code> que conta quantos milissegundos já se passaram desde a última vez que ele foi chamado. Pegaremos o tempo transcorrido mas não utilizaremos para nada. Mas ao pegar esse tempo especificaremos para o método <code class="language-python highlight"><span class="n">tick</span></code> que queremos que ele seja executado no máximo 30 vezes por segundo. Dessa forma teremos um efeito colateral útil: o loop será limitado por essa chamada e só executará 30 vezes por segundo também. Assim, em qualquer máquina que o código for executado a velocidade de atualização do jogo será a mesma (exceto, claro, se a máquina for tão lenta que não conseguir executar nessa velocidade).</p>
<p>Aplicamos essas mudanças no arquivo <code class="language-python highlight"><span class="n">jogo_v6</span><span class="o">.</span><span class="n">py</span></code> (linhas 34, 35 e 39). Execute o programa para ver o resultado da mudança.</p>
<details class="info">
<summary>Código <code>referencia/jogo_v6.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span>
<span class="normal"><a href="#__codelineno-5-16">16</a></span>
<span class="normal"><a href="#__codelineno-5-17">17</a></span>
<span class="normal"><a href="#__codelineno-5-18">18</a></span>
<span class="normal"><a href="#__codelineno-5-19">19</a></span>
<span class="normal"><a href="#__codelineno-5-20">20</a></span>
<span class="normal"><a href="#__codelineno-5-21">21</a></span>
<span class="normal"><a href="#__codelineno-5-22">22</a></span>
<span class="normal"><a href="#__codelineno-5-23">23</a></span>
<span class="normal"><a href="#__codelineno-5-24">24</a></span>
<span class="normal"><a href="#__codelineno-5-25">25</a></span>
<span class="normal"><a href="#__codelineno-5-26">26</a></span>
<span class="normal"><a href="#__codelineno-5-27">27</a></span>
<span class="normal"><a href="#__codelineno-5-28">28</a></span>
<span class="normal"><a href="#__codelineno-5-29">29</a></span>
<span class="normal"><a href="#__codelineno-5-30">30</a></span>
<span class="normal"><a href="#__codelineno-5-31">31</a></span>
<span class="normal"><a href="#__codelineno-5-32">32</a></span>
<span class="normal"><a href="#__codelineno-5-33">33</a></span>
<span class="normal"><a href="#__codelineno-5-34">34</a></span>
<span class="normal"><a href="#__codelineno-5-35">35</a></span>
<span class="normal"><a href="#__codelineno-5-36">36</a></span>
<span class="normal"><a href="#__codelineno-5-37">37</a></span>
<span class="normal"><a href="#__codelineno-5-38">38</a></span>
<span class="normal"><a href="#__codelineno-5-39">39</a></span>
<span class="normal"><a href="#__codelineno-5-40">40</a></span>
<span class="normal"><a href="#__codelineno-5-41">41</a></span>
<span class="normal"><a href="#__codelineno-5-42">42</a></span>
<span class="normal"><a href="#__codelineno-5-43">43</a></span>
<span class="normal"><a href="#__codelineno-5-44">44</a></span>
<span class="normal"><a href="#__codelineno-5-45">45</a></span>
<span class="normal"><a href="#__codelineno-5-46">46</a></span>
<span class="normal"><a href="#__codelineno-5-47">47</a></span>
<span class="normal"><a href="#__codelineno-5-48">48</a></span>
<span class="normal"><a href="#__codelineno-5-49">49</a></span>
<span class="normal"><a href="#__codelineno-5-50">50</a></span>
<span class="normal"><a href="#__codelineno-5-51">51</a></span>
<span class="normal"><a href="#__codelineno-5-52">52</a></span>
<span class="normal"><a href="#__codelineno-5-53">53</a></span>
<span class="normal"><a href="#__codelineno-5-54">54</a></span>
<span class="normal"><a href="#__codelineno-5-55">55</a></span>
<span class="normal"><a href="#__codelineno-5-56">56</a></span>
<span class="normal"><a href="#__codelineno-5-57">57</a></span>
<span class="normal"><a href="#__codelineno-5-58">58</a></span>
<span class="normal"><a href="#__codelineno-5-59">59</a></span>
<span class="normal"><a href="#__codelineno-5-60">60</a></span>
<span class="normal"><a href="#__codelineno-5-61">61</a></span>
<span class="normal"><a href="#__codelineno-5-62">62</a></span>
<span class="normal"><a href="#__codelineno-5-63">63</a></span>
<span class="normal"><a href="#__codelineno-5-64">64</a></span>
<span class="normal"><a href="#__codelineno-5-65">65</a></span>
<span class="normal"><a href="#__codelineno-5-66">66</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">480</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-5-15" name="__codelineno-5-15"></a><span class="n">METEOR_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-5-16" name="__codelineno-5-16"></a><span class="n">METEOR_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-5-17" name="__codelineno-5-17"></a><span class="n">font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">SysFont</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
<a id="__codelineno-5-18" name="__codelineno-5-18"></a><span class="n">background</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/starfield.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-5-19" name="__codelineno-5-19"></a><span class="n">meteor_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/meteorBrown_med1.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-5-20" name="__codelineno-5-20"></a><span class="n">meteor_img_small</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">,</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-5-21" name="__codelineno-5-21"></a>
<a id="__codelineno-5-22" name="__codelineno-5-22"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-5-23" name="__codelineno-5-23"></a><span class="n">game</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-5-24" name="__codelineno-5-24"></a><span class="c1"># Sorteia posição aleatória</span>
<a id="__codelineno-5-25" name="__codelineno-5-25"></a><span class="c1"># Como x é o lado esquerdo da imagem, ele só pode ir até a largura da</span>
<a id="__codelineno-5-26" name="__codelineno-5-26"></a><span class="c1"># janela menos a largura da imagem</span>
<a id="__codelineno-5-27" name="__codelineno-5-27"></a><span class="n">meteor_x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-5-28" name="__codelineno-5-28"></a><span class="c1"># y negativo significa que está acima do topo da janela. O meteoro começa fora da janela</span>
<a id="__codelineno-5-29" name="__codelineno-5-29"></a><span class="n">meteor_y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-5-30" name="__codelineno-5-30"></a><span class="c1"># Sorteia velocidade do meteoro</span>
<a id="__codelineno-5-31" name="__codelineno-5-31"></a><span class="n">meteor_speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-5-32" name="__codelineno-5-32"></a><span class="n">meteor_speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-5-33" name="__codelineno-5-33"></a><span class="c1"># Variável para o ajuste de velocidade</span>
<a id="__codelineno-5-34" name="__codelineno-5-34"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<a id="__codelineno-5-35" name="__codelineno-5-35"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">15</span>
<a id="__codelineno-5-36" name="__codelineno-5-36"></a>
<a id="__codelineno-5-37" name="__codelineno-5-37"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-5-38" name="__codelineno-5-38"></a><span class="k">while</span> <span class="n">game</span><span class="p">:</span>
<a id="__codelineno-5-39" name="__codelineno-5-39"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
<a id="__codelineno-5-40" name="__codelineno-5-40"></a>
<a id="__codelineno-5-41" name="__codelineno-5-41"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-5-42" name="__codelineno-5-42"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-5-43" name="__codelineno-5-43"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-5-44" name="__codelineno-5-44"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-5-45" name="__codelineno-5-45"></a>            <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-5-46" name="__codelineno-5-46"></a>
<a id="__codelineno-5-47" name="__codelineno-5-47"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-5-48" name="__codelineno-5-48"></a>    <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-5-49" name="__codelineno-5-49"></a>    <span class="n">meteor_x</span> <span class="o">+=</span> <span class="n">meteor_speedx</span>
<a id="__codelineno-5-50" name="__codelineno-5-50"></a>    <span class="n">meteor_y</span> <span class="o">+=</span> <span class="n">meteor_speedy</span>
<a id="__codelineno-5-51" name="__codelineno-5-51"></a>    <span class="c1"># Se o meteoro passar do final da tela, volta para cima e sorteia</span>
<a id="__codelineno-5-52" name="__codelineno-5-52"></a>    <span class="c1"># novas posições e velocidades</span>
<a id="__codelineno-5-53" name="__codelineno-5-53"></a>    <span class="k">if</span> <span class="n">meteor_y</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="n">meteor_x</span> <span class="o">+</span> <span class="n">METEOR_WIDTH</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">meteor_x</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-5-54" name="__codelineno-5-54"></a>        <span class="n">meteor_x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-5-55" name="__codelineno-5-55"></a>        <span class="n">meteor_y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-5-56" name="__codelineno-5-56"></a>        <span class="n">meteor_speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-5-57" name="__codelineno-5-57"></a>        <span class="n">meteor_speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-5-58" name="__codelineno-5-58"></a>
<a id="__codelineno-5-59" name="__codelineno-5-59"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-5-60" name="__codelineno-5-60"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-5-61" name="__codelineno-5-61"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">background</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-5-62" name="__codelineno-5-62"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">meteor_img_small</span><span class="p">,</span> <span class="p">(</span><span class="n">meteor_x</span><span class="p">,</span> <span class="n">meteor_y</span><span class="p">))</span>
<a id="__codelineno-5-63" name="__codelineno-5-63"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-5-64" name="__codelineno-5-64"></a>
<a id="__codelineno-5-65" name="__codelineno-5-65"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-5-66" name="__codelineno-5-66"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_6" id="exercise_6_0">
<p class="admonition-title">EXERCÍCIO 6</p>
<form class="exercise-form">
<p>Agora parece que limitamos demais o número de execuções do loop principal. A animação parece um pouco travada. Altere a velocidade do jogo para que ele execute 30 frames por segundo ao invés de 15.</p>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="adicionando-mais-meteoros">Adicionando mais meteoros</h2>
<p>Vamos adicionar mais meteoros ao jogo. Para isso, onde será necessário alterar o nosso código? Temos a inicialização da posição e velocidade do meteoro no começo do código e depois temos a reinicialização desses valores quando o meteoro sai da tela. Além disso, precisamos desenhar os meteoros em um outro lugar. Está começando a ficar complexo, não é mesmo?</p>
<h3 id="classes-em-python">Classes em Python</h3>
<p>Antes de criar mais meteoros, vamos então melhorar o nosso código. Para isso vamos utilizar um recurso disponível no Python chamado classes. Em Design de Software não vamos entrar em detalhes sobre o que são classes, nem como montar boas classes. Queremos apenas saber o mínimo para poder utilizá-las.</p>
<p>Neste primeiro momento você pode entender uma classe como um tipo de dados do Python. Na verdade, já trabalhamos com algumas classes, por mais que não tenhamos chamado-as assim: listas, strings e dicionários são algumas das classes disponíveis na linguagem. O interessante é que podemos criar novas classes (ou tipos) no Python. A ideia é semelhante ao que fazemos com um <code class="language-python highlight"><span class="k">def</span></code>. Primeiro definimos a classe e depois usamos quando for necessário. Suponha, por exemplo, que queremos criar um novo tipo que represente um ponto com coordenadas <code class="language-python highlight"><span class="n">x</span></code> e <code class="language-python highlight"><span class="n">y</span></code>. Ele poderia ser feito da seguinte maneira (o exemplo completo está no arquivo <code class="language-python highlight"><span class="n">teste_ponto</span><span class="o">.</span><span class="n">py</span></code>):</p>
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>
<p>Isso define uma classe <code class="language-python highlight"><span class="n">Point</span></code> que possui coordenadas <code class="language-python highlight"><span class="n">x</span></code> e <code class="language-python highlight"><span class="n">y</span></code> ambas iguais a zero. Note que apenas definimos esse novo tipo, mas ainda não usamos. A partir desse momento o Python sabe o que é uma lista, o que é uma string e agora também o que é um <code class="language-python highlight"><span class="n">Point</span></code>. Vamos utilizar esse nosso novo tipo:</p>
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">ponto</span> <span class="o">=</span> <span class="n">Point</span><span class="p">()</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;O ponto está nas coordenadas x=</span><span class="si">{0}</span><span class="s1"> e y=</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ponto</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">ponto</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
</code></pre></div>
<p>O código acima vai imprimir: <code class="language-python highlight"><span class="n">O</span> <span class="n">ponto</span> <span class="n">está</span> <span class="n">nas</span> <span class="n">coordenadas</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span> <span class="n">e</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span></code>. O <code class="language-python highlight"><span class="n">x</span></code> e <code class="language-python highlight"><span class="n">y</span></code> são variáveis (chamamos de atributos) que estão ligadas àquele <code class="language-python highlight"><span class="n">ponto</span></code> específico. Podemos inclusive mudar o seu valor:</p>
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">ponto</span> <span class="o">=</span> <span class="n">Point</span><span class="p">()</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">ponto</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="n">ponto</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">5</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;O ponto está nas coordenadas x=</span><span class="si">{0}</span><span class="s1"> e y=</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ponto</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">ponto</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
</code></pre></div>
<p>Esse novo código vai imprimir: <code class="language-python highlight"><span class="n">O</span> <span class="n">ponto</span> <span class="n">está</span> <span class="n">nas</span> <span class="n">coordenadas</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span> <span class="n">e</span> <span class="n">y</span><span class="o">=</span><span class="mi">5</span></code>. Podemos modificar a nossa classe para que ela receba como argumentos os valores das coordenadas assim que um novo ponto é criado:</p>
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_coord</span><span class="p">,</span> <span class="n">y_coord</span><span class="p">):</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x_coord</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y_coord</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="n">ponto</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;O ponto está nas coordenadas x=</span><span class="si">{0}</span><span class="s1"> e y=</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ponto</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">ponto</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
</code></pre></div>
<p>Esse novo código vai imprimir: <code class="language-python highlight"><span class="n">O</span> <span class="n">ponto</span> <span class="n">está</span> <span class="n">nas</span> <span class="n">coordenadas</span> <span class="n">x</span><span class="o">=</span><span class="mi">4</span> <span class="n">e</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span></code>. A função <code class="language-python highlight"><span class="fm">__init__</span></code> é um tipo de função especial que é chamada quando o novo ponto é criado. Duas observações importantes:</p>
<ul>
<li>São <strong>dois underscores</strong> no começo e <strong>dois underscores</strong> no fim (chamamos esse par de dois underscores de <em>dunder</em>, ou <em>double underscore</em>);</li>
<li>Essas funções que fazem parte de uma classe sempre recebem um primeiro argumento chamado <code class="language-python highlight"><span class="bp">self</span></code>. Ele é uma variável que guarda o próprio objeto. No nosso exemplo, <code class="language-python highlight"><span class="bp">self</span></code> é o próprio ponto. Por isso, quando fazemos <code class="language-python highlight"><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span></code> estamos guardando na variável (atributo) <code class="language-python highlight"><span class="n">x</span></code> desse ponto específico o valor <code class="language-python highlight"><span class="mi">0</span></code>.</li>
</ul>
<p>Vamos ver mais um exemplo de uma função definida dentro da classe (também chamada de método):</p>
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_coord</span><span class="p">,</span> <span class="n">y_coord</span><span class="p">):</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x_coord</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y_coord</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>    <span class="k">def</span> <span class="nf">distance_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_point</span><span class="p">):</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>        <span class="n">dx</span> <span class="o">=</span> <span class="n">other_point</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>        <span class="n">dy</span> <span class="o">=</span> <span class="n">other_point</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>        <span class="k">return</span> <span class="p">((</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">**</span> <span class="mf">0.5</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="n">p1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="n">p2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="n">d</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">distance_to</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A distância de (</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">) a (</span><span class="si">{2}</span><span class="s1">, </span><span class="si">{3}</span><span class="s1">) é </span><span class="si">{4}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p1</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">p2</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p2</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>
</code></pre></div>
<p>O programa acima vai imprimir: <code class="language-python highlight"><span class="n">A</span> <span class="n">distância</span> <span class="n">de</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="n">a</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="n">é</span> <span class="mi">5</span></code>. Considere o comando na penúltima linha: <code class="language-python highlight"><span class="n">d</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">distance_to</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span></code>. Ele segue uma estrutura muito parecida com o que já fazíamos com strings, por exemplo:</p>
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;Insper&#39;</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">t</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Ins&#39;</span><span class="p">,</span> <span class="s1">&#39;Su&#39;</span><span class="p">)</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</code></pre></div>
<p>Se você quiser praticar um pouco o uso de classes, faça os exercícios da academia em: <a href="https://dessoft.insper-comp.com.br/conteudo/classe/exercicios">Introdução a classes e orientação a objetos</a>. Também, e mais importante, replique, altere e teste os exemplos acima no VS Code ou no Colab para entender melhor.</p>
<h3 id="classes-no-pygame">Classes no pygame</h3>
<p>O pygame define algumas novas classes que facilitam o desenvolvimento de jogos. Uma dessas classes é o <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span></code>. Vamos aprender como usar esse tipo com o exemplo do meteoro. O exemplo a seguir define uma classe do tipo <code class="language-python highlight"><span class="n">Meteor</span></code>, que estende as funcionalidades de um <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span></code> (ou seja, faz tudo que um <code class="language-python highlight"><span class="n">Sprite</span></code> faz e mais um pouco):</p>
<div class="language-python highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="k">class</span> <span class="nc">Meteor</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/meteorBrown_med1.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>        <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>        <span class="c1"># Se o meteoro passar do final da tela, volta para cima e sorteia</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>        <span class="c1"># novas posições e velocidades</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</code></pre></div>
<p>Na inicialização do tipo <code class="language-python highlight"><span class="n">Meteor</span></code> temos o carregamento da imagem e o sorteio das posições e velocidades do meteoro. Todo <code class="language-python highlight"><span class="n">Sprite</span></code> deve definir um atributo <code class="language-python highlight"><span class="n">image</span></code> e um <code class="language-python highlight"><span class="n">rect</span></code>. Eles são utilizados para desenhar a imagem. O <code class="language-python highlight"><span class="n">rect</span></code> define a posição do retângulo da imagem e oferece algumas vantagens, como podemos ver na condição do <code class="language-python highlight"><span class="k">if</span></code>. Um retângulo é um outro tipo definido pelo pygame, que possui, além da posição <code class="language-python highlight"><span class="n">x</span></code> e <code class="language-python highlight"><span class="n">y</span></code>, outros atributos úteis, como <code class="language-python highlight"><span class="n">top</span></code>, <code class="language-python highlight"><span class="n">left</span></code>, <code class="language-python highlight"><span class="n">right</span></code>, <code class="language-python highlight"><span class="n">bottom</span></code>, <code class="language-python highlight"><span class="n">centerx</span></code> e <code class="language-python highlight"><span class="n">centery</span></code>. Usamos alguns desses exemplos no <code class="language-python highlight"><span class="k">if</span></code>, simplificando as comparações.</p>
<p>O método <code class="language-python highlight"><span class="n">update</span></code> será chamado quando quisermos atualizar a posição do meteoro, ou seja, em cada iteração do loop principal.</p>
<p>O arquivo <code class="language-python highlight"><span class="n">jogo_v7</span><span class="o">.</span><span class="n">py</span></code> cria a classe <code class="language-python highlight"><span class="n">Meteor</span></code> e substitui o código referente ao meteoro da versão anterior. Execute-o para ver o resultado e depois abra o código. Note que a classe <code class="language-python highlight"><span class="n">Meteor</span></code> está ligeiramente diferente da que apresentamos acima. A diferença é que ao invés de carregar a imagem dentro do <code class="language-python highlight"><span class="fm">__init__</span></code>, nós já recebemos uma imagem carregada no <code class="language-python highlight"><span class="fm">__init__</span></code> (linha 25). Essa diferença é importante, pois ao invés de carregar uma nova imagem para cada novo meteoro, nós carregamos a imagem apenas uma vez e usamos a mesma imagem carregada em todos os meteoros. Também adicionamos uma linha no começo do <code class="language-python highlight"><span class="fm">__init__</span></code>, com <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>. Como o <code class="language-python highlight"><span class="n">Meteor</span></code> é uma estensão da classe <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span></code>, nós precisamos inicializar o resto do <code class="language-python highlight"><span class="n">Sprite</span></code>. Não se preocupe se não entender todos os detalhes. Por enquanto basta saber que essa linha é obrigatória.</p>
<details class="info">
<summary>Código <code>referencia/jogo_v7.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span>
<span class="normal"><a href="#__codelineno-13-13">13</a></span>
<span class="normal"><a href="#__codelineno-13-14">14</a></span>
<span class="normal"><a href="#__codelineno-13-15">15</a></span>
<span class="normal"><a href="#__codelineno-13-16">16</a></span>
<span class="normal"><a href="#__codelineno-13-17">17</a></span>
<span class="normal"><a href="#__codelineno-13-18">18</a></span>
<span class="normal"><a href="#__codelineno-13-19">19</a></span>
<span class="normal"><a href="#__codelineno-13-20">20</a></span>
<span class="normal"><a href="#__codelineno-13-21">21</a></span>
<span class="normal"><a href="#__codelineno-13-22">22</a></span>
<span class="normal"><a href="#__codelineno-13-23">23</a></span>
<span class="normal"><a href="#__codelineno-13-24">24</a></span>
<span class="normal"><a href="#__codelineno-13-25">25</a></span>
<span class="normal"><a href="#__codelineno-13-26">26</a></span>
<span class="normal"><a href="#__codelineno-13-27">27</a></span>
<span class="normal"><a href="#__codelineno-13-28">28</a></span>
<span class="normal"><a href="#__codelineno-13-29">29</a></span>
<span class="normal"><a href="#__codelineno-13-30">30</a></span>
<span class="normal"><a href="#__codelineno-13-31">31</a></span>
<span class="normal"><a href="#__codelineno-13-32">32</a></span>
<span class="normal"><a href="#__codelineno-13-33">33</a></span>
<span class="normal"><a href="#__codelineno-13-34">34</a></span>
<span class="normal"><a href="#__codelineno-13-35">35</a></span>
<span class="normal"><a href="#__codelineno-13-36">36</a></span>
<span class="normal"><a href="#__codelineno-13-37">37</a></span>
<span class="normal"><a href="#__codelineno-13-38">38</a></span>
<span class="normal"><a href="#__codelineno-13-39">39</a></span>
<span class="normal"><a href="#__codelineno-13-40">40</a></span>
<span class="normal"><a href="#__codelineno-13-41">41</a></span>
<span class="normal"><a href="#__codelineno-13-42">42</a></span>
<span class="normal"><a href="#__codelineno-13-43">43</a></span>
<span class="normal"><a href="#__codelineno-13-44">44</a></span>
<span class="normal"><a href="#__codelineno-13-45">45</a></span>
<span class="normal"><a href="#__codelineno-13-46">46</a></span>
<span class="normal"><a href="#__codelineno-13-47">47</a></span>
<span class="normal"><a href="#__codelineno-13-48">48</a></span>
<span class="normal"><a href="#__codelineno-13-49">49</a></span>
<span class="normal"><a href="#__codelineno-13-50">50</a></span>
<span class="normal"><a href="#__codelineno-13-51">51</a></span>
<span class="normal"><a href="#__codelineno-13-52">52</a></span>
<span class="normal"><a href="#__codelineno-13-53">53</a></span>
<span class="normal"><a href="#__codelineno-13-54">54</a></span>
<span class="normal"><a href="#__codelineno-13-55">55</a></span>
<span class="normal"><a href="#__codelineno-13-56">56</a></span>
<span class="normal"><a href="#__codelineno-13-57">57</a></span>
<span class="normal"><a href="#__codelineno-13-58">58</a></span>
<span class="normal"><a href="#__codelineno-13-59">59</a></span>
<span class="normal"><a href="#__codelineno-13-60">60</a></span>
<span class="normal"><a href="#__codelineno-13-61">61</a></span>
<span class="normal"><a href="#__codelineno-13-62">62</a></span>
<span class="normal"><a href="#__codelineno-13-63">63</a></span>
<span class="normal"><a href="#__codelineno-13-64">64</a></span>
<span class="normal"><a href="#__codelineno-13-65">65</a></span>
<span class="normal"><a href="#__codelineno-13-66">66</a></span>
<span class="normal"><a href="#__codelineno-13-67">67</a></span>
<span class="normal"><a href="#__codelineno-13-68">68</a></span>
<span class="normal"><a href="#__codelineno-13-69">69</a></span>
<span class="normal"><a href="#__codelineno-13-70">70</a></span>
<span class="normal"><a href="#__codelineno-13-71">71</a></span>
<span class="normal"><a href="#__codelineno-13-72">72</a></span>
<span class="normal"><a href="#__codelineno-13-73">73</a></span>
<span class="normal"><a href="#__codelineno-13-74">74</a></span>
<span class="normal"><a href="#__codelineno-13-75">75</a></span>
<span class="normal"><a href="#__codelineno-13-76">76</a></span>
<span class="normal"><a href="#__codelineno-13-77">77</a></span>
<span class="normal"><a href="#__codelineno-13-78">78</a></span>
<span class="normal"><a href="#__codelineno-13-79">79</a></span>
<span class="normal"><a href="#__codelineno-13-80">80</a></span>
<span class="normal"><a href="#__codelineno-13-81">81</a></span>
<span class="normal"><a href="#__codelineno-13-82">82</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">480</span>
<a id="__codelineno-13-10" name="__codelineno-13-10"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-13-11" name="__codelineno-13-11"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-13-12" name="__codelineno-13-12"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-13-13" name="__codelineno-13-13"></a>
<a id="__codelineno-13-14" name="__codelineno-13-14"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-13-15" name="__codelineno-13-15"></a><span class="n">METEOR_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-13-16" name="__codelineno-13-16"></a><span class="n">METEOR_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-13-17" name="__codelineno-13-17"></a><span class="n">font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">SysFont</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
<a id="__codelineno-13-18" name="__codelineno-13-18"></a><span class="n">background</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/starfield.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-13-19" name="__codelineno-13-19"></a><span class="n">meteor_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/meteorBrown_med1.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-13-20" name="__codelineno-13-20"></a><span class="n">meteor_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">,</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-13-21" name="__codelineno-13-21"></a>
<a id="__codelineno-13-22" name="__codelineno-13-22"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-13-23" name="__codelineno-13-23"></a><span class="c1"># Definindo os novos tipos</span>
<a id="__codelineno-13-24" name="__codelineno-13-24"></a><span class="k">class</span> <span class="nc">Meteor</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-13-25" name="__codelineno-13-25"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
<a id="__codelineno-13-26" name="__codelineno-13-26"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-13-27" name="__codelineno-13-27"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-13-28" name="__codelineno-13-28"></a>
<a id="__codelineno-13-29" name="__codelineno-13-29"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">img</span>
<a id="__codelineno-13-30" name="__codelineno-13-30"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-13-31" name="__codelineno-13-31"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-13-32" name="__codelineno-13-32"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-13-33" name="__codelineno-13-33"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-13-34" name="__codelineno-13-34"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-13-35" name="__codelineno-13-35"></a>
<a id="__codelineno-13-36" name="__codelineno-13-36"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-13-37" name="__codelineno-13-37"></a>        <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-13-38" name="__codelineno-13-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-13-39" name="__codelineno-13-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-13-40" name="__codelineno-13-40"></a>        <span class="c1"># Se o meteoro passar do final da tela, volta para cima e sorteia</span>
<a id="__codelineno-13-41" name="__codelineno-13-41"></a>        <span class="c1"># novas posições e velocidades</span>
<a id="__codelineno-13-42" name="__codelineno-13-42"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-13-43" name="__codelineno-13-43"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-13-44" name="__codelineno-13-44"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-13-45" name="__codelineno-13-45"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-13-46" name="__codelineno-13-46"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-13-47" name="__codelineno-13-47"></a>
<a id="__codelineno-13-48" name="__codelineno-13-48"></a><span class="n">game</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-13-49" name="__codelineno-13-49"></a><span class="c1"># Variável para o ajuste de velocidade</span>
<a id="__codelineno-13-50" name="__codelineno-13-50"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<a id="__codelineno-13-51" name="__codelineno-13-51"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">30</span>
<a id="__codelineno-13-52" name="__codelineno-13-52"></a>
<a id="__codelineno-13-53" name="__codelineno-13-53"></a><span class="c1"># Criando dois meteoros</span>
<a id="__codelineno-13-54" name="__codelineno-13-54"></a><span class="n">meteor1</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">)</span>
<a id="__codelineno-13-55" name="__codelineno-13-55"></a><span class="n">meteor2</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">)</span>
<a id="__codelineno-13-56" name="__codelineno-13-56"></a>
<a id="__codelineno-13-57" name="__codelineno-13-57"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-13-58" name="__codelineno-13-58"></a><span class="k">while</span> <span class="n">game</span><span class="p">:</span>
<a id="__codelineno-13-59" name="__codelineno-13-59"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
<a id="__codelineno-13-60" name="__codelineno-13-60"></a>
<a id="__codelineno-13-61" name="__codelineno-13-61"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-13-62" name="__codelineno-13-62"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-13-63" name="__codelineno-13-63"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-13-64" name="__codelineno-13-64"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-13-65" name="__codelineno-13-65"></a>            <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-13-66" name="__codelineno-13-66"></a>
<a id="__codelineno-13-67" name="__codelineno-13-67"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-13-68" name="__codelineno-13-68"></a>    <span class="c1"># Atualizando a posição dos meteoros</span>
<a id="__codelineno-13-69" name="__codelineno-13-69"></a>    <span class="n">meteor1</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-13-70" name="__codelineno-13-70"></a>    <span class="n">meteor2</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-13-71" name="__codelineno-13-71"></a>
<a id="__codelineno-13-72" name="__codelineno-13-72"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-13-73" name="__codelineno-13-73"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-13-74" name="__codelineno-13-74"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">background</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-13-75" name="__codelineno-13-75"></a>    <span class="c1"># Desenhando meteoros</span>
<a id="__codelineno-13-76" name="__codelineno-13-76"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">meteor1</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">meteor1</span><span class="o">.</span><span class="n">rect</span><span class="p">)</span>
<a id="__codelineno-13-77" name="__codelineno-13-77"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">meteor2</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">meteor2</span><span class="o">.</span><span class="n">rect</span><span class="p">)</span>
<a id="__codelineno-13-78" name="__codelineno-13-78"></a>
<a id="__codelineno-13-79" name="__codelineno-13-79"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-13-80" name="__codelineno-13-80"></a>
<a id="__codelineno-13-81" name="__codelineno-13-81"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-13-82" name="__codelineno-13-82"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<p>As principais mudanças nesta versão são:</p>
<ul>
<li>Linhas 24 a 46: definição da classe <code class="language-python highlight"><span class="n">Meteor</span></code>;</li>
<li>Linhas 54 e 55: criação de dois meteoros. Note que o código que sorteava a posição do meteoro (linhas 27 a 32 do <code class="language-python highlight"><span class="n">jogo_v6</span><span class="o">.</span><span class="n">py</span></code>) agora está na inicialização (construtor) da classe <code class="language-python highlight"><span class="n">Meteor</span></code>, assim, ao criar dois meteoros, cada um será sorteado com posições e velocidades distintas;</li>
<li>Linhas 69 e 70: atualização da posição dos meteoros. A lógica de atualização da posição agora está concentrada na classe <code class="language-python highlight"><span class="n">Meteor</span></code>, assim não precisamos mais das linhas 49 a 57 do <code class="language-python highlight"><span class="n">jogo_v6</span><span class="o">.</span><span class="n">py</span></code>;</li>
<li>Linhas 76 e 77: desenhando os meteoros. O código é bastante semelhante ao que tínhamos antes, mas agora utilizamos a imagem e o rect (que define a posição da imagem) guardados como atributos de cada meteoro.</li>
</ul>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_7" id="exercise_7_0">
<p class="admonition-title">EXERCÍCIO 7</p>
<form class="exercise-form">
<p>Modifique o <code class="language-python highlight"><span class="n">jogo_v7</span><span class="o">.</span><span class="n">py</span></code> para que ele tenha 4 meteoros ao invés de 2.</p>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="adicionando-mais-meteoros-ainda">Adicionando mais meteoros ainda</h2>
<p>Conforme criamos mais meteoros, começa a ficar inviável utilizarmos uma variável para cada meteoro. Uma soluções (que já ajudaria muito), seria criarmos uma lista com todos os meteoros. O pygame define um novo tipo chamado <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span></code>, que é como uma lista, mas que tem algumas funcionalidades adicionais.</p>
<p>O <code class="language-python highlight"><span class="n">jogo_v8</span></code> utiliza o <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span></code> para criar vários grupos de uma vez. As principais mudanças neste arquivo são:</p>
<details class="info">
<summary>Código <code>referencia/jogo_v8.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span>
<span class="normal"><a href="#__codelineno-14-17">17</a></span>
<span class="normal"><a href="#__codelineno-14-18">18</a></span>
<span class="normal"><a href="#__codelineno-14-19">19</a></span>
<span class="normal"><a href="#__codelineno-14-20">20</a></span>
<span class="normal"><a href="#__codelineno-14-21">21</a></span>
<span class="normal"><a href="#__codelineno-14-22">22</a></span>
<span class="normal"><a href="#__codelineno-14-23">23</a></span>
<span class="normal"><a href="#__codelineno-14-24">24</a></span>
<span class="normal"><a href="#__codelineno-14-25">25</a></span>
<span class="normal"><a href="#__codelineno-14-26">26</a></span>
<span class="normal"><a href="#__codelineno-14-27">27</a></span>
<span class="normal"><a href="#__codelineno-14-28">28</a></span>
<span class="normal"><a href="#__codelineno-14-29">29</a></span>
<span class="normal"><a href="#__codelineno-14-30">30</a></span>
<span class="normal"><a href="#__codelineno-14-31">31</a></span>
<span class="normal"><a href="#__codelineno-14-32">32</a></span>
<span class="normal"><a href="#__codelineno-14-33">33</a></span>
<span class="normal"><a href="#__codelineno-14-34">34</a></span>
<span class="normal"><a href="#__codelineno-14-35">35</a></span>
<span class="normal"><a href="#__codelineno-14-36">36</a></span>
<span class="normal"><a href="#__codelineno-14-37">37</a></span>
<span class="normal"><a href="#__codelineno-14-38">38</a></span>
<span class="normal"><a href="#__codelineno-14-39">39</a></span>
<span class="normal"><a href="#__codelineno-14-40">40</a></span>
<span class="normal"><a href="#__codelineno-14-41">41</a></span>
<span class="normal"><a href="#__codelineno-14-42">42</a></span>
<span class="normal"><a href="#__codelineno-14-43">43</a></span>
<span class="normal"><a href="#__codelineno-14-44">44</a></span>
<span class="normal"><a href="#__codelineno-14-45">45</a></span>
<span class="normal"><a href="#__codelineno-14-46">46</a></span>
<span class="normal"><a href="#__codelineno-14-47">47</a></span>
<span class="normal"><a href="#__codelineno-14-48">48</a></span>
<span class="normal"><a href="#__codelineno-14-49">49</a></span>
<span class="normal"><a href="#__codelineno-14-50">50</a></span>
<span class="normal"><a href="#__codelineno-14-51">51</a></span>
<span class="normal"><a href="#__codelineno-14-52">52</a></span>
<span class="normal"><a href="#__codelineno-14-53">53</a></span>
<span class="normal"><a href="#__codelineno-14-54">54</a></span>
<span class="normal"><a href="#__codelineno-14-55">55</a></span>
<span class="normal"><a href="#__codelineno-14-56">56</a></span>
<span class="normal"><a href="#__codelineno-14-57">57</a></span>
<span class="normal"><a href="#__codelineno-14-58">58</a></span>
<span class="normal"><a href="#__codelineno-14-59">59</a></span>
<span class="normal"><a href="#__codelineno-14-60">60</a></span>
<span class="normal"><a href="#__codelineno-14-61">61</a></span>
<span class="normal"><a href="#__codelineno-14-62">62</a></span>
<span class="normal"><a href="#__codelineno-14-63">63</a></span>
<span class="normal"><a href="#__codelineno-14-64">64</a></span>
<span class="normal"><a href="#__codelineno-14-65">65</a></span>
<span class="normal"><a href="#__codelineno-14-66">66</a></span>
<span class="normal"><a href="#__codelineno-14-67">67</a></span>
<span class="normal"><a href="#__codelineno-14-68">68</a></span>
<span class="normal"><a href="#__codelineno-14-69">69</a></span>
<span class="normal"><a href="#__codelineno-14-70">70</a></span>
<span class="normal"><a href="#__codelineno-14-71">71</a></span>
<span class="normal"><a href="#__codelineno-14-72">72</a></span>
<span class="normal"><a href="#__codelineno-14-73">73</a></span>
<span class="normal"><a href="#__codelineno-14-74">74</a></span>
<span class="normal"><a href="#__codelineno-14-75">75</a></span>
<span class="normal"><a href="#__codelineno-14-76">76</a></span>
<span class="normal"><a href="#__codelineno-14-77">77</a></span>
<span class="normal"><a href="#__codelineno-14-78">78</a></span>
<span class="normal"><a href="#__codelineno-14-79">79</a></span>
<span class="normal"><a href="#__codelineno-14-80">80</a></span>
<span class="normal"><a href="#__codelineno-14-81">81</a></span>
<span class="normal"><a href="#__codelineno-14-82">82</a></span>
<span class="normal"><a href="#__codelineno-14-83">83</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-14-7" name="__codelineno-14-7"></a>
<a id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-14-9" name="__codelineno-14-9"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">480</span>
<a id="__codelineno-14-10" name="__codelineno-14-10"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-14-11" name="__codelineno-14-11"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-14-12" name="__codelineno-14-12"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-14-13" name="__codelineno-14-13"></a>
<a id="__codelineno-14-14" name="__codelineno-14-14"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-14-15" name="__codelineno-14-15"></a><span class="n">METEOR_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-14-16" name="__codelineno-14-16"></a><span class="n">METEOR_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-14-17" name="__codelineno-14-17"></a><span class="n">font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">SysFont</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
<a id="__codelineno-14-18" name="__codelineno-14-18"></a><span class="n">background</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/starfield.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-14-19" name="__codelineno-14-19"></a><span class="n">meteor_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/meteorBrown_med1.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-14-20" name="__codelineno-14-20"></a><span class="n">meteor_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">,</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-14-21" name="__codelineno-14-21"></a>
<a id="__codelineno-14-22" name="__codelineno-14-22"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-14-23" name="__codelineno-14-23"></a><span class="c1"># Definindo os novos tipos</span>
<a id="__codelineno-14-24" name="__codelineno-14-24"></a><span class="k">class</span> <span class="nc">Meteor</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-14-25" name="__codelineno-14-25"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
<a id="__codelineno-14-26" name="__codelineno-14-26"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-14-27" name="__codelineno-14-27"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-14-28" name="__codelineno-14-28"></a>
<a id="__codelineno-14-29" name="__codelineno-14-29"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">img</span>
<a id="__codelineno-14-30" name="__codelineno-14-30"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-14-31" name="__codelineno-14-31"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-14-32" name="__codelineno-14-32"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-14-33" name="__codelineno-14-33"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-14-34" name="__codelineno-14-34"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-14-35" name="__codelineno-14-35"></a>
<a id="__codelineno-14-36" name="__codelineno-14-36"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-14-37" name="__codelineno-14-37"></a>        <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-14-38" name="__codelineno-14-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-14-39" name="__codelineno-14-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-14-40" name="__codelineno-14-40"></a>        <span class="c1"># Se o meteoro passar do final da tela, volta para cima e sorteia</span>
<a id="__codelineno-14-41" name="__codelineno-14-41"></a>        <span class="c1"># novas posições e velocidades</span>
<a id="__codelineno-14-42" name="__codelineno-14-42"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-14-43" name="__codelineno-14-43"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-14-44" name="__codelineno-14-44"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-14-45" name="__codelineno-14-45"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-14-46" name="__codelineno-14-46"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-14-47" name="__codelineno-14-47"></a>
<a id="__codelineno-14-48" name="__codelineno-14-48"></a><span class="n">game</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-14-49" name="__codelineno-14-49"></a><span class="c1"># Variável para o ajuste de velocidade</span>
<a id="__codelineno-14-50" name="__codelineno-14-50"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<a id="__codelineno-14-51" name="__codelineno-14-51"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">30</span>
<a id="__codelineno-14-52" name="__codelineno-14-52"></a>
<a id="__codelineno-14-53" name="__codelineno-14-53"></a><span class="c1"># Criando um grupo de meteoros</span>
<a id="__codelineno-14-54" name="__codelineno-14-54"></a><span class="n">all_meteors</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-14-55" name="__codelineno-14-55"></a><span class="c1"># Criando os meteoros</span>
<a id="__codelineno-14-56" name="__codelineno-14-56"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a id="__codelineno-14-57" name="__codelineno-14-57"></a>    <span class="n">meteor</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">)</span>
<a id="__codelineno-14-58" name="__codelineno-14-58"></a>    <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-14-59" name="__codelineno-14-59"></a>
<a id="__codelineno-14-60" name="__codelineno-14-60"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-14-61" name="__codelineno-14-61"></a><span class="k">while</span> <span class="n">game</span><span class="p">:</span>
<a id="__codelineno-14-62" name="__codelineno-14-62"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
<a id="__codelineno-14-63" name="__codelineno-14-63"></a>
<a id="__codelineno-14-64" name="__codelineno-14-64"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-14-65" name="__codelineno-14-65"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-14-66" name="__codelineno-14-66"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-14-67" name="__codelineno-14-67"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-14-68" name="__codelineno-14-68"></a>            <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-14-69" name="__codelineno-14-69"></a>
<a id="__codelineno-14-70" name="__codelineno-14-70"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-14-71" name="__codelineno-14-71"></a>    <span class="c1"># Atualizando a posição dos meteoros</span>
<a id="__codelineno-14-72" name="__codelineno-14-72"></a>    <span class="n">all_meteors</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-14-73" name="__codelineno-14-73"></a>
<a id="__codelineno-14-74" name="__codelineno-14-74"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-14-75" name="__codelineno-14-75"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-14-76" name="__codelineno-14-76"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">background</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-14-77" name="__codelineno-14-77"></a>    <span class="c1"># Desenhando meteoros</span>
<a id="__codelineno-14-78" name="__codelineno-14-78"></a>    <span class="n">all_meteors</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-14-79" name="__codelineno-14-79"></a>
<a id="__codelineno-14-80" name="__codelineno-14-80"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-14-81" name="__codelineno-14-81"></a>
<a id="__codelineno-14-82" name="__codelineno-14-82"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-14-83" name="__codelineno-14-83"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<ul>
<li>Linhas 54 a 58: criação de um grupo de sprites e um <code class="language-python highlight"><span class="k">for</span></code> que cria e adiciona vários meteoros no grupo;</li>
<li>Linha 72: atualiza todos os sprites de uma vez. Por trás dos panos o pygame percorre todos os sprites dentro daquele grupo e chama o método <code class="language-python highlight"><span class="n">update</span></code> de cada um deles;</li>
<li>Linha 78: desenha todos os sprites de uma vez. Por trás dos panos o pygame percorre todos os sprites, desenhando um por um.</li>
</ul>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_8" id="exercise_8_0">
<p class="admonition-title">EXERCÍCIO 8</p>
<form class="exercise-form">
<p>Modifique o <code class="language-python highlight"><span class="n">jogo_v8</span><span class="o">.</span><span class="n">py</span></code> para que ele tenha 15 meteoros ao invés de 8. Além disso, vamos começar a nos preparar para implementar o jogador. Crie uma nova classe chamada <code class="language-python highlight"><span class="n">Ship</span></code> que também estende o tipo <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span></code> com a imagem <code class="language-python highlight"><span class="n">assets</span><span class="o">/</span><span class="n">img</span><span class="o">/</span><span class="n">playerShip1_orange</span><span class="o">.</span><span class="n">png</span></code>. A nave não deve se mover (não precisa implementar o <code class="language-python highlight"><span class="n">update</span></code>). Utilize os valores <code class="language-python highlight"><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span></code> e <code class="language-python highlight"><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span></code>.</p>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="adicionando-a-nave">Adicionando a nave</h2>
<p>O <code class="language-python highlight"><span class="n">jogo_v9</span><span class="o">.</span><span class="n">py</span></code> adiciona a classe <code class="language-python highlight"><span class="n">Ship</span></code> e cria uma nave. Ainda não é possível mover a nave, mas a classe já está preparada para isso. As principais mudanças são:</p>
<details class="info">
<summary>Código <code>referencia/jogo_v9.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">  1</a></span>
<span class="normal"><a href="#__codelineno-15-2">  2</a></span>
<span class="normal"><a href="#__codelineno-15-3">  3</a></span>
<span class="normal"><a href="#__codelineno-15-4">  4</a></span>
<span class="normal"><a href="#__codelineno-15-5">  5</a></span>
<span class="normal"><a href="#__codelineno-15-6">  6</a></span>
<span class="normal"><a href="#__codelineno-15-7">  7</a></span>
<span class="normal"><a href="#__codelineno-15-8">  8</a></span>
<span class="normal"><a href="#__codelineno-15-9">  9</a></span>
<span class="normal"><a href="#__codelineno-15-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-15-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-15-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-15-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-15-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-15-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-15-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-15-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-15-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-15-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-15-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-15-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-15-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-15-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-15-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-15-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-15-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-15-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-15-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-15-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-15-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-15-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-15-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-15-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-15-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-15-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-15-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-15-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-15-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-15-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-15-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-15-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-15-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-15-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-15-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-15-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-15-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-15-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-15-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-15-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-15-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-15-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-15-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-15-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-15-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-15-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-15-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-15-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-15-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-15-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-15-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-15-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-15-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-15-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-15-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-15-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-15-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-15-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-15-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-15-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-15-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-15-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-15-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-15-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-15-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-15-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-15-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-15-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-15-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-15-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-15-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-15-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-15-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-15-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-15-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-15-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-15-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-15-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-15-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-15-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-15-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-15-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-15-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-15-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-15-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-15-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-15-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-15-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-15-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-15-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-15-100">100</a></span>
<span class="normal"><a href="#__codelineno-15-101">101</a></span>
<span class="normal"><a href="#__codelineno-15-102">102</a></span>
<span class="normal"><a href="#__codelineno-15-103">103</a></span>
<span class="normal"><a href="#__codelineno-15-104">104</a></span>
<span class="normal"><a href="#__codelineno-15-105">105</a></span>
<span class="normal"><a href="#__codelineno-15-106">106</a></span>
<span class="normal"><a href="#__codelineno-15-107">107</a></span>
<span class="normal"><a href="#__codelineno-15-108">108</a></span>
<span class="normal"><a href="#__codelineno-15-109">109</a></span>
<span class="normal"><a href="#__codelineno-15-110">110</a></span>
<span class="normal"><a href="#__codelineno-15-111">111</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a>
<a id="__codelineno-15-6" name="__codelineno-15-6"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-15-7" name="__codelineno-15-7"></a>
<a id="__codelineno-15-8" name="__codelineno-15-8"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-15-9" name="__codelineno-15-9"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">480</span>
<a id="__codelineno-15-10" name="__codelineno-15-10"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-15-11" name="__codelineno-15-11"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-15-12" name="__codelineno-15-12"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-15-13" name="__codelineno-15-13"></a>
<a id="__codelineno-15-14" name="__codelineno-15-14"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-15-15" name="__codelineno-15-15"></a><span class="n">METEOR_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-15-16" name="__codelineno-15-16"></a><span class="n">METEOR_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-15-17" name="__codelineno-15-17"></a><span class="n">SHIP_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-15-18" name="__codelineno-15-18"></a><span class="n">SHIP_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-15-19" name="__codelineno-15-19"></a><span class="n">font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">SysFont</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
<a id="__codelineno-15-20" name="__codelineno-15-20"></a><span class="n">background</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/starfield.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-15-21" name="__codelineno-15-21"></a><span class="n">meteor_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/meteorBrown_med1.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-15-22" name="__codelineno-15-22"></a><span class="n">meteor_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">,</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-15-23" name="__codelineno-15-23"></a><span class="n">ship_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/playerShip1_orange.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-15-24" name="__codelineno-15-24"></a><span class="n">ship_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">ship_img</span><span class="p">,</span> <span class="p">(</span><span class="n">SHIP_WIDTH</span><span class="p">,</span> <span class="n">SHIP_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-15-25" name="__codelineno-15-25"></a>
<a id="__codelineno-15-26" name="__codelineno-15-26"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-15-27" name="__codelineno-15-27"></a><span class="c1"># Definindo os novos tipos</span>
<a id="__codelineno-15-28" name="__codelineno-15-28"></a><span class="k">class</span> <span class="nc">Ship</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-15-29" name="__codelineno-15-29"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
<a id="__codelineno-15-30" name="__codelineno-15-30"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-15-31" name="__codelineno-15-31"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-15-32" name="__codelineno-15-32"></a>
<a id="__codelineno-15-33" name="__codelineno-15-33"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">img</span>
<a id="__codelineno-15-34" name="__codelineno-15-34"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-15-35" name="__codelineno-15-35"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-15-36" name="__codelineno-15-36"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span>
<a id="__codelineno-15-37" name="__codelineno-15-37"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-15-38" name="__codelineno-15-38"></a>
<a id="__codelineno-15-39" name="__codelineno-15-39"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-15-40" name="__codelineno-15-40"></a>        <span class="c1"># Atualização da posição da nave</span>
<a id="__codelineno-15-41" name="__codelineno-15-41"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-15-42" name="__codelineno-15-42"></a>
<a id="__codelineno-15-43" name="__codelineno-15-43"></a>        <span class="c1"># Mantem dentro da tela</span>
<a id="__codelineno-15-44" name="__codelineno-15-44"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-15-45" name="__codelineno-15-45"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">WIDTH</span>
<a id="__codelineno-15-46" name="__codelineno-15-46"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-15-47" name="__codelineno-15-47"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-15-48" name="__codelineno-15-48"></a>
<a id="__codelineno-15-49" name="__codelineno-15-49"></a><span class="k">class</span> <span class="nc">Meteor</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-15-50" name="__codelineno-15-50"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
<a id="__codelineno-15-51" name="__codelineno-15-51"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-15-52" name="__codelineno-15-52"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-15-53" name="__codelineno-15-53"></a>
<a id="__codelineno-15-54" name="__codelineno-15-54"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">img</span>
<a id="__codelineno-15-55" name="__codelineno-15-55"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-15-56" name="__codelineno-15-56"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-15-57" name="__codelineno-15-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-15-58" name="__codelineno-15-58"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-15-59" name="__codelineno-15-59"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-15-60" name="__codelineno-15-60"></a>
<a id="__codelineno-15-61" name="__codelineno-15-61"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-15-62" name="__codelineno-15-62"></a>        <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-15-63" name="__codelineno-15-63"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-15-64" name="__codelineno-15-64"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-15-65" name="__codelineno-15-65"></a>        <span class="c1"># Se o meteoro passar do final da tela, volta para cima e sorteia</span>
<a id="__codelineno-15-66" name="__codelineno-15-66"></a>        <span class="c1"># novas posições e velocidades</span>
<a id="__codelineno-15-67" name="__codelineno-15-67"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-15-68" name="__codelineno-15-68"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-15-69" name="__codelineno-15-69"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-15-70" name="__codelineno-15-70"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-15-71" name="__codelineno-15-71"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-15-72" name="__codelineno-15-72"></a>
<a id="__codelineno-15-73" name="__codelineno-15-73"></a><span class="n">game</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-15-74" name="__codelineno-15-74"></a><span class="c1"># Variável para o ajuste de velocidade</span>
<a id="__codelineno-15-75" name="__codelineno-15-75"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<a id="__codelineno-15-76" name="__codelineno-15-76"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">30</span>
<a id="__codelineno-15-77" name="__codelineno-15-77"></a>
<a id="__codelineno-15-78" name="__codelineno-15-78"></a><span class="c1"># Criando um grupo de meteoros</span>
<a id="__codelineno-15-79" name="__codelineno-15-79"></a><span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-15-80" name="__codelineno-15-80"></a><span class="c1"># Criando o jogador</span>
<a id="__codelineno-15-81" name="__codelineno-15-81"></a><span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">ship_img</span><span class="p">)</span>
<a id="__codelineno-15-82" name="__codelineno-15-82"></a><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-15-83" name="__codelineno-15-83"></a><span class="c1"># Criando os meteoros</span>
<a id="__codelineno-15-84" name="__codelineno-15-84"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a id="__codelineno-15-85" name="__codelineno-15-85"></a>    <span class="n">meteor</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">)</span>
<a id="__codelineno-15-86" name="__codelineno-15-86"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-15-87" name="__codelineno-15-87"></a>
<a id="__codelineno-15-88" name="__codelineno-15-88"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-15-89" name="__codelineno-15-89"></a><span class="k">while</span> <span class="n">game</span><span class="p">:</span>
<a id="__codelineno-15-90" name="__codelineno-15-90"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
<a id="__codelineno-15-91" name="__codelineno-15-91"></a>
<a id="__codelineno-15-92" name="__codelineno-15-92"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-15-93" name="__codelineno-15-93"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-15-94" name="__codelineno-15-94"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-15-95" name="__codelineno-15-95"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-15-96" name="__codelineno-15-96"></a>            <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-15-97" name="__codelineno-15-97"></a>
<a id="__codelineno-15-98" name="__codelineno-15-98"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-15-99" name="__codelineno-15-99"></a>    <span class="c1"># Atualizando a posição dos meteoros</span>
<a id="__codelineno-15-100" name="__codelineno-15-100"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-15-101" name="__codelineno-15-101"></a>
<a id="__codelineno-15-102" name="__codelineno-15-102"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-15-103" name="__codelineno-15-103"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-15-104" name="__codelineno-15-104"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">background</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-15-105" name="__codelineno-15-105"></a>    <span class="c1"># Desenhando meteoros</span>
<a id="__codelineno-15-106" name="__codelineno-15-106"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-15-107" name="__codelineno-15-107"></a>
<a id="__codelineno-15-108" name="__codelineno-15-108"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-15-109" name="__codelineno-15-109"></a>
<a id="__codelineno-15-110" name="__codelineno-15-110"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-15-111" name="__codelineno-15-111"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<ul>
<li>Linhas 23 e 24: carrega a imagem da nave e redimensiona para um tamanho menor;</li>
<li>Linhas 28 a 47: define a classe <code class="language-python highlight"><span class="n">Ship</span></code>. O método <code class="language-python highlight"><span class="n">update</span></code> atualiza a posição <code class="language-python highlight"><span class="n">x</span></code> aplicando a velocidade e o <code class="language-python highlight"><span class="k">if</span></code> garante que a nave não saia da janela. Sempre que a nave sai da janela ela é movida para dentro da janela novamente. Note que a nave ainda não vai se mover, pois a velocidade no eixo x é zero. Além disso, não implementamos o movimento no eixo y, pois queremos que a nave apenas se mova para os lados;</li>
<li>Linhas 79 a 82: mudança do nome do grupo para <code class="language-python highlight"><span class="n">all_sprites</span></code>, pois agora guardaremos todos os sprites nesse mesmo grupo. Uma nave é criada e armazenada na variável <code class="language-python highlight"><span class="n">player</span></code>. Esse <code class="language-python highlight"><span class="n">player</span></code> é adicionado ao <code class="language-python highlight"><span class="n">all_sprites</span></code>, assim ao chamar <code class="language-python highlight"><span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></code> e <code class="language-python highlight"><span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">window</span><span class="p">)</span></code>, todos os meteoros e a nave serão atualizados e desenhados em um único comando.</li>
</ul>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_9" id="exercise_9_0">
<p class="admonition-title">EXERCÍCIO 9</p>
<form class="exercise-form">
<p>Modifique o <code class="language-python highlight"><span class="n">jogo_v9</span><span class="o">.</span><span class="n">py</span></code> para que a nave se mova com velocidade 5 para a esquerda. Se quiser, faça o seguinte teste adicional. Comente os blocos do <code class="language-python highlight"><span class="k">if</span></code> e <code class="language-python highlight"><span class="k">else</span></code> do <code class="language-python highlight"><span class="n">update</span></code> da nave e veja o que acontece.</p>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="movimento-da-nave">Movimento da nave</h2>
<p>Finalmente vamos adicionar alguma interação! Queremos que o jogador possa controlar o movimento da nave usando o teclado. Assim, quando ele apertar as setas do teclado para a esquerda ou para a direita, a nave deve se mover. Lembre-se que no início deste handout falamos que teclas apertadas são eventos. O tratamento de eventos é uma das etapas do loop principal. Até agora só utilizamos o tratamento de eventos para verificar se o usuário fechou a janela do jogo. O <code class="language-python highlight"><span class="n">jogo_v10</span><span class="o">.</span><span class="n">py</span></code> adiciona o tratamento dos eventos das setas do teclado. As principais mudanças estão nas linhas 98 a 110.</p>
<details class="info">
<summary>Código <code>referencia/jogo_v10.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">  1</a></span>
<span class="normal"><a href="#__codelineno-16-2">  2</a></span>
<span class="normal"><a href="#__codelineno-16-3">  3</a></span>
<span class="normal"><a href="#__codelineno-16-4">  4</a></span>
<span class="normal"><a href="#__codelineno-16-5">  5</a></span>
<span class="normal"><a href="#__codelineno-16-6">  6</a></span>
<span class="normal"><a href="#__codelineno-16-7">  7</a></span>
<span class="normal"><a href="#__codelineno-16-8">  8</a></span>
<span class="normal"><a href="#__codelineno-16-9">  9</a></span>
<span class="normal"><a href="#__codelineno-16-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-16-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-16-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-16-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-16-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-16-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-16-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-16-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-16-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-16-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-16-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-16-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-16-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-16-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-16-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-16-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-16-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-16-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-16-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-16-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-16-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-16-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-16-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-16-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-16-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-16-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-16-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-16-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-16-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-16-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-16-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-16-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-16-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-16-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-16-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-16-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-16-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-16-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-16-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-16-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-16-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-16-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-16-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-16-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-16-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-16-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-16-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-16-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-16-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-16-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-16-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-16-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-16-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-16-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-16-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-16-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-16-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-16-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-16-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-16-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-16-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-16-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-16-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-16-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-16-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-16-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-16-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-16-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-16-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-16-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-16-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-16-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-16-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-16-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-16-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-16-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-16-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-16-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-16-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-16-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-16-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-16-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-16-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-16-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-16-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-16-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-16-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-16-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-16-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-16-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-16-100">100</a></span>
<span class="normal"><a href="#__codelineno-16-101">101</a></span>
<span class="normal"><a href="#__codelineno-16-102">102</a></span>
<span class="normal"><a href="#__codelineno-16-103">103</a></span>
<span class="normal"><a href="#__codelineno-16-104">104</a></span>
<span class="normal"><a href="#__codelineno-16-105">105</a></span>
<span class="normal"><a href="#__codelineno-16-106">106</a></span>
<span class="normal"><a href="#__codelineno-16-107">107</a></span>
<span class="normal"><a href="#__codelineno-16-108">108</a></span>
<span class="normal"><a href="#__codelineno-16-109">109</a></span>
<span class="normal"><a href="#__codelineno-16-110">110</a></span>
<span class="normal"><a href="#__codelineno-16-111">111</a></span>
<span class="normal"><a href="#__codelineno-16-112">112</a></span>
<span class="normal"><a href="#__codelineno-16-113">113</a></span>
<span class="normal"><a href="#__codelineno-16-114">114</a></span>
<span class="normal"><a href="#__codelineno-16-115">115</a></span>
<span class="normal"><a href="#__codelineno-16-116">116</a></span>
<span class="normal"><a href="#__codelineno-16-117">117</a></span>
<span class="normal"><a href="#__codelineno-16-118">118</a></span>
<span class="normal"><a href="#__codelineno-16-119">119</a></span>
<span class="normal"><a href="#__codelineno-16-120">120</a></span>
<span class="normal"><a href="#__codelineno-16-121">121</a></span>
<span class="normal"><a href="#__codelineno-16-122">122</a></span>
<span class="normal"><a href="#__codelineno-16-123">123</a></span>
<span class="normal"><a href="#__codelineno-16-124">124</a></span>
<span class="normal"><a href="#__codelineno-16-125">125</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a>
<a id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-16-7" name="__codelineno-16-7"></a>
<a id="__codelineno-16-8" name="__codelineno-16-8"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-16-9" name="__codelineno-16-9"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">480</span>
<a id="__codelineno-16-10" name="__codelineno-16-10"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-16-11" name="__codelineno-16-11"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-16-12" name="__codelineno-16-12"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-16-13" name="__codelineno-16-13"></a>
<a id="__codelineno-16-14" name="__codelineno-16-14"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-16-15" name="__codelineno-16-15"></a><span class="n">METEOR_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-16-16" name="__codelineno-16-16"></a><span class="n">METEOR_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-16-17" name="__codelineno-16-17"></a><span class="n">SHIP_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-16-18" name="__codelineno-16-18"></a><span class="n">SHIP_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-16-19" name="__codelineno-16-19"></a><span class="n">font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">SysFont</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
<a id="__codelineno-16-20" name="__codelineno-16-20"></a><span class="n">background</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/starfield.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-16-21" name="__codelineno-16-21"></a><span class="n">meteor_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/meteorBrown_med1.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-16-22" name="__codelineno-16-22"></a><span class="n">meteor_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">,</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-16-23" name="__codelineno-16-23"></a><span class="n">ship_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/playerShip1_orange.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-16-24" name="__codelineno-16-24"></a><span class="n">ship_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">ship_img</span><span class="p">,</span> <span class="p">(</span><span class="n">SHIP_WIDTH</span><span class="p">,</span> <span class="n">SHIP_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-16-25" name="__codelineno-16-25"></a>
<a id="__codelineno-16-26" name="__codelineno-16-26"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-16-27" name="__codelineno-16-27"></a><span class="c1"># Definindo os novos tipos</span>
<a id="__codelineno-16-28" name="__codelineno-16-28"></a><span class="k">class</span> <span class="nc">Ship</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-16-29" name="__codelineno-16-29"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
<a id="__codelineno-16-30" name="__codelineno-16-30"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-16-31" name="__codelineno-16-31"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-16-32" name="__codelineno-16-32"></a>
<a id="__codelineno-16-33" name="__codelineno-16-33"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">img</span>
<a id="__codelineno-16-34" name="__codelineno-16-34"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-16-35" name="__codelineno-16-35"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-16-36" name="__codelineno-16-36"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span>
<a id="__codelineno-16-37" name="__codelineno-16-37"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-16-38" name="__codelineno-16-38"></a>
<a id="__codelineno-16-39" name="__codelineno-16-39"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-16-40" name="__codelineno-16-40"></a>        <span class="c1"># Atualização da posição da nave</span>
<a id="__codelineno-16-41" name="__codelineno-16-41"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-16-42" name="__codelineno-16-42"></a>
<a id="__codelineno-16-43" name="__codelineno-16-43"></a>        <span class="c1"># Mantem dentro da tela</span>
<a id="__codelineno-16-44" name="__codelineno-16-44"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-16-45" name="__codelineno-16-45"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">WIDTH</span>
<a id="__codelineno-16-46" name="__codelineno-16-46"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-16-47" name="__codelineno-16-47"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-16-48" name="__codelineno-16-48"></a>
<a id="__codelineno-16-49" name="__codelineno-16-49"></a><span class="k">class</span> <span class="nc">Meteor</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-16-50" name="__codelineno-16-50"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
<a id="__codelineno-16-51" name="__codelineno-16-51"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-16-52" name="__codelineno-16-52"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-16-53" name="__codelineno-16-53"></a>
<a id="__codelineno-16-54" name="__codelineno-16-54"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">img</span>
<a id="__codelineno-16-55" name="__codelineno-16-55"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-16-56" name="__codelineno-16-56"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-16-57" name="__codelineno-16-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-16-58" name="__codelineno-16-58"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-16-59" name="__codelineno-16-59"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-16-60" name="__codelineno-16-60"></a>
<a id="__codelineno-16-61" name="__codelineno-16-61"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-16-62" name="__codelineno-16-62"></a>        <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-16-63" name="__codelineno-16-63"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-16-64" name="__codelineno-16-64"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-16-65" name="__codelineno-16-65"></a>        <span class="c1"># Se o meteoro passar do final da tela, volta para cima e sorteia</span>
<a id="__codelineno-16-66" name="__codelineno-16-66"></a>        <span class="c1"># novas posições e velocidades</span>
<a id="__codelineno-16-67" name="__codelineno-16-67"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-16-68" name="__codelineno-16-68"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-16-69" name="__codelineno-16-69"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-16-70" name="__codelineno-16-70"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-16-71" name="__codelineno-16-71"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-16-72" name="__codelineno-16-72"></a>
<a id="__codelineno-16-73" name="__codelineno-16-73"></a><span class="n">game</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-16-74" name="__codelineno-16-74"></a><span class="c1"># Variável para o ajuste de velocidade</span>
<a id="__codelineno-16-75" name="__codelineno-16-75"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<a id="__codelineno-16-76" name="__codelineno-16-76"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">30</span>
<a id="__codelineno-16-77" name="__codelineno-16-77"></a>
<a id="__codelineno-16-78" name="__codelineno-16-78"></a><span class="c1"># Criando um grupo de meteoros</span>
<a id="__codelineno-16-79" name="__codelineno-16-79"></a><span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-16-80" name="__codelineno-16-80"></a><span class="c1"># Criando o jogador</span>
<a id="__codelineno-16-81" name="__codelineno-16-81"></a><span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">ship_img</span><span class="p">)</span>
<a id="__codelineno-16-82" name="__codelineno-16-82"></a><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-16-83" name="__codelineno-16-83"></a><span class="c1"># Criando os meteoros</span>
<a id="__codelineno-16-84" name="__codelineno-16-84"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a id="__codelineno-16-85" name="__codelineno-16-85"></a>    <span class="n">meteor</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">)</span>
<a id="__codelineno-16-86" name="__codelineno-16-86"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-16-87" name="__codelineno-16-87"></a>
<a id="__codelineno-16-88" name="__codelineno-16-88"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-16-89" name="__codelineno-16-89"></a><span class="k">while</span> <span class="n">game</span><span class="p">:</span>
<a id="__codelineno-16-90" name="__codelineno-16-90"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
<a id="__codelineno-16-91" name="__codelineno-16-91"></a>
<a id="__codelineno-16-92" name="__codelineno-16-92"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-16-93" name="__codelineno-16-93"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-16-94" name="__codelineno-16-94"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-16-95" name="__codelineno-16-95"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-16-96" name="__codelineno-16-96"></a>            <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-16-97" name="__codelineno-16-97"></a>        <span class="c1"># Verifica se apertou alguma tecla.</span>
<a id="__codelineno-16-98" name="__codelineno-16-98"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>
<a id="__codelineno-16-99" name="__codelineno-16-99"></a>            <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-16-100" name="__codelineno-16-100"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-16-101" name="__codelineno-16-101"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-16-102" name="__codelineno-16-102"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-16-103" name="__codelineno-16-103"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-16-104" name="__codelineno-16-104"></a>        <span class="c1"># Verifica se soltou alguma tecla.</span>
<a id="__codelineno-16-105" name="__codelineno-16-105"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYUP</span><span class="p">:</span>
<a id="__codelineno-16-106" name="__codelineno-16-106"></a>            <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-16-107" name="__codelineno-16-107"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-16-108" name="__codelineno-16-108"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-16-109" name="__codelineno-16-109"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-16-110" name="__codelineno-16-110"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-16-111" name="__codelineno-16-111"></a>
<a id="__codelineno-16-112" name="__codelineno-16-112"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-16-113" name="__codelineno-16-113"></a>    <span class="c1"># Atualizando a posição dos meteoros</span>
<a id="__codelineno-16-114" name="__codelineno-16-114"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-16-115" name="__codelineno-16-115"></a>
<a id="__codelineno-16-116" name="__codelineno-16-116"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-16-117" name="__codelineno-16-117"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-16-118" name="__codelineno-16-118"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">background</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-16-119" name="__codelineno-16-119"></a>    <span class="c1"># Desenhando meteoros</span>
<a id="__codelineno-16-120" name="__codelineno-16-120"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-16-121" name="__codelineno-16-121"></a>
<a id="__codelineno-16-122" name="__codelineno-16-122"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-16-123" name="__codelineno-16-123"></a>
<a id="__codelineno-16-124" name="__codelineno-16-124"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-16-125" name="__codelineno-16-125"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<p>Quando o jogador aperta uma tecla (evento do tipo <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span></code>), se a tecla apertada for a seta para a direita ou para a esquerda, nós aumentamos ou diminuimos a velocidade da nave. QUando o jogador solta a tecla (evento do tipo <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">KEYUP</span></code>), se a tecla apertada for a seta para a direita ou para a esquerda, nós desfazemos a ação daquela tecla (diminuir ou aumentar a velocidade da nave). Note que esses eventos só ocorrem no instante em que a tecla é apertada. Se o jogador apertar a tecla e não soltar, o evento <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span></code> só será recebido uma vez e assim a velocidade só vai aumentar uma vez.</p>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_10" id="exercise_10_0">
<p class="admonition-title">EXERCÍCIO 10</p>
<form class="exercise-form">
<p>Modifique o <code class="language-python highlight"><span class="n">jogo_v10</span><span class="o">.</span><span class="n">py</span></code> para que a nave se mova com metade da velocidade.</p>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="tratamento-de-colisoes-da-nave-com-os-meteoros">Tratamento de colisões da nave com os meteoros</h2>
<p>Já podemos movimentar a nave, mas quando um meteoro encosta na nave, nada acontece. Queremos que o jogo acabe quando um meteoro encostar na nave. O <code class="language-python highlight"><span class="n">jogo_v11</span><span class="o">.</span><span class="n">py</span></code> implementa essa funcionalidade. O pygame disponibiliza uma função que verifica se houve uma colisão entre um sprite e um grupo de sprites, o <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">spritecollide</span></code>. Essa função recebe um sprite, um grupo de sprites e um valor booleano que indica se, ao ocorrer uma colisão, o elemento do grupo que colidiu com o sprite deve morrer ou não (morrer nesse caso significa que o sprite deixará de existir). As principais mudanças neste arquivo são:</p>
<details class="info">
<summary>Código <code>referencia/jogo_v11.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">  1</a></span>
<span class="normal"><a href="#__codelineno-17-2">  2</a></span>
<span class="normal"><a href="#__codelineno-17-3">  3</a></span>
<span class="normal"><a href="#__codelineno-17-4">  4</a></span>
<span class="normal"><a href="#__codelineno-17-5">  5</a></span>
<span class="normal"><a href="#__codelineno-17-6">  6</a></span>
<span class="normal"><a href="#__codelineno-17-7">  7</a></span>
<span class="normal"><a href="#__codelineno-17-8">  8</a></span>
<span class="normal"><a href="#__codelineno-17-9">  9</a></span>
<span class="normal"><a href="#__codelineno-17-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-17-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-17-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-17-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-17-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-17-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-17-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-17-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-17-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-17-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-17-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-17-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-17-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-17-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-17-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-17-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-17-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-17-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-17-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-17-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-17-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-17-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-17-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-17-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-17-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-17-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-17-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-17-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-17-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-17-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-17-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-17-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-17-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-17-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-17-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-17-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-17-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-17-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-17-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-17-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-17-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-17-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-17-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-17-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-17-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-17-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-17-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-17-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-17-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-17-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-17-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-17-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-17-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-17-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-17-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-17-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-17-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-17-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-17-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-17-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-17-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-17-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-17-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-17-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-17-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-17-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-17-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-17-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-17-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-17-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-17-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-17-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-17-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-17-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-17-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-17-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-17-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-17-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-17-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-17-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-17-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-17-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-17-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-17-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-17-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-17-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-17-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-17-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-17-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-17-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-17-100">100</a></span>
<span class="normal"><a href="#__codelineno-17-101">101</a></span>
<span class="normal"><a href="#__codelineno-17-102">102</a></span>
<span class="normal"><a href="#__codelineno-17-103">103</a></span>
<span class="normal"><a href="#__codelineno-17-104">104</a></span>
<span class="normal"><a href="#__codelineno-17-105">105</a></span>
<span class="normal"><a href="#__codelineno-17-106">106</a></span>
<span class="normal"><a href="#__codelineno-17-107">107</a></span>
<span class="normal"><a href="#__codelineno-17-108">108</a></span>
<span class="normal"><a href="#__codelineno-17-109">109</a></span>
<span class="normal"><a href="#__codelineno-17-110">110</a></span>
<span class="normal"><a href="#__codelineno-17-111">111</a></span>
<span class="normal"><a href="#__codelineno-17-112">112</a></span>
<span class="normal"><a href="#__codelineno-17-113">113</a></span>
<span class="normal"><a href="#__codelineno-17-114">114</a></span>
<span class="normal"><a href="#__codelineno-17-115">115</a></span>
<span class="normal"><a href="#__codelineno-17-116">116</a></span>
<span class="normal"><a href="#__codelineno-17-117">117</a></span>
<span class="normal"><a href="#__codelineno-17-118">118</a></span>
<span class="normal"><a href="#__codelineno-17-119">119</a></span>
<span class="normal"><a href="#__codelineno-17-120">120</a></span>
<span class="normal"><a href="#__codelineno-17-121">121</a></span>
<span class="normal"><a href="#__codelineno-17-122">122</a></span>
<span class="normal"><a href="#__codelineno-17-123">123</a></span>
<span class="normal"><a href="#__codelineno-17-124">124</a></span>
<span class="normal"><a href="#__codelineno-17-125">125</a></span>
<span class="normal"><a href="#__codelineno-17-126">126</a></span>
<span class="normal"><a href="#__codelineno-17-127">127</a></span>
<span class="normal"><a href="#__codelineno-17-128">128</a></span>
<span class="normal"><a href="#__codelineno-17-129">129</a></span>
<span class="normal"><a href="#__codelineno-17-130">130</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-17-5" name="__codelineno-17-5"></a>
<a id="__codelineno-17-6" name="__codelineno-17-6"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-17-7" name="__codelineno-17-7"></a>
<a id="__codelineno-17-8" name="__codelineno-17-8"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-17-9" name="__codelineno-17-9"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">480</span>
<a id="__codelineno-17-10" name="__codelineno-17-10"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-17-11" name="__codelineno-17-11"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-17-12" name="__codelineno-17-12"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-17-13" name="__codelineno-17-13"></a>
<a id="__codelineno-17-14" name="__codelineno-17-14"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-17-15" name="__codelineno-17-15"></a><span class="n">METEOR_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-17-16" name="__codelineno-17-16"></a><span class="n">METEOR_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-17-17" name="__codelineno-17-17"></a><span class="n">SHIP_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-17-18" name="__codelineno-17-18"></a><span class="n">SHIP_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-17-19" name="__codelineno-17-19"></a><span class="n">font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">SysFont</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
<a id="__codelineno-17-20" name="__codelineno-17-20"></a><span class="n">background</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/starfield.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-17-21" name="__codelineno-17-21"></a><span class="n">meteor_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/meteorBrown_med1.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-17-22" name="__codelineno-17-22"></a><span class="n">meteor_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">,</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-17-23" name="__codelineno-17-23"></a><span class="n">ship_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/playerShip1_orange.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-17-24" name="__codelineno-17-24"></a><span class="n">ship_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">ship_img</span><span class="p">,</span> <span class="p">(</span><span class="n">SHIP_WIDTH</span><span class="p">,</span> <span class="n">SHIP_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-17-25" name="__codelineno-17-25"></a>
<a id="__codelineno-17-26" name="__codelineno-17-26"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-17-27" name="__codelineno-17-27"></a><span class="c1"># Definindo os novos tipos</span>
<a id="__codelineno-17-28" name="__codelineno-17-28"></a><span class="k">class</span> <span class="nc">Ship</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-17-29" name="__codelineno-17-29"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
<a id="__codelineno-17-30" name="__codelineno-17-30"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-17-31" name="__codelineno-17-31"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-17-32" name="__codelineno-17-32"></a>
<a id="__codelineno-17-33" name="__codelineno-17-33"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">img</span>
<a id="__codelineno-17-34" name="__codelineno-17-34"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-17-35" name="__codelineno-17-35"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-17-36" name="__codelineno-17-36"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span>
<a id="__codelineno-17-37" name="__codelineno-17-37"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-17-38" name="__codelineno-17-38"></a>
<a id="__codelineno-17-39" name="__codelineno-17-39"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-17-40" name="__codelineno-17-40"></a>        <span class="c1"># Atualização da posição da nave</span>
<a id="__codelineno-17-41" name="__codelineno-17-41"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-17-42" name="__codelineno-17-42"></a>
<a id="__codelineno-17-43" name="__codelineno-17-43"></a>        <span class="c1"># Mantem dentro da tela</span>
<a id="__codelineno-17-44" name="__codelineno-17-44"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-17-45" name="__codelineno-17-45"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">WIDTH</span>
<a id="__codelineno-17-46" name="__codelineno-17-46"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-17-47" name="__codelineno-17-47"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-17-48" name="__codelineno-17-48"></a>
<a id="__codelineno-17-49" name="__codelineno-17-49"></a><span class="k">class</span> <span class="nc">Meteor</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-17-50" name="__codelineno-17-50"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
<a id="__codelineno-17-51" name="__codelineno-17-51"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-17-52" name="__codelineno-17-52"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-17-53" name="__codelineno-17-53"></a>
<a id="__codelineno-17-54" name="__codelineno-17-54"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">img</span>
<a id="__codelineno-17-55" name="__codelineno-17-55"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-17-56" name="__codelineno-17-56"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-17-57" name="__codelineno-17-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-17-58" name="__codelineno-17-58"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-17-59" name="__codelineno-17-59"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-17-60" name="__codelineno-17-60"></a>
<a id="__codelineno-17-61" name="__codelineno-17-61"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-17-62" name="__codelineno-17-62"></a>        <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-17-63" name="__codelineno-17-63"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-17-64" name="__codelineno-17-64"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-17-65" name="__codelineno-17-65"></a>        <span class="c1"># Se o meteoro passar do final da tela, volta para cima e sorteia</span>
<a id="__codelineno-17-66" name="__codelineno-17-66"></a>        <span class="c1"># novas posições e velocidades</span>
<a id="__codelineno-17-67" name="__codelineno-17-67"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-17-68" name="__codelineno-17-68"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-17-69" name="__codelineno-17-69"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-17-70" name="__codelineno-17-70"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-17-71" name="__codelineno-17-71"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-17-72" name="__codelineno-17-72"></a>
<a id="__codelineno-17-73" name="__codelineno-17-73"></a><span class="n">game</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-17-74" name="__codelineno-17-74"></a><span class="c1"># Variável para o ajuste de velocidade</span>
<a id="__codelineno-17-75" name="__codelineno-17-75"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<a id="__codelineno-17-76" name="__codelineno-17-76"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">30</span>
<a id="__codelineno-17-77" name="__codelineno-17-77"></a>
<a id="__codelineno-17-78" name="__codelineno-17-78"></a><span class="c1"># Criando um grupo de meteoros</span>
<a id="__codelineno-17-79" name="__codelineno-17-79"></a><span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-17-80" name="__codelineno-17-80"></a><span class="n">all_meteors</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-17-81" name="__codelineno-17-81"></a><span class="c1"># Criando o jogador</span>
<a id="__codelineno-17-82" name="__codelineno-17-82"></a><span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">ship_img</span><span class="p">)</span>
<a id="__codelineno-17-83" name="__codelineno-17-83"></a><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-17-84" name="__codelineno-17-84"></a><span class="c1"># Criando os meteoros</span>
<a id="__codelineno-17-85" name="__codelineno-17-85"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a id="__codelineno-17-86" name="__codelineno-17-86"></a>    <span class="n">meteor</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">)</span>
<a id="__codelineno-17-87" name="__codelineno-17-87"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-17-88" name="__codelineno-17-88"></a>    <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-17-89" name="__codelineno-17-89"></a>
<a id="__codelineno-17-90" name="__codelineno-17-90"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-17-91" name="__codelineno-17-91"></a><span class="k">while</span> <span class="n">game</span><span class="p">:</span>
<a id="__codelineno-17-92" name="__codelineno-17-92"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
<a id="__codelineno-17-93" name="__codelineno-17-93"></a>
<a id="__codelineno-17-94" name="__codelineno-17-94"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-17-95" name="__codelineno-17-95"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-17-96" name="__codelineno-17-96"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-17-97" name="__codelineno-17-97"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-17-98" name="__codelineno-17-98"></a>            <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-17-99" name="__codelineno-17-99"></a>        <span class="c1"># Verifica se apertou alguma tecla.</span>
<a id="__codelineno-17-100" name="__codelineno-17-100"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>
<a id="__codelineno-17-101" name="__codelineno-17-101"></a>            <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-17-102" name="__codelineno-17-102"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-17-103" name="__codelineno-17-103"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-17-104" name="__codelineno-17-104"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-17-105" name="__codelineno-17-105"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-17-106" name="__codelineno-17-106"></a>        <span class="c1"># Verifica se soltou alguma tecla.</span>
<a id="__codelineno-17-107" name="__codelineno-17-107"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYUP</span><span class="p">:</span>
<a id="__codelineno-17-108" name="__codelineno-17-108"></a>            <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-17-109" name="__codelineno-17-109"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-17-110" name="__codelineno-17-110"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-17-111" name="__codelineno-17-111"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-17-112" name="__codelineno-17-112"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-17-113" name="__codelineno-17-113"></a>
<a id="__codelineno-17-114" name="__codelineno-17-114"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-17-115" name="__codelineno-17-115"></a>    <span class="c1"># Atualizando a posição dos meteoros</span>
<a id="__codelineno-17-116" name="__codelineno-17-116"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-17-117" name="__codelineno-17-117"></a>
<a id="__codelineno-17-118" name="__codelineno-17-118"></a>    <span class="c1"># Verifica se houve colisão entre nave e meteoro</span>
<a id="__codelineno-17-119" name="__codelineno-17-119"></a>    <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">spritecollide</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">all_meteors</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-17-120" name="__codelineno-17-120"></a>
<a id="__codelineno-17-121" name="__codelineno-17-121"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-17-122" name="__codelineno-17-122"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-17-123" name="__codelineno-17-123"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">background</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-17-124" name="__codelineno-17-124"></a>    <span class="c1"># Desenhando meteoros</span>
<a id="__codelineno-17-125" name="__codelineno-17-125"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-17-126" name="__codelineno-17-126"></a>
<a id="__codelineno-17-127" name="__codelineno-17-127"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-17-128" name="__codelineno-17-128"></a>
<a id="__codelineno-17-129" name="__codelineno-17-129"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-17-130" name="__codelineno-17-130"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<ul>
<li>Linhas 80 e 88: criação de mais um grupo de sprites. Cada meteoro é colocado em dois grupos, no grupo de todos os sprites (<code class="language-python highlight"><span class="n">all_sprites</span></code>), que é utilizado para atualizar e desenhar todos os sprites na tela, e o grupo dos meteoros (<code class="language-python highlight"><span class="n">all_meteors</span></code>), que será utilizado para verificar a colisão da nave com todos os meteoros de uma vez;</li>
<li>Linha 119: verifica a colisão do <code class="language-python highlight"><span class="n">player</span></code> (nave) com o <code class="language-python highlight"><span class="n">all_meteors</span></code>. A função retorna uma lista com todos os meteoros que colidiram com a nave. Se ela não estiver vazia significa que houve uma colisão.</li>
</ul>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_11" id="exercise_11_0">
<p class="admonition-title">EXERCÍCIO 11</p>
<form class="exercise-form">
<p>A versão atual faz com que os meteoros morram ao encostar na nave, mas nada além disso acontece. Modifique o <code class="language-python highlight"><span class="n">jogo_v11</span><span class="o">.</span><span class="n">py</span></code> para que o jogo acabe se a nave colidir com um meteoro (dica: basta verificar uma condição e modificar <code class="language-python highlight"><span class="n">game</span></code> para <code class="language-python highlight"><span class="kc">False</span></code>).</p>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="fazendo-a-nave-atirar">Fazendo a nave atirar</h2>
<p>Vamos implementar a funcionalidade de tiro. Queremos que um tiro seja criado quando o jogador apertar a tecla <code class="language-python highlight"><span class="n">ESPAÇO</span></code>. Execute o <code class="language-python highlight"><span class="n">jogo_v12</span><span class="o">.</span><span class="n">py</span></code> para ver o resultado. Depois abra o código.</p>
<details class="info">
<summary>Código <code>referencia/jogo_v12.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">  1</a></span>
<span class="normal"><a href="#__codelineno-18-2">  2</a></span>
<span class="normal"><a href="#__codelineno-18-3">  3</a></span>
<span class="normal"><a href="#__codelineno-18-4">  4</a></span>
<span class="normal"><a href="#__codelineno-18-5">  5</a></span>
<span class="normal"><a href="#__codelineno-18-6">  6</a></span>
<span class="normal"><a href="#__codelineno-18-7">  7</a></span>
<span class="normal"><a href="#__codelineno-18-8">  8</a></span>
<span class="normal"><a href="#__codelineno-18-9">  9</a></span>
<span class="normal"><a href="#__codelineno-18-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-18-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-18-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-18-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-18-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-18-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-18-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-18-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-18-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-18-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-18-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-18-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-18-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-18-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-18-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-18-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-18-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-18-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-18-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-18-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-18-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-18-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-18-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-18-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-18-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-18-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-18-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-18-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-18-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-18-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-18-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-18-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-18-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-18-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-18-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-18-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-18-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-18-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-18-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-18-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-18-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-18-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-18-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-18-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-18-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-18-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-18-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-18-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-18-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-18-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-18-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-18-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-18-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-18-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-18-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-18-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-18-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-18-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-18-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-18-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-18-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-18-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-18-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-18-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-18-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-18-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-18-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-18-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-18-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-18-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-18-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-18-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-18-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-18-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-18-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-18-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-18-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-18-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-18-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-18-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-18-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-18-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-18-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-18-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-18-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-18-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-18-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-18-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-18-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-18-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-18-100">100</a></span>
<span class="normal"><a href="#__codelineno-18-101">101</a></span>
<span class="normal"><a href="#__codelineno-18-102">102</a></span>
<span class="normal"><a href="#__codelineno-18-103">103</a></span>
<span class="normal"><a href="#__codelineno-18-104">104</a></span>
<span class="normal"><a href="#__codelineno-18-105">105</a></span>
<span class="normal"><a href="#__codelineno-18-106">106</a></span>
<span class="normal"><a href="#__codelineno-18-107">107</a></span>
<span class="normal"><a href="#__codelineno-18-108">108</a></span>
<span class="normal"><a href="#__codelineno-18-109">109</a></span>
<span class="normal"><a href="#__codelineno-18-110">110</a></span>
<span class="normal"><a href="#__codelineno-18-111">111</a></span>
<span class="normal"><a href="#__codelineno-18-112">112</a></span>
<span class="normal"><a href="#__codelineno-18-113">113</a></span>
<span class="normal"><a href="#__codelineno-18-114">114</a></span>
<span class="normal"><a href="#__codelineno-18-115">115</a></span>
<span class="normal"><a href="#__codelineno-18-116">116</a></span>
<span class="normal"><a href="#__codelineno-18-117">117</a></span>
<span class="normal"><a href="#__codelineno-18-118">118</a></span>
<span class="normal"><a href="#__codelineno-18-119">119</a></span>
<span class="normal"><a href="#__codelineno-18-120">120</a></span>
<span class="normal"><a href="#__codelineno-18-121">121</a></span>
<span class="normal"><a href="#__codelineno-18-122">122</a></span>
<span class="normal"><a href="#__codelineno-18-123">123</a></span>
<span class="normal"><a href="#__codelineno-18-124">124</a></span>
<span class="normal"><a href="#__codelineno-18-125">125</a></span>
<span class="normal"><a href="#__codelineno-18-126">126</a></span>
<span class="normal"><a href="#__codelineno-18-127">127</a></span>
<span class="normal"><a href="#__codelineno-18-128">128</a></span>
<span class="normal"><a href="#__codelineno-18-129">129</a></span>
<span class="normal"><a href="#__codelineno-18-130">130</a></span>
<span class="normal"><a href="#__codelineno-18-131">131</a></span>
<span class="normal"><a href="#__codelineno-18-132">132</a></span>
<span class="normal"><a href="#__codelineno-18-133">133</a></span>
<span class="normal"><a href="#__codelineno-18-134">134</a></span>
<span class="normal"><a href="#__codelineno-18-135">135</a></span>
<span class="normal"><a href="#__codelineno-18-136">136</a></span>
<span class="normal"><a href="#__codelineno-18-137">137</a></span>
<span class="normal"><a href="#__codelineno-18-138">138</a></span>
<span class="normal"><a href="#__codelineno-18-139">139</a></span>
<span class="normal"><a href="#__codelineno-18-140">140</a></span>
<span class="normal"><a href="#__codelineno-18-141">141</a></span>
<span class="normal"><a href="#__codelineno-18-142">142</a></span>
<span class="normal"><a href="#__codelineno-18-143">143</a></span>
<span class="normal"><a href="#__codelineno-18-144">144</a></span>
<span class="normal"><a href="#__codelineno-18-145">145</a></span>
<span class="normal"><a href="#__codelineno-18-146">146</a></span>
<span class="normal"><a href="#__codelineno-18-147">147</a></span>
<span class="normal"><a href="#__codelineno-18-148">148</a></span>
<span class="normal"><a href="#__codelineno-18-149">149</a></span>
<span class="normal"><a href="#__codelineno-18-150">150</a></span>
<span class="normal"><a href="#__codelineno-18-151">151</a></span>
<span class="normal"><a href="#__codelineno-18-152">152</a></span>
<span class="normal"><a href="#__codelineno-18-153">153</a></span>
<span class="normal"><a href="#__codelineno-18-154">154</a></span>
<span class="normal"><a href="#__codelineno-18-155">155</a></span>
<span class="normal"><a href="#__codelineno-18-156">156</a></span>
<span class="normal"><a href="#__codelineno-18-157">157</a></span>
<span class="normal"><a href="#__codelineno-18-158">158</a></span>
<span class="normal"><a href="#__codelineno-18-159">159</a></span>
<span class="normal"><a href="#__codelineno-18-160">160</a></span>
<span class="normal"><a href="#__codelineno-18-161">161</a></span>
<span class="normal"><a href="#__codelineno-18-162">162</a></span>
<span class="normal"><a href="#__codelineno-18-163">163</a></span>
<span class="normal"><a href="#__codelineno-18-164">164</a></span>
<span class="normal"><a href="#__codelineno-18-165">165</a></span>
<span class="normal"><a href="#__codelineno-18-166">166</a></span>
<span class="normal"><a href="#__codelineno-18-167">167</a></span>
<span class="normal"><a href="#__codelineno-18-168">168</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-18-4" name="__codelineno-18-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-18-5" name="__codelineno-18-5"></a>
<a id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-18-7" name="__codelineno-18-7"></a>
<a id="__codelineno-18-8" name="__codelineno-18-8"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-18-9" name="__codelineno-18-9"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">480</span>
<a id="__codelineno-18-10" name="__codelineno-18-10"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-18-11" name="__codelineno-18-11"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-18-12" name="__codelineno-18-12"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-18-13" name="__codelineno-18-13"></a>
<a id="__codelineno-18-14" name="__codelineno-18-14"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-18-15" name="__codelineno-18-15"></a><span class="n">METEOR_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-18-16" name="__codelineno-18-16"></a><span class="n">METEOR_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-18-17" name="__codelineno-18-17"></a><span class="n">SHIP_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-18-18" name="__codelineno-18-18"></a><span class="n">SHIP_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-18-19" name="__codelineno-18-19"></a><span class="n">font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">SysFont</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
<a id="__codelineno-18-20" name="__codelineno-18-20"></a><span class="n">background</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/starfield.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-18-21" name="__codelineno-18-21"></a><span class="n">meteor_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/meteorBrown_med1.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-18-22" name="__codelineno-18-22"></a><span class="n">meteor_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">,</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-18-23" name="__codelineno-18-23"></a><span class="n">ship_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/playerShip1_orange.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-18-24" name="__codelineno-18-24"></a><span class="n">ship_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">ship_img</span><span class="p">,</span> <span class="p">(</span><span class="n">SHIP_WIDTH</span><span class="p">,</span> <span class="n">SHIP_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-18-25" name="__codelineno-18-25"></a><span class="n">bullet_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/laserRed16.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-18-26" name="__codelineno-18-26"></a>
<a id="__codelineno-18-27" name="__codelineno-18-27"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-18-28" name="__codelineno-18-28"></a><span class="c1"># Definindo os novos tipos</span>
<a id="__codelineno-18-29" name="__codelineno-18-29"></a><span class="k">class</span> <span class="nc">Ship</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-18-30" name="__codelineno-18-30"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">all_sprites</span><span class="p">,</span> <span class="n">all_bullets</span><span class="p">,</span> <span class="n">bullet_img</span><span class="p">):</span>
<a id="__codelineno-18-31" name="__codelineno-18-31"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-18-32" name="__codelineno-18-32"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-18-33" name="__codelineno-18-33"></a>
<a id="__codelineno-18-34" name="__codelineno-18-34"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">img</span>
<a id="__codelineno-18-35" name="__codelineno-18-35"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-18-36" name="__codelineno-18-36"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-18-37" name="__codelineno-18-37"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span>
<a id="__codelineno-18-38" name="__codelineno-18-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-18-39" name="__codelineno-18-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_sprites</span> <span class="o">=</span> <span class="n">all_sprites</span>
<a id="__codelineno-18-40" name="__codelineno-18-40"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_bullets</span> <span class="o">=</span> <span class="n">all_bullets</span>
<a id="__codelineno-18-41" name="__codelineno-18-41"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bullet_img</span> <span class="o">=</span> <span class="n">bullet_img</span>
<a id="__codelineno-18-42" name="__codelineno-18-42"></a>
<a id="__codelineno-18-43" name="__codelineno-18-43"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-18-44" name="__codelineno-18-44"></a>        <span class="c1"># Atualização da posição da nave</span>
<a id="__codelineno-18-45" name="__codelineno-18-45"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-18-46" name="__codelineno-18-46"></a>
<a id="__codelineno-18-47" name="__codelineno-18-47"></a>        <span class="c1"># Mantem dentro da tela</span>
<a id="__codelineno-18-48" name="__codelineno-18-48"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-18-49" name="__codelineno-18-49"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">WIDTH</span>
<a id="__codelineno-18-50" name="__codelineno-18-50"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-18-51" name="__codelineno-18-51"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-18-52" name="__codelineno-18-52"></a>
<a id="__codelineno-18-53" name="__codelineno-18-53"></a>    <span class="k">def</span> <span class="nf">shoot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-18-54" name="__codelineno-18-54"></a>        <span class="c1"># A nova bala vai ser criada logo acima e no centro horizontal da nave</span>
<a id="__codelineno-18-55" name="__codelineno-18-55"></a>        <span class="n">new_bullet</span> <span class="o">=</span> <span class="n">Bullet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bullet_img</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span><span class="p">)</span>
<a id="__codelineno-18-56" name="__codelineno-18-56"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-18-57" name="__codelineno-18-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_bullets</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-18-58" name="__codelineno-18-58"></a>
<a id="__codelineno-18-59" name="__codelineno-18-59"></a><span class="k">class</span> <span class="nc">Meteor</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-18-60" name="__codelineno-18-60"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
<a id="__codelineno-18-61" name="__codelineno-18-61"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-18-62" name="__codelineno-18-62"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-18-63" name="__codelineno-18-63"></a>
<a id="__codelineno-18-64" name="__codelineno-18-64"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">img</span>
<a id="__codelineno-18-65" name="__codelineno-18-65"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-18-66" name="__codelineno-18-66"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-18-67" name="__codelineno-18-67"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-18-68" name="__codelineno-18-68"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-18-69" name="__codelineno-18-69"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-18-70" name="__codelineno-18-70"></a>
<a id="__codelineno-18-71" name="__codelineno-18-71"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-18-72" name="__codelineno-18-72"></a>        <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-18-73" name="__codelineno-18-73"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-18-74" name="__codelineno-18-74"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-18-75" name="__codelineno-18-75"></a>        <span class="c1"># Se o meteoro passar do final da tela, volta para cima e sorteia</span>
<a id="__codelineno-18-76" name="__codelineno-18-76"></a>        <span class="c1"># novas posições e velocidades</span>
<a id="__codelineno-18-77" name="__codelineno-18-77"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-18-78" name="__codelineno-18-78"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-18-79" name="__codelineno-18-79"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-18-80" name="__codelineno-18-80"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-18-81" name="__codelineno-18-81"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-18-82" name="__codelineno-18-82"></a>
<a id="__codelineno-18-83" name="__codelineno-18-83"></a><span class="c1"># Classe Bullet que representa os tiros</span>
<a id="__codelineno-18-84" name="__codelineno-18-84"></a><span class="k">class</span> <span class="nc">Bullet</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-18-85" name="__codelineno-18-85"></a>    <span class="c1"># Construtor da classe.</span>
<a id="__codelineno-18-86" name="__codelineno-18-86"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">centerx</span><span class="p">):</span>
<a id="__codelineno-18-87" name="__codelineno-18-87"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-18-88" name="__codelineno-18-88"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-18-89" name="__codelineno-18-89"></a>
<a id="__codelineno-18-90" name="__codelineno-18-90"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">img</span>
<a id="__codelineno-18-91" name="__codelineno-18-91"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-18-92" name="__codelineno-18-92"></a>
<a id="__codelineno-18-93" name="__codelineno-18-93"></a>        <span class="c1"># Coloca no lugar inicial definido em x, y do constutor</span>
<a id="__codelineno-18-94" name="__codelineno-18-94"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">centerx</span>
<a id="__codelineno-18-95" name="__codelineno-18-95"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">bottom</span>
<a id="__codelineno-18-96" name="__codelineno-18-96"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>  <span class="c1"># Velocidade fixa para cima</span>
<a id="__codelineno-18-97" name="__codelineno-18-97"></a>
<a id="__codelineno-18-98" name="__codelineno-18-98"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-18-99" name="__codelineno-18-99"></a>        <span class="c1"># A bala só se move no eixo y</span>
<a id="__codelineno-18-100" name="__codelineno-18-100"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-18-101" name="__codelineno-18-101"></a>
<a id="__codelineno-18-102" name="__codelineno-18-102"></a>        <span class="c1"># Se o tiro passar do inicio da tela, morre.</span>
<a id="__codelineno-18-103" name="__codelineno-18-103"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-18-104" name="__codelineno-18-104"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-18-105" name="__codelineno-18-105"></a>
<a id="__codelineno-18-106" name="__codelineno-18-106"></a><span class="n">game</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-18-107" name="__codelineno-18-107"></a><span class="c1"># Variável para o ajuste de velocidade</span>
<a id="__codelineno-18-108" name="__codelineno-18-108"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<a id="__codelineno-18-109" name="__codelineno-18-109"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">30</span>
<a id="__codelineno-18-110" name="__codelineno-18-110"></a>
<a id="__codelineno-18-111" name="__codelineno-18-111"></a><span class="c1"># Criando um grupo de meteoros</span>
<a id="__codelineno-18-112" name="__codelineno-18-112"></a><span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-18-113" name="__codelineno-18-113"></a><span class="n">all_meteors</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-18-114" name="__codelineno-18-114"></a><span class="n">all_bullets</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-18-115" name="__codelineno-18-115"></a><span class="c1"># Criando o jogador</span>
<a id="__codelineno-18-116" name="__codelineno-18-116"></a><span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">ship_img</span><span class="p">,</span> <span class="n">all_sprites</span><span class="p">,</span> <span class="n">all_bullets</span><span class="p">,</span> <span class="n">bullet_img</span><span class="p">)</span>
<a id="__codelineno-18-117" name="__codelineno-18-117"></a><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-18-118" name="__codelineno-18-118"></a><span class="c1"># Criando os meteoros</span>
<a id="__codelineno-18-119" name="__codelineno-18-119"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a id="__codelineno-18-120" name="__codelineno-18-120"></a>    <span class="n">meteor</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">)</span>
<a id="__codelineno-18-121" name="__codelineno-18-121"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-18-122" name="__codelineno-18-122"></a>    <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-18-123" name="__codelineno-18-123"></a>
<a id="__codelineno-18-124" name="__codelineno-18-124"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-18-125" name="__codelineno-18-125"></a><span class="k">while</span> <span class="n">game</span><span class="p">:</span>
<a id="__codelineno-18-126" name="__codelineno-18-126"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
<a id="__codelineno-18-127" name="__codelineno-18-127"></a>
<a id="__codelineno-18-128" name="__codelineno-18-128"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-18-129" name="__codelineno-18-129"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-18-130" name="__codelineno-18-130"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-18-131" name="__codelineno-18-131"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-18-132" name="__codelineno-18-132"></a>            <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-18-133" name="__codelineno-18-133"></a>        <span class="c1"># Verifica se apertou alguma tecla.</span>
<a id="__codelineno-18-134" name="__codelineno-18-134"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>
<a id="__codelineno-18-135" name="__codelineno-18-135"></a>            <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-18-136" name="__codelineno-18-136"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-18-137" name="__codelineno-18-137"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-18-138" name="__codelineno-18-138"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-18-139" name="__codelineno-18-139"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-18-140" name="__codelineno-18-140"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_SPACE</span><span class="p">:</span>
<a id="__codelineno-18-141" name="__codelineno-18-141"></a>                <span class="n">player</span><span class="o">.</span><span class="n">shoot</span><span class="p">()</span>
<a id="__codelineno-18-142" name="__codelineno-18-142"></a>        <span class="c1"># Verifica se soltou alguma tecla.</span>
<a id="__codelineno-18-143" name="__codelineno-18-143"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYUP</span><span class="p">:</span>
<a id="__codelineno-18-144" name="__codelineno-18-144"></a>            <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-18-145" name="__codelineno-18-145"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-18-146" name="__codelineno-18-146"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-18-147" name="__codelineno-18-147"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-18-148" name="__codelineno-18-148"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-18-149" name="__codelineno-18-149"></a>
<a id="__codelineno-18-150" name="__codelineno-18-150"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-18-151" name="__codelineno-18-151"></a>    <span class="c1"># Atualizando a posição dos meteoros</span>
<a id="__codelineno-18-152" name="__codelineno-18-152"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-18-153" name="__codelineno-18-153"></a>
<a id="__codelineno-18-154" name="__codelineno-18-154"></a>    <span class="c1"># Verifica se houve colisão entre nave e meteoro</span>
<a id="__codelineno-18-155" name="__codelineno-18-155"></a>    <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">spritecollide</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">all_meteors</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-18-156" name="__codelineno-18-156"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hits</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-18-157" name="__codelineno-18-157"></a>        <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-18-158" name="__codelineno-18-158"></a>
<a id="__codelineno-18-159" name="__codelineno-18-159"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-18-160" name="__codelineno-18-160"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-18-161" name="__codelineno-18-161"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">background</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-18-162" name="__codelineno-18-162"></a>    <span class="c1"># Desenhando meteoros</span>
<a id="__codelineno-18-163" name="__codelineno-18-163"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-18-164" name="__codelineno-18-164"></a>
<a id="__codelineno-18-165" name="__codelineno-18-165"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-18-166" name="__codelineno-18-166"></a>
<a id="__codelineno-18-167" name="__codelineno-18-167"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-18-168" name="__codelineno-18-168"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<p>Neste código, criamos um sprite <code class="language-python highlight"><span class="n">Bullet</span></code> e um novo método <code class="language-python highlight"><span class="n">shoot</span></code> na classe <code class="language-python highlight"><span class="n">Ship</span></code>. Esse método será chamado sempre que quisermos que a nave atire. O problema é que o sprite precisa ser adicionado ao grupo de sprites para ser desenhado, mas como ele será criado dentro do método <code class="language-python highlight"><span class="n">shoot</span></code>, nós não temos acesso às variáveis que estão no nosso programa. A solução para esse problema é guardar o grupo dentro do jogador. Assim, quando ele atirar ele já terá acesso ao grupo para adicionar a nova bala. Fazemos isso modificando o <code class="language-python highlight"><span class="fm">__init__</span></code> (construtor) do <code class="language-python highlight"><span class="n">Ship</span></code>. Além da imagem da nave ele passará a receber o grupo de todos os sprites, um grupo para guardar as balas e a imagem da bala. Esses valores são guardados dentro da nave nas linhas 39 a 41. Esses valores são utilizados pelo método <code class="language-python highlight"><span class="n">shoot</span></code> (linhas 53 a 57). As principais mudanças nesta versão são:</p>
<ul>
<li>Linhas 30 e 39 a 41: quando é criada, a nave recebe o grupo de sprites, o grupo de balas e a imagem da bala. Ela armazena esses valores nos atributos (variáveis disponíveis no <code class="language-python highlight"><span class="bp">self</span></code>) para usar quando o <code class="language-python highlight"><span class="n">shoot</span></code> for chamado;</li>
<li>Linhas 53 a 57: método <code class="language-python highlight"><span class="n">shoot</span></code>. Esse método será chamado quando a tecla espaço for apertada. Uma nova bala é criada e adicionada nos grupos de sprites e de balas;</li>
<li>Linhas 84 a 104: classe <code class="language-python highlight"><span class="n">Bullet</span></code>. Uma bala só se move para cima com velocidade 10. Quando ela não está mais visível ela morre (<code class="language-python highlight"><span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span></code>);</li>
<li>Linhas 114 e 116: um novo grupo de balas é criado. O grupo de sprites, o grupo de balas e a imagem da bala são utilizadas para que um <code class="language-python highlight"><span class="n">Ship</span></code> seja criado. Esse <code class="language-python highlight"><span class="n">Ship</span></code> vai armazenar esses valores dentro de si mesmo;</li>
<li>Linhas 140 e 141: quando a tecla <code class="language-python highlight"><span class="n">ESPAÇO</span></code> é apertada a nave atira.</li>
</ul>
<p>Note que não precisamos mudar as linhas que chamam o <code class="language-python highlight"><span class="n">update</span></code> dos sprites e que desenham (<code class="language-python highlight"><span class="n">draw</span></code>) todos os sprites, pois as balas também serão adicionadas no grupo de todos os sprites (<code class="language-python highlight"><span class="n">all_sprites</span></code>).</p>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_12" id="exercise_12_0">
<p class="admonition-title">EXERCÍCIO 12</p>
<form class="exercise-form">
<p>As balas ainda não tem nenhum efeito sobre os meteoros. Implemente a colisão das balas com os meteoros. A função <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">spritecollide</span></code> verificava se <strong>um</strong> sprite havia colidido com <strong>algum sprite de um grupo</strong>. Agora queremos verificar se <strong>algum sprite do grupo</strong> de balas colidiu com <strong>algum sprite do grupo</strong> de meteoros. Para isso temos a função <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">groupcollide</span></code>, que recebe dois grupos de sprites e dois valores booleanos (<code class="language-python highlight"><span class="kc">True</span></code> ou <code class="language-python highlight"><span class="kc">False</span></code>) que indicam se um elemento do primeiro grupo deve morrer ao colidir com algum elemento do segundo grupo e vice-versa.</p>
<p><strong>Importante:</strong> essa função retorna um dicionário no qual as chaves são elementos do primeiro grupo (primeiro argumento da função) e os valores são listas de elementos do segundo grupo (segundo argumento) que colidiram com ele. Se esse dicionário estiver vazio significa que não houve nenhuma colisão entre os dois grupos.</p>
<p>Faça com que, ao colidirem, tanto a bala, quanto o meteoro morram. Você vai notar que depois de um tempo não haverá mais nenhum meteoro. Não se preocupe com isso por enquanto.</p>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="adicionando-som">Adicionando som</h2>
<p>O pygame também é capaz de tocar sons. Para isso, além de carregar os arquivos de áudio, é necessário inicializar o uso de sons no pygame com a função <code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span></code>. O <code class="language-python highlight"><span class="n">jogo_v13</span><span class="o">.</span><span class="n">py</span></code> implementa os sons de explosão e tiro da nave. As principais modificações são:</p>
<details class="info">
<summary>Código <code>referencia/jogo_v13.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">  1</a></span>
<span class="normal"><a href="#__codelineno-19-2">  2</a></span>
<span class="normal"><a href="#__codelineno-19-3">  3</a></span>
<span class="normal"><a href="#__codelineno-19-4">  4</a></span>
<span class="normal"><a href="#__codelineno-19-5">  5</a></span>
<span class="normal"><a href="#__codelineno-19-6">  6</a></span>
<span class="normal"><a href="#__codelineno-19-7">  7</a></span>
<span class="normal"><a href="#__codelineno-19-8">  8</a></span>
<span class="normal"><a href="#__codelineno-19-9">  9</a></span>
<span class="normal"><a href="#__codelineno-19-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-19-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-19-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-19-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-19-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-19-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-19-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-19-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-19-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-19-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-19-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-19-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-19-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-19-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-19-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-19-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-19-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-19-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-19-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-19-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-19-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-19-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-19-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-19-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-19-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-19-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-19-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-19-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-19-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-19-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-19-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-19-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-19-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-19-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-19-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-19-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-19-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-19-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-19-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-19-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-19-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-19-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-19-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-19-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-19-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-19-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-19-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-19-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-19-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-19-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-19-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-19-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-19-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-19-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-19-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-19-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-19-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-19-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-19-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-19-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-19-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-19-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-19-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-19-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-19-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-19-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-19-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-19-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-19-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-19-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-19-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-19-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-19-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-19-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-19-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-19-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-19-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-19-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-19-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-19-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-19-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-19-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-19-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-19-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-19-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-19-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-19-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-19-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-19-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-19-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-19-100">100</a></span>
<span class="normal"><a href="#__codelineno-19-101">101</a></span>
<span class="normal"><a href="#__codelineno-19-102">102</a></span>
<span class="normal"><a href="#__codelineno-19-103">103</a></span>
<span class="normal"><a href="#__codelineno-19-104">104</a></span>
<span class="normal"><a href="#__codelineno-19-105">105</a></span>
<span class="normal"><a href="#__codelineno-19-106">106</a></span>
<span class="normal"><a href="#__codelineno-19-107">107</a></span>
<span class="normal"><a href="#__codelineno-19-108">108</a></span>
<span class="normal"><a href="#__codelineno-19-109">109</a></span>
<span class="normal"><a href="#__codelineno-19-110">110</a></span>
<span class="normal"><a href="#__codelineno-19-111">111</a></span>
<span class="normal"><a href="#__codelineno-19-112">112</a></span>
<span class="normal"><a href="#__codelineno-19-113">113</a></span>
<span class="normal"><a href="#__codelineno-19-114">114</a></span>
<span class="normal"><a href="#__codelineno-19-115">115</a></span>
<span class="normal"><a href="#__codelineno-19-116">116</a></span>
<span class="normal"><a href="#__codelineno-19-117">117</a></span>
<span class="normal"><a href="#__codelineno-19-118">118</a></span>
<span class="normal"><a href="#__codelineno-19-119">119</a></span>
<span class="normal"><a href="#__codelineno-19-120">120</a></span>
<span class="normal"><a href="#__codelineno-19-121">121</a></span>
<span class="normal"><a href="#__codelineno-19-122">122</a></span>
<span class="normal"><a href="#__codelineno-19-123">123</a></span>
<span class="normal"><a href="#__codelineno-19-124">124</a></span>
<span class="normal"><a href="#__codelineno-19-125">125</a></span>
<span class="normal"><a href="#__codelineno-19-126">126</a></span>
<span class="normal"><a href="#__codelineno-19-127">127</a></span>
<span class="normal"><a href="#__codelineno-19-128">128</a></span>
<span class="normal"><a href="#__codelineno-19-129">129</a></span>
<span class="normal"><a href="#__codelineno-19-130">130</a></span>
<span class="normal"><a href="#__codelineno-19-131">131</a></span>
<span class="normal"><a href="#__codelineno-19-132">132</a></span>
<span class="normal"><a href="#__codelineno-19-133">133</a></span>
<span class="normal"><a href="#__codelineno-19-134">134</a></span>
<span class="normal"><a href="#__codelineno-19-135">135</a></span>
<span class="normal"><a href="#__codelineno-19-136">136</a></span>
<span class="normal"><a href="#__codelineno-19-137">137</a></span>
<span class="normal"><a href="#__codelineno-19-138">138</a></span>
<span class="normal"><a href="#__codelineno-19-139">139</a></span>
<span class="normal"><a href="#__codelineno-19-140">140</a></span>
<span class="normal"><a href="#__codelineno-19-141">141</a></span>
<span class="normal"><a href="#__codelineno-19-142">142</a></span>
<span class="normal"><a href="#__codelineno-19-143">143</a></span>
<span class="normal"><a href="#__codelineno-19-144">144</a></span>
<span class="normal"><a href="#__codelineno-19-145">145</a></span>
<span class="normal"><a href="#__codelineno-19-146">146</a></span>
<span class="normal"><a href="#__codelineno-19-147">147</a></span>
<span class="normal"><a href="#__codelineno-19-148">148</a></span>
<span class="normal"><a href="#__codelineno-19-149">149</a></span>
<span class="normal"><a href="#__codelineno-19-150">150</a></span>
<span class="normal"><a href="#__codelineno-19-151">151</a></span>
<span class="normal"><a href="#__codelineno-19-152">152</a></span>
<span class="normal"><a href="#__codelineno-19-153">153</a></span>
<span class="normal"><a href="#__codelineno-19-154">154</a></span>
<span class="normal"><a href="#__codelineno-19-155">155</a></span>
<span class="normal"><a href="#__codelineno-19-156">156</a></span>
<span class="normal"><a href="#__codelineno-19-157">157</a></span>
<span class="normal"><a href="#__codelineno-19-158">158</a></span>
<span class="normal"><a href="#__codelineno-19-159">159</a></span>
<span class="normal"><a href="#__codelineno-19-160">160</a></span>
<span class="normal"><a href="#__codelineno-19-161">161</a></span>
<span class="normal"><a href="#__codelineno-19-162">162</a></span>
<span class="normal"><a href="#__codelineno-19-163">163</a></span>
<span class="normal"><a href="#__codelineno-19-164">164</a></span>
<span class="normal"><a href="#__codelineno-19-165">165</a></span>
<span class="normal"><a href="#__codelineno-19-166">166</a></span>
<span class="normal"><a href="#__codelineno-19-167">167</a></span>
<span class="normal"><a href="#__codelineno-19-168">168</a></span>
<span class="normal"><a href="#__codelineno-19-169">169</a></span>
<span class="normal"><a href="#__codelineno-19-170">170</a></span>
<span class="normal"><a href="#__codelineno-19-171">171</a></span>
<span class="normal"><a href="#__codelineno-19-172">172</a></span>
<span class="normal"><a href="#__codelineno-19-173">173</a></span>
<span class="normal"><a href="#__codelineno-19-174">174</a></span>
<span class="normal"><a href="#__codelineno-19-175">175</a></span>
<span class="normal"><a href="#__codelineno-19-176">176</a></span>
<span class="normal"><a href="#__codelineno-19-177">177</a></span>
<span class="normal"><a href="#__codelineno-19-178">178</a></span>
<span class="normal"><a href="#__codelineno-19-179">179</a></span>
<span class="normal"><a href="#__codelineno-19-180">180</a></span>
<span class="normal"><a href="#__codelineno-19-181">181</a></span>
<span class="normal"><a href="#__codelineno-19-182">182</a></span>
<span class="normal"><a href="#__codelineno-19-183">183</a></span>
<span class="normal"><a href="#__codelineno-19-184">184</a></span>
<span class="normal"><a href="#__codelineno-19-185">185</a></span>
<span class="normal"><a href="#__codelineno-19-186">186</a></span>
<span class="normal"><a href="#__codelineno-19-187">187</a></span>
<span class="normal"><a href="#__codelineno-19-188">188</a></span>
<span class="normal"><a href="#__codelineno-19-189">189</a></span>
<span class="normal"><a href="#__codelineno-19-190">190</a></span>
<span class="normal"><a href="#__codelineno-19-191">191</a></span>
<span class="normal"><a href="#__codelineno-19-192">192</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="kn">import</span> <span class="nn">time</span>
<a id="__codelineno-19-6" name="__codelineno-19-6"></a>
<a id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-19-8" name="__codelineno-19-8"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-19-9" name="__codelineno-19-9"></a>
<a id="__codelineno-19-10" name="__codelineno-19-10"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-19-11" name="__codelineno-19-11"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">480</span>
<a id="__codelineno-19-12" name="__codelineno-19-12"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-19-13" name="__codelineno-19-13"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-19-14" name="__codelineno-19-14"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-19-15" name="__codelineno-19-15"></a>
<a id="__codelineno-19-16" name="__codelineno-19-16"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-19-17" name="__codelineno-19-17"></a><span class="n">METEOR_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-19-18" name="__codelineno-19-18"></a><span class="n">METEOR_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-19-19" name="__codelineno-19-19"></a><span class="n">SHIP_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-19-20" name="__codelineno-19-20"></a><span class="n">SHIP_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-19-21" name="__codelineno-19-21"></a><span class="n">font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">SysFont</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
<a id="__codelineno-19-22" name="__codelineno-19-22"></a><span class="n">background</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/starfield.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-19-23" name="__codelineno-19-23"></a><span class="n">meteor_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/meteorBrown_med1.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-19-24" name="__codelineno-19-24"></a><span class="n">meteor_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">,</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-19-25" name="__codelineno-19-25"></a><span class="n">ship_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/playerShip1_orange.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-19-26" name="__codelineno-19-26"></a><span class="n">ship_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">ship_img</span><span class="p">,</span> <span class="p">(</span><span class="n">SHIP_WIDTH</span><span class="p">,</span> <span class="n">SHIP_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-19-27" name="__codelineno-19-27"></a><span class="n">bullet_img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/laserRed16.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-19-28" name="__codelineno-19-28"></a>
<a id="__codelineno-19-29" name="__codelineno-19-29"></a><span class="c1"># Carrega os sons do jogo</span>
<a id="__codelineno-19-30" name="__codelineno-19-30"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/snd/tgfcoder-FrozenJam-SeamlessLoop.ogg&#39;</span><span class="p">)</span>
<a id="__codelineno-19-31" name="__codelineno-19-31"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">set_volume</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
<a id="__codelineno-19-32" name="__codelineno-19-32"></a><span class="n">boom_sound</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/expl3.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-19-33" name="__codelineno-19-33"></a><span class="n">destroy_sound</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/expl6.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-19-34" name="__codelineno-19-34"></a><span class="n">pew_sound</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/pew.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-19-35" name="__codelineno-19-35"></a>
<a id="__codelineno-19-36" name="__codelineno-19-36"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-19-37" name="__codelineno-19-37"></a><span class="c1"># Definindo os novos tipos</span>
<a id="__codelineno-19-38" name="__codelineno-19-38"></a><span class="k">class</span> <span class="nc">Ship</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-19-39" name="__codelineno-19-39"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">all_sprites</span><span class="p">,</span> <span class="n">all_bullets</span><span class="p">,</span> <span class="n">bullet_img</span><span class="p">,</span> <span class="n">pew_sound</span><span class="p">):</span>
<a id="__codelineno-19-40" name="__codelineno-19-40"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-19-41" name="__codelineno-19-41"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-19-42" name="__codelineno-19-42"></a>
<a id="__codelineno-19-43" name="__codelineno-19-43"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">img</span>
<a id="__codelineno-19-44" name="__codelineno-19-44"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-19-45" name="__codelineno-19-45"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-19-46" name="__codelineno-19-46"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span>
<a id="__codelineno-19-47" name="__codelineno-19-47"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-19-48" name="__codelineno-19-48"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_sprites</span> <span class="o">=</span> <span class="n">all_sprites</span>
<a id="__codelineno-19-49" name="__codelineno-19-49"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_bullets</span> <span class="o">=</span> <span class="n">all_bullets</span>
<a id="__codelineno-19-50" name="__codelineno-19-50"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bullet_img</span> <span class="o">=</span> <span class="n">bullet_img</span>
<a id="__codelineno-19-51" name="__codelineno-19-51"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pew_sound</span> <span class="o">=</span> <span class="n">pew_sound</span>
<a id="__codelineno-19-52" name="__codelineno-19-52"></a>
<a id="__codelineno-19-53" name="__codelineno-19-53"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-19-54" name="__codelineno-19-54"></a>        <span class="c1"># Atualização da posição da nave</span>
<a id="__codelineno-19-55" name="__codelineno-19-55"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-19-56" name="__codelineno-19-56"></a>
<a id="__codelineno-19-57" name="__codelineno-19-57"></a>        <span class="c1"># Mantem dentro da tela</span>
<a id="__codelineno-19-58" name="__codelineno-19-58"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-19-59" name="__codelineno-19-59"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">WIDTH</span>
<a id="__codelineno-19-60" name="__codelineno-19-60"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-19-61" name="__codelineno-19-61"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-19-62" name="__codelineno-19-62"></a>
<a id="__codelineno-19-63" name="__codelineno-19-63"></a>    <span class="k">def</span> <span class="nf">shoot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-19-64" name="__codelineno-19-64"></a>        <span class="c1"># A nova bala vai ser criada logo acima e no centro horizontal da nave</span>
<a id="__codelineno-19-65" name="__codelineno-19-65"></a>        <span class="n">new_bullet</span> <span class="o">=</span> <span class="n">Bullet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bullet_img</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span><span class="p">)</span>
<a id="__codelineno-19-66" name="__codelineno-19-66"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-19-67" name="__codelineno-19-67"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_bullets</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-19-68" name="__codelineno-19-68"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pew_sound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-19-69" name="__codelineno-19-69"></a>
<a id="__codelineno-19-70" name="__codelineno-19-70"></a><span class="k">class</span> <span class="nc">Meteor</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-19-71" name="__codelineno-19-71"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
<a id="__codelineno-19-72" name="__codelineno-19-72"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-19-73" name="__codelineno-19-73"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-19-74" name="__codelineno-19-74"></a>
<a id="__codelineno-19-75" name="__codelineno-19-75"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">img</span>
<a id="__codelineno-19-76" name="__codelineno-19-76"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-19-77" name="__codelineno-19-77"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-19-78" name="__codelineno-19-78"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-19-79" name="__codelineno-19-79"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-19-80" name="__codelineno-19-80"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-19-81" name="__codelineno-19-81"></a>
<a id="__codelineno-19-82" name="__codelineno-19-82"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-19-83" name="__codelineno-19-83"></a>        <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-19-84" name="__codelineno-19-84"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-19-85" name="__codelineno-19-85"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-19-86" name="__codelineno-19-86"></a>        <span class="c1"># Se o meteoro passar do final da tela, volta para cima e sorteia</span>
<a id="__codelineno-19-87" name="__codelineno-19-87"></a>        <span class="c1"># novas posições e velocidades</span>
<a id="__codelineno-19-88" name="__codelineno-19-88"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-19-89" name="__codelineno-19-89"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-19-90" name="__codelineno-19-90"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-19-91" name="__codelineno-19-91"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-19-92" name="__codelineno-19-92"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-19-93" name="__codelineno-19-93"></a>
<a id="__codelineno-19-94" name="__codelineno-19-94"></a><span class="c1"># Classe Bullet que representa os tiros</span>
<a id="__codelineno-19-95" name="__codelineno-19-95"></a><span class="k">class</span> <span class="nc">Bullet</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-19-96" name="__codelineno-19-96"></a>    <span class="c1"># Construtor da classe.</span>
<a id="__codelineno-19-97" name="__codelineno-19-97"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">centerx</span><span class="p">):</span>
<a id="__codelineno-19-98" name="__codelineno-19-98"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-19-99" name="__codelineno-19-99"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-19-100" name="__codelineno-19-100"></a>
<a id="__codelineno-19-101" name="__codelineno-19-101"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">img</span>
<a id="__codelineno-19-102" name="__codelineno-19-102"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-19-103" name="__codelineno-19-103"></a>
<a id="__codelineno-19-104" name="__codelineno-19-104"></a>        <span class="c1"># Coloca no lugar inicial definido em x, y do constutor</span>
<a id="__codelineno-19-105" name="__codelineno-19-105"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">centerx</span>
<a id="__codelineno-19-106" name="__codelineno-19-106"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">bottom</span>
<a id="__codelineno-19-107" name="__codelineno-19-107"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>  <span class="c1"># Velocidade fixa para cima</span>
<a id="__codelineno-19-108" name="__codelineno-19-108"></a>
<a id="__codelineno-19-109" name="__codelineno-19-109"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-19-110" name="__codelineno-19-110"></a>        <span class="c1"># A bala só se move no eixo y</span>
<a id="__codelineno-19-111" name="__codelineno-19-111"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-19-112" name="__codelineno-19-112"></a>
<a id="__codelineno-19-113" name="__codelineno-19-113"></a>        <span class="c1"># Se o tiro passar do inicio da tela, morre.</span>
<a id="__codelineno-19-114" name="__codelineno-19-114"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-19-115" name="__codelineno-19-115"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-19-116" name="__codelineno-19-116"></a>
<a id="__codelineno-19-117" name="__codelineno-19-117"></a><span class="n">game</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-19-118" name="__codelineno-19-118"></a><span class="c1"># Variável para o ajuste de velocidade</span>
<a id="__codelineno-19-119" name="__codelineno-19-119"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<a id="__codelineno-19-120" name="__codelineno-19-120"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">30</span>
<a id="__codelineno-19-121" name="__codelineno-19-121"></a>
<a id="__codelineno-19-122" name="__codelineno-19-122"></a><span class="c1"># Criando um grupo de meteoros</span>
<a id="__codelineno-19-123" name="__codelineno-19-123"></a><span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-19-124" name="__codelineno-19-124"></a><span class="n">all_meteors</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-19-125" name="__codelineno-19-125"></a><span class="n">all_bullets</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-19-126" name="__codelineno-19-126"></a><span class="c1"># Criando o jogador</span>
<a id="__codelineno-19-127" name="__codelineno-19-127"></a><span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">ship_img</span><span class="p">,</span> <span class="n">all_sprites</span><span class="p">,</span> <span class="n">all_bullets</span><span class="p">,</span> <span class="n">bullet_img</span><span class="p">,</span> <span class="n">pew_sound</span><span class="p">)</span>
<a id="__codelineno-19-128" name="__codelineno-19-128"></a><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-19-129" name="__codelineno-19-129"></a><span class="c1"># Criando os meteoros</span>
<a id="__codelineno-19-130" name="__codelineno-19-130"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a id="__codelineno-19-131" name="__codelineno-19-131"></a>    <span class="n">meteor</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">)</span>
<a id="__codelineno-19-132" name="__codelineno-19-132"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-19-133" name="__codelineno-19-133"></a>    <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-19-134" name="__codelineno-19-134"></a>
<a id="__codelineno-19-135" name="__codelineno-19-135"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-19-136" name="__codelineno-19-136"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">loops</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-19-137" name="__codelineno-19-137"></a><span class="k">while</span> <span class="n">game</span><span class="p">:</span>
<a id="__codelineno-19-138" name="__codelineno-19-138"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
<a id="__codelineno-19-139" name="__codelineno-19-139"></a>
<a id="__codelineno-19-140" name="__codelineno-19-140"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-19-141" name="__codelineno-19-141"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-19-142" name="__codelineno-19-142"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-19-143" name="__codelineno-19-143"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-19-144" name="__codelineno-19-144"></a>            <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-19-145" name="__codelineno-19-145"></a>        <span class="c1"># Verifica se apertou alguma tecla.</span>
<a id="__codelineno-19-146" name="__codelineno-19-146"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>
<a id="__codelineno-19-147" name="__codelineno-19-147"></a>            <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-19-148" name="__codelineno-19-148"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-19-149" name="__codelineno-19-149"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-19-150" name="__codelineno-19-150"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-19-151" name="__codelineno-19-151"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-19-152" name="__codelineno-19-152"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_SPACE</span><span class="p">:</span>
<a id="__codelineno-19-153" name="__codelineno-19-153"></a>                <span class="n">player</span><span class="o">.</span><span class="n">shoot</span><span class="p">()</span>
<a id="__codelineno-19-154" name="__codelineno-19-154"></a>        <span class="c1"># Verifica se soltou alguma tecla.</span>
<a id="__codelineno-19-155" name="__codelineno-19-155"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYUP</span><span class="p">:</span>
<a id="__codelineno-19-156" name="__codelineno-19-156"></a>            <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-19-157" name="__codelineno-19-157"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-19-158" name="__codelineno-19-158"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-19-159" name="__codelineno-19-159"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-19-160" name="__codelineno-19-160"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-19-161" name="__codelineno-19-161"></a>
<a id="__codelineno-19-162" name="__codelineno-19-162"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-19-163" name="__codelineno-19-163"></a>    <span class="c1"># Atualizando a posição dos meteoros</span>
<a id="__codelineno-19-164" name="__codelineno-19-164"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-19-165" name="__codelineno-19-165"></a>
<a id="__codelineno-19-166" name="__codelineno-19-166"></a>    <span class="c1"># Verifica se houve colisão entre tiro e meteoro</span>
<a id="__codelineno-19-167" name="__codelineno-19-167"></a>    <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">groupcollide</span><span class="p">(</span><span class="n">all_meteors</span><span class="p">,</span> <span class="n">all_bullets</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-19-168" name="__codelineno-19-168"></a>    <span class="k">for</span> <span class="n">meteor</span> <span class="ow">in</span> <span class="n">hits</span><span class="p">:</span> <span class="c1"># As chaves são os elementos do primeiro grupo (meteoros) que colidiram com alguma bala</span>
<a id="__codelineno-19-169" name="__codelineno-19-169"></a>        <span class="c1"># O meteoro e destruido e precisa ser recriado</span>
<a id="__codelineno-19-170" name="__codelineno-19-170"></a>        <span class="n">m</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">meteor_img</span><span class="p">)</span>
<a id="__codelineno-19-171" name="__codelineno-19-171"></a>        <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-19-172" name="__codelineno-19-172"></a>        <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-19-173" name="__codelineno-19-173"></a>
<a id="__codelineno-19-174" name="__codelineno-19-174"></a>    <span class="c1"># Verifica se houve colisão entre nave e meteoro</span>
<a id="__codelineno-19-175" name="__codelineno-19-175"></a>    <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">spritecollide</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">all_meteors</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-19-176" name="__codelineno-19-176"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hits</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-19-177" name="__codelineno-19-177"></a>        <span class="c1"># Toca o som da colisão</span>
<a id="__codelineno-19-178" name="__codelineno-19-178"></a>        <span class="n">boom_sound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-19-179" name="__codelineno-19-179"></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Precisa esperar senão fecha</span>
<a id="__codelineno-19-180" name="__codelineno-19-180"></a>
<a id="__codelineno-19-181" name="__codelineno-19-181"></a>        <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-19-182" name="__codelineno-19-182"></a>
<a id="__codelineno-19-183" name="__codelineno-19-183"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-19-184" name="__codelineno-19-184"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-19-185" name="__codelineno-19-185"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">background</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-19-186" name="__codelineno-19-186"></a>    <span class="c1"># Desenhando meteoros</span>
<a id="__codelineno-19-187" name="__codelineno-19-187"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-19-188" name="__codelineno-19-188"></a>
<a id="__codelineno-19-189" name="__codelineno-19-189"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-19-190" name="__codelineno-19-190"></a>
<a id="__codelineno-19-191" name="__codelineno-19-191"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-19-192" name="__codelineno-19-192"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<ul>
<li>Linha 8: inicialização do módulo de áudio do pygame;</li>
<li>Linhas 30 a 34: carrega os arquivos de áudio;</li>
<li>Linhas 39 e 51: <code class="language-python highlight"><span class="n">Ship</span></code> recebe o som do tiro como argumento extra e armazena como atributo;</li>
<li>Linha 68: toca o som do tiro;</li>
<li>Linha 136: começa a tocar o som de fundo em loop;</li>
<li>Linhas 167 a 172: implementa o exercício 12. Verifica as colisões entre todos os meteoros e todas as balas. Para cada meteoro que colidiu é criado um novo meteoro para substituí-lo;</li>
<li>Linhas 178 e 179: toca o som de explosão da nave e espera 1 segundo para o som terminar de tocar antes de finalizar o jogo.</li>
</ul>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_13" id="exercise_13_0">
<p class="admonition-title">EXERCÍCIO 13</p>
<form class="exercise-form">
<p>Modifique o <code class="language-python highlight"><span class="n">jogo_v13</span><span class="o">.</span><span class="n">py</span></code> para tocar o <code class="language-python highlight"><span class="n">destroy_sound</span></code> sempre que um meteoro for destruído.</p>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="refatorando-mais-uma-vez-o-codigo">Refatorando mais uma vez o código</h2>
<p>O código já está bastante complexo. Lembrando que é sempre uma boa prática tomar um tempo para melhorar o código antes que ele se torne um caos completo, vamos refatorá-lo mais um pouco. Um dos problemas é a quantidade de argumentos que precisamos passar quando criamos um <code class="language-python highlight"><span class="n">Ship</span></code> (e tudo isso só por causa do tiro). Além disso, temos diversas variáveis para as imagens e sons que carregamos.</p>
<p>No arquivo <code class="language-python highlight"><span class="n">jogo_v14</span><span class="o">.</span><span class="n">py</span></code> adicionamos todos os assets em um novo dicionário <code class="language-python highlight"><span class="n">assets</span></code> e os grupos em um dicionário <code class="language-python highlight"><span class="n">groups</span></code>. Agora é possível diminuir a quantidade de argumentos recebidos na construção do <code class="language-python highlight"><span class="n">Ship</span></code> sem ser necessário carregar os assets todas as vezes.</p>
<details class="info">
<summary>Código <code>referencia/jogo_v14.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">  1</a></span>
<span class="normal"><a href="#__codelineno-20-2">  2</a></span>
<span class="normal"><a href="#__codelineno-20-3">  3</a></span>
<span class="normal"><a href="#__codelineno-20-4">  4</a></span>
<span class="normal"><a href="#__codelineno-20-5">  5</a></span>
<span class="normal"><a href="#__codelineno-20-6">  6</a></span>
<span class="normal"><a href="#__codelineno-20-7">  7</a></span>
<span class="normal"><a href="#__codelineno-20-8">  8</a></span>
<span class="normal"><a href="#__codelineno-20-9">  9</a></span>
<span class="normal"><a href="#__codelineno-20-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-20-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-20-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-20-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-20-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-20-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-20-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-20-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-20-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-20-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-20-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-20-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-20-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-20-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-20-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-20-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-20-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-20-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-20-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-20-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-20-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-20-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-20-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-20-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-20-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-20-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-20-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-20-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-20-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-20-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-20-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-20-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-20-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-20-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-20-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-20-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-20-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-20-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-20-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-20-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-20-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-20-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-20-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-20-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-20-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-20-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-20-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-20-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-20-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-20-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-20-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-20-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-20-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-20-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-20-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-20-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-20-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-20-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-20-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-20-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-20-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-20-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-20-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-20-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-20-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-20-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-20-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-20-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-20-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-20-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-20-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-20-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-20-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-20-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-20-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-20-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-20-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-20-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-20-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-20-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-20-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-20-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-20-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-20-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-20-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-20-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-20-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-20-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-20-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-20-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-20-100">100</a></span>
<span class="normal"><a href="#__codelineno-20-101">101</a></span>
<span class="normal"><a href="#__codelineno-20-102">102</a></span>
<span class="normal"><a href="#__codelineno-20-103">103</a></span>
<span class="normal"><a href="#__codelineno-20-104">104</a></span>
<span class="normal"><a href="#__codelineno-20-105">105</a></span>
<span class="normal"><a href="#__codelineno-20-106">106</a></span>
<span class="normal"><a href="#__codelineno-20-107">107</a></span>
<span class="normal"><a href="#__codelineno-20-108">108</a></span>
<span class="normal"><a href="#__codelineno-20-109">109</a></span>
<span class="normal"><a href="#__codelineno-20-110">110</a></span>
<span class="normal"><a href="#__codelineno-20-111">111</a></span>
<span class="normal"><a href="#__codelineno-20-112">112</a></span>
<span class="normal"><a href="#__codelineno-20-113">113</a></span>
<span class="normal"><a href="#__codelineno-20-114">114</a></span>
<span class="normal"><a href="#__codelineno-20-115">115</a></span>
<span class="normal"><a href="#__codelineno-20-116">116</a></span>
<span class="normal"><a href="#__codelineno-20-117">117</a></span>
<span class="normal"><a href="#__codelineno-20-118">118</a></span>
<span class="normal"><a href="#__codelineno-20-119">119</a></span>
<span class="normal"><a href="#__codelineno-20-120">120</a></span>
<span class="normal"><a href="#__codelineno-20-121">121</a></span>
<span class="normal"><a href="#__codelineno-20-122">122</a></span>
<span class="normal"><a href="#__codelineno-20-123">123</a></span>
<span class="normal"><a href="#__codelineno-20-124">124</a></span>
<span class="normal"><a href="#__codelineno-20-125">125</a></span>
<span class="normal"><a href="#__codelineno-20-126">126</a></span>
<span class="normal"><a href="#__codelineno-20-127">127</a></span>
<span class="normal"><a href="#__codelineno-20-128">128</a></span>
<span class="normal"><a href="#__codelineno-20-129">129</a></span>
<span class="normal"><a href="#__codelineno-20-130">130</a></span>
<span class="normal"><a href="#__codelineno-20-131">131</a></span>
<span class="normal"><a href="#__codelineno-20-132">132</a></span>
<span class="normal"><a href="#__codelineno-20-133">133</a></span>
<span class="normal"><a href="#__codelineno-20-134">134</a></span>
<span class="normal"><a href="#__codelineno-20-135">135</a></span>
<span class="normal"><a href="#__codelineno-20-136">136</a></span>
<span class="normal"><a href="#__codelineno-20-137">137</a></span>
<span class="normal"><a href="#__codelineno-20-138">138</a></span>
<span class="normal"><a href="#__codelineno-20-139">139</a></span>
<span class="normal"><a href="#__codelineno-20-140">140</a></span>
<span class="normal"><a href="#__codelineno-20-141">141</a></span>
<span class="normal"><a href="#__codelineno-20-142">142</a></span>
<span class="normal"><a href="#__codelineno-20-143">143</a></span>
<span class="normal"><a href="#__codelineno-20-144">144</a></span>
<span class="normal"><a href="#__codelineno-20-145">145</a></span>
<span class="normal"><a href="#__codelineno-20-146">146</a></span>
<span class="normal"><a href="#__codelineno-20-147">147</a></span>
<span class="normal"><a href="#__codelineno-20-148">148</a></span>
<span class="normal"><a href="#__codelineno-20-149">149</a></span>
<span class="normal"><a href="#__codelineno-20-150">150</a></span>
<span class="normal"><a href="#__codelineno-20-151">151</a></span>
<span class="normal"><a href="#__codelineno-20-152">152</a></span>
<span class="normal"><a href="#__codelineno-20-153">153</a></span>
<span class="normal"><a href="#__codelineno-20-154">154</a></span>
<span class="normal"><a href="#__codelineno-20-155">155</a></span>
<span class="normal"><a href="#__codelineno-20-156">156</a></span>
<span class="normal"><a href="#__codelineno-20-157">157</a></span>
<span class="normal"><a href="#__codelineno-20-158">158</a></span>
<span class="normal"><a href="#__codelineno-20-159">159</a></span>
<span class="normal"><a href="#__codelineno-20-160">160</a></span>
<span class="normal"><a href="#__codelineno-20-161">161</a></span>
<span class="normal"><a href="#__codelineno-20-162">162</a></span>
<span class="normal"><a href="#__codelineno-20-163">163</a></span>
<span class="normal"><a href="#__codelineno-20-164">164</a></span>
<span class="normal"><a href="#__codelineno-20-165">165</a></span>
<span class="normal"><a href="#__codelineno-20-166">166</a></span>
<span class="normal"><a href="#__codelineno-20-167">167</a></span>
<span class="normal"><a href="#__codelineno-20-168">168</a></span>
<span class="normal"><a href="#__codelineno-20-169">169</a></span>
<span class="normal"><a href="#__codelineno-20-170">170</a></span>
<span class="normal"><a href="#__codelineno-20-171">171</a></span>
<span class="normal"><a href="#__codelineno-20-172">172</a></span>
<span class="normal"><a href="#__codelineno-20-173">173</a></span>
<span class="normal"><a href="#__codelineno-20-174">174</a></span>
<span class="normal"><a href="#__codelineno-20-175">175</a></span>
<span class="normal"><a href="#__codelineno-20-176">176</a></span>
<span class="normal"><a href="#__codelineno-20-177">177</a></span>
<span class="normal"><a href="#__codelineno-20-178">178</a></span>
<span class="normal"><a href="#__codelineno-20-179">179</a></span>
<span class="normal"><a href="#__codelineno-20-180">180</a></span>
<span class="normal"><a href="#__codelineno-20-181">181</a></span>
<span class="normal"><a href="#__codelineno-20-182">182</a></span>
<span class="normal"><a href="#__codelineno-20-183">183</a></span>
<span class="normal"><a href="#__codelineno-20-184">184</a></span>
<span class="normal"><a href="#__codelineno-20-185">185</a></span>
<span class="normal"><a href="#__codelineno-20-186">186</a></span>
<span class="normal"><a href="#__codelineno-20-187">187</a></span>
<span class="normal"><a href="#__codelineno-20-188">188</a></span>
<span class="normal"><a href="#__codelineno-20-189">189</a></span>
<span class="normal"><a href="#__codelineno-20-190">190</a></span>
<span class="normal"><a href="#__codelineno-20-191">191</a></span>
<span class="normal"><a href="#__codelineno-20-192">192</a></span>
<span class="normal"><a href="#__codelineno-20-193">193</a></span>
<span class="normal"><a href="#__codelineno-20-194">194</a></span>
<span class="normal"><a href="#__codelineno-20-195">195</a></span>
<span class="normal"><a href="#__codelineno-20-196">196</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="kn">import</span> <span class="nn">time</span>
<a id="__codelineno-20-6" name="__codelineno-20-6"></a>
<a id="__codelineno-20-7" name="__codelineno-20-7"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-20-8" name="__codelineno-20-8"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-20-9" name="__codelineno-20-9"></a>
<a id="__codelineno-20-10" name="__codelineno-20-10"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-20-11" name="__codelineno-20-11"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">480</span>
<a id="__codelineno-20-12" name="__codelineno-20-12"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-20-13" name="__codelineno-20-13"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-20-14" name="__codelineno-20-14"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-20-15" name="__codelineno-20-15"></a>
<a id="__codelineno-20-16" name="__codelineno-20-16"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-20-17" name="__codelineno-20-17"></a><span class="n">METEOR_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-20-18" name="__codelineno-20-18"></a><span class="n">METEOR_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-20-19" name="__codelineno-20-19"></a><span class="n">SHIP_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-20-20" name="__codelineno-20-20"></a><span class="n">SHIP_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-20-21" name="__codelineno-20-21"></a><span class="n">assets</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-20-22" name="__codelineno-20-22"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/starfield.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-20-23" name="__codelineno-20-23"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/meteorBrown_med1.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-20-24" name="__codelineno-20-24"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">],</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-20-25" name="__codelineno-20-25"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/playerShip1_orange.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-20-26" name="__codelineno-20-26"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">],</span> <span class="p">(</span><span class="n">SHIP_WIDTH</span><span class="p">,</span> <span class="n">SHIP_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-20-27" name="__codelineno-20-27"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;bullet_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/laserRed16.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-20-28" name="__codelineno-20-28"></a>
<a id="__codelineno-20-29" name="__codelineno-20-29"></a><span class="c1"># Carrega os sons do jogo</span>
<a id="__codelineno-20-30" name="__codelineno-20-30"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/snd/tgfcoder-FrozenJam-SeamlessLoop.ogg&#39;</span><span class="p">)</span>
<a id="__codelineno-20-31" name="__codelineno-20-31"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">set_volume</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
<a id="__codelineno-20-32" name="__codelineno-20-32"></a><span class="n">boom_sound</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/expl3.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-20-33" name="__codelineno-20-33"></a><span class="n">destroy_sound</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/expl6.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-20-34" name="__codelineno-20-34"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;pew_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/pew.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-20-35" name="__codelineno-20-35"></a>
<a id="__codelineno-20-36" name="__codelineno-20-36"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-20-37" name="__codelineno-20-37"></a><span class="c1"># Definindo os novos tipos</span>
<a id="__codelineno-20-38" name="__codelineno-20-38"></a><span class="k">class</span> <span class="nc">Ship</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-20-39" name="__codelineno-20-39"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-20-40" name="__codelineno-20-40"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-20-41" name="__codelineno-20-41"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-20-42" name="__codelineno-20-42"></a>
<a id="__codelineno-20-43" name="__codelineno-20-43"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span>
<a id="__codelineno-20-44" name="__codelineno-20-44"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-20-45" name="__codelineno-20-45"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-20-46" name="__codelineno-20-46"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span>
<a id="__codelineno-20-47" name="__codelineno-20-47"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-20-48" name="__codelineno-20-48"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="o">=</span> <span class="n">groups</span>
<a id="__codelineno-20-49" name="__codelineno-20-49"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assets</span> <span class="o">=</span> <span class="n">assets</span>
<a id="__codelineno-20-50" name="__codelineno-20-50"></a>
<a id="__codelineno-20-51" name="__codelineno-20-51"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-20-52" name="__codelineno-20-52"></a>        <span class="c1"># Atualização da posição da nave</span>
<a id="__codelineno-20-53" name="__codelineno-20-53"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-20-54" name="__codelineno-20-54"></a>
<a id="__codelineno-20-55" name="__codelineno-20-55"></a>        <span class="c1"># Mantem dentro da tela</span>
<a id="__codelineno-20-56" name="__codelineno-20-56"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-20-57" name="__codelineno-20-57"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">WIDTH</span>
<a id="__codelineno-20-58" name="__codelineno-20-58"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-20-59" name="__codelineno-20-59"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-20-60" name="__codelineno-20-60"></a>
<a id="__codelineno-20-61" name="__codelineno-20-61"></a>    <span class="k">def</span> <span class="nf">shoot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-20-62" name="__codelineno-20-62"></a>        <span class="c1"># A nova bala vai ser criada logo acima e no centro horizontal da nave</span>
<a id="__codelineno-20-63" name="__codelineno-20-63"></a>        <span class="n">new_bullet</span> <span class="o">=</span> <span class="n">Bullet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span><span class="p">)</span>
<a id="__codelineno-20-64" name="__codelineno-20-64"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_sprites&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-20-65" name="__codelineno-20-65"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_bullets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-20-66" name="__codelineno-20-66"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;pew_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-20-67" name="__codelineno-20-67"></a>
<a id="__codelineno-20-68" name="__codelineno-20-68"></a><span class="k">class</span> <span class="nc">Meteor</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-20-69" name="__codelineno-20-69"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-20-70" name="__codelineno-20-70"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-20-71" name="__codelineno-20-71"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-20-72" name="__codelineno-20-72"></a>
<a id="__codelineno-20-73" name="__codelineno-20-73"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span>
<a id="__codelineno-20-74" name="__codelineno-20-74"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-20-75" name="__codelineno-20-75"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-20-76" name="__codelineno-20-76"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-20-77" name="__codelineno-20-77"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-20-78" name="__codelineno-20-78"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-20-79" name="__codelineno-20-79"></a>
<a id="__codelineno-20-80" name="__codelineno-20-80"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-20-81" name="__codelineno-20-81"></a>        <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-20-82" name="__codelineno-20-82"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-20-83" name="__codelineno-20-83"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-20-84" name="__codelineno-20-84"></a>        <span class="c1"># Se o meteoro passar do final da tela, volta para cima e sorteia</span>
<a id="__codelineno-20-85" name="__codelineno-20-85"></a>        <span class="c1"># novas posições e velocidades</span>
<a id="__codelineno-20-86" name="__codelineno-20-86"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-20-87" name="__codelineno-20-87"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-20-88" name="__codelineno-20-88"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-20-89" name="__codelineno-20-89"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-20-90" name="__codelineno-20-90"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-20-91" name="__codelineno-20-91"></a>
<a id="__codelineno-20-92" name="__codelineno-20-92"></a><span class="c1"># Classe Bullet que representa os tiros</span>
<a id="__codelineno-20-93" name="__codelineno-20-93"></a><span class="k">class</span> <span class="nc">Bullet</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-20-94" name="__codelineno-20-94"></a>    <span class="c1"># Construtor da classe.</span>
<a id="__codelineno-20-95" name="__codelineno-20-95"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assets</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">centerx</span><span class="p">):</span>
<a id="__codelineno-20-96" name="__codelineno-20-96"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-20-97" name="__codelineno-20-97"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-20-98" name="__codelineno-20-98"></a>
<a id="__codelineno-20-99" name="__codelineno-20-99"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;bullet_img&#39;</span><span class="p">]</span>
<a id="__codelineno-20-100" name="__codelineno-20-100"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-20-101" name="__codelineno-20-101"></a>
<a id="__codelineno-20-102" name="__codelineno-20-102"></a>        <span class="c1"># Coloca no lugar inicial definido em x, y do constutor</span>
<a id="__codelineno-20-103" name="__codelineno-20-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">centerx</span>
<a id="__codelineno-20-104" name="__codelineno-20-104"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">bottom</span>
<a id="__codelineno-20-105" name="__codelineno-20-105"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>  <span class="c1"># Velocidade fixa para cima</span>
<a id="__codelineno-20-106" name="__codelineno-20-106"></a>
<a id="__codelineno-20-107" name="__codelineno-20-107"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-20-108" name="__codelineno-20-108"></a>        <span class="c1"># A bala só se move no eixo y</span>
<a id="__codelineno-20-109" name="__codelineno-20-109"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-20-110" name="__codelineno-20-110"></a>
<a id="__codelineno-20-111" name="__codelineno-20-111"></a>        <span class="c1"># Se o tiro passar do inicio da tela, morre.</span>
<a id="__codelineno-20-112" name="__codelineno-20-112"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-20-113" name="__codelineno-20-113"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-20-114" name="__codelineno-20-114"></a>
<a id="__codelineno-20-115" name="__codelineno-20-115"></a><span class="n">game</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-20-116" name="__codelineno-20-116"></a><span class="c1"># Variável para o ajuste de velocidade</span>
<a id="__codelineno-20-117" name="__codelineno-20-117"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<a id="__codelineno-20-118" name="__codelineno-20-118"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">30</span>
<a id="__codelineno-20-119" name="__codelineno-20-119"></a>
<a id="__codelineno-20-120" name="__codelineno-20-120"></a><span class="c1"># Criando um grupo de meteoros</span>
<a id="__codelineno-20-121" name="__codelineno-20-121"></a><span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-20-122" name="__codelineno-20-122"></a><span class="n">all_meteors</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-20-123" name="__codelineno-20-123"></a><span class="n">all_bullets</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-20-124" name="__codelineno-20-124"></a><span class="n">groups</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-20-125" name="__codelineno-20-125"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_sprites&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_sprites</span>
<a id="__codelineno-20-126" name="__codelineno-20-126"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_meteors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_meteors</span>
<a id="__codelineno-20-127" name="__codelineno-20-127"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_bullets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_bullets</span>
<a id="__codelineno-20-128" name="__codelineno-20-128"></a>
<a id="__codelineno-20-129" name="__codelineno-20-129"></a><span class="c1"># Criando o jogador</span>
<a id="__codelineno-20-130" name="__codelineno-20-130"></a><span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-20-131" name="__codelineno-20-131"></a><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-20-132" name="__codelineno-20-132"></a><span class="c1"># Criando os meteoros</span>
<a id="__codelineno-20-133" name="__codelineno-20-133"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a id="__codelineno-20-134" name="__codelineno-20-134"></a>    <span class="n">meteor</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-20-135" name="__codelineno-20-135"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-20-136" name="__codelineno-20-136"></a>    <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-20-137" name="__codelineno-20-137"></a>
<a id="__codelineno-20-138" name="__codelineno-20-138"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-20-139" name="__codelineno-20-139"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">loops</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-20-140" name="__codelineno-20-140"></a><span class="k">while</span> <span class="n">game</span><span class="p">:</span>
<a id="__codelineno-20-141" name="__codelineno-20-141"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
<a id="__codelineno-20-142" name="__codelineno-20-142"></a>
<a id="__codelineno-20-143" name="__codelineno-20-143"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-20-144" name="__codelineno-20-144"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-20-145" name="__codelineno-20-145"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-20-146" name="__codelineno-20-146"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-20-147" name="__codelineno-20-147"></a>            <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-20-148" name="__codelineno-20-148"></a>        <span class="c1"># Verifica se apertou alguma tecla.</span>
<a id="__codelineno-20-149" name="__codelineno-20-149"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>
<a id="__codelineno-20-150" name="__codelineno-20-150"></a>            <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-20-151" name="__codelineno-20-151"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-20-152" name="__codelineno-20-152"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-20-153" name="__codelineno-20-153"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-20-154" name="__codelineno-20-154"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-20-155" name="__codelineno-20-155"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_SPACE</span><span class="p">:</span>
<a id="__codelineno-20-156" name="__codelineno-20-156"></a>                <span class="n">player</span><span class="o">.</span><span class="n">shoot</span><span class="p">()</span>
<a id="__codelineno-20-157" name="__codelineno-20-157"></a>        <span class="c1"># Verifica se soltou alguma tecla.</span>
<a id="__codelineno-20-158" name="__codelineno-20-158"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYUP</span><span class="p">:</span>
<a id="__codelineno-20-159" name="__codelineno-20-159"></a>            <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-20-160" name="__codelineno-20-160"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-20-161" name="__codelineno-20-161"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-20-162" name="__codelineno-20-162"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-20-163" name="__codelineno-20-163"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-20-164" name="__codelineno-20-164"></a>
<a id="__codelineno-20-165" name="__codelineno-20-165"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-20-166" name="__codelineno-20-166"></a>    <span class="c1"># Atualizando a posição dos meteoros</span>
<a id="__codelineno-20-167" name="__codelineno-20-167"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-20-168" name="__codelineno-20-168"></a>
<a id="__codelineno-20-169" name="__codelineno-20-169"></a>    <span class="c1"># Verifica se houve colisão entre tiro e meteoro</span>
<a id="__codelineno-20-170" name="__codelineno-20-170"></a>    <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">groupcollide</span><span class="p">(</span><span class="n">all_meteors</span><span class="p">,</span> <span class="n">all_bullets</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-20-171" name="__codelineno-20-171"></a>    <span class="k">for</span> <span class="n">meteor</span> <span class="ow">in</span> <span class="n">hits</span><span class="p">:</span> <span class="c1"># As chaves são os elementos do primeiro grupo (meteoros) que colidiram com alguma bala</span>
<a id="__codelineno-20-172" name="__codelineno-20-172"></a>        <span class="c1"># O meteoro e destruido e precisa ser recriado</span>
<a id="__codelineno-20-173" name="__codelineno-20-173"></a>        <span class="n">destroy_sound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-20-174" name="__codelineno-20-174"></a>        <span class="n">m</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-20-175" name="__codelineno-20-175"></a>        <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-20-176" name="__codelineno-20-176"></a>        <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-20-177" name="__codelineno-20-177"></a>
<a id="__codelineno-20-178" name="__codelineno-20-178"></a>    <span class="c1"># Verifica se houve colisão entre nave e meteoro</span>
<a id="__codelineno-20-179" name="__codelineno-20-179"></a>    <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">spritecollide</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">all_meteors</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-20-180" name="__codelineno-20-180"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hits</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-20-181" name="__codelineno-20-181"></a>        <span class="c1"># Toca o som da colisão</span>
<a id="__codelineno-20-182" name="__codelineno-20-182"></a>        <span class="n">boom_sound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-20-183" name="__codelineno-20-183"></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Precisa esperar senão fecha</span>
<a id="__codelineno-20-184" name="__codelineno-20-184"></a>
<a id="__codelineno-20-185" name="__codelineno-20-185"></a>        <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-20-186" name="__codelineno-20-186"></a>
<a id="__codelineno-20-187" name="__codelineno-20-187"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-20-188" name="__codelineno-20-188"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-20-189" name="__codelineno-20-189"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-20-190" name="__codelineno-20-190"></a>    <span class="c1"># Desenhando meteoros</span>
<a id="__codelineno-20-191" name="__codelineno-20-191"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-20-192" name="__codelineno-20-192"></a>
<a id="__codelineno-20-193" name="__codelineno-20-193"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-20-194" name="__codelineno-20-194"></a>
<a id="__codelineno-20-195" name="__codelineno-20-195"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-20-196" name="__codelineno-20-196"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_14" id="exercise_14_0">
<p class="admonition-title">EXERCÍCIO 14</p>
<form class="exercise-form">
<p>Os sons <code class="language-python highlight"><span class="n">boom_sound</span></code> e <code class="language-python highlight"><span class="n">destroy_sound</span></code> ainda não estão armazenados em <code class="language-python highlight"><span class="n">assets</span></code>. Para manter a consistência, adicione-os no dicionário e atualize o código necessário (onde esses sons são tocados).</p>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="adicionando-animacoes">Adicionando animações</h2>
<p>As imagens do nosso jogo ainda são muito estáticas. Elas se movem pela tela, mas são sempre as mesmas. Vamos adicionar uma animação de explosão. Para isso, vamos criar um novo sprite que atualiza a imagem em intervalos fixos de tempo. O <code class="language-python highlight"><span class="n">jogo_v15</span><span class="o">.</span><span class="n">py</span></code> implementa essa animação. As principais mudanças são:</p>
<details class="info">
<summary>Código <code>referencia/jogo_v15.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">  1</a></span>
<span class="normal"><a href="#__codelineno-21-2">  2</a></span>
<span class="normal"><a href="#__codelineno-21-3">  3</a></span>
<span class="normal"><a href="#__codelineno-21-4">  4</a></span>
<span class="normal"><a href="#__codelineno-21-5">  5</a></span>
<span class="normal"><a href="#__codelineno-21-6">  6</a></span>
<span class="normal"><a href="#__codelineno-21-7">  7</a></span>
<span class="normal"><a href="#__codelineno-21-8">  8</a></span>
<span class="normal"><a href="#__codelineno-21-9">  9</a></span>
<span class="normal"><a href="#__codelineno-21-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-21-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-21-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-21-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-21-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-21-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-21-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-21-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-21-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-21-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-21-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-21-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-21-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-21-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-21-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-21-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-21-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-21-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-21-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-21-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-21-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-21-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-21-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-21-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-21-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-21-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-21-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-21-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-21-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-21-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-21-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-21-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-21-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-21-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-21-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-21-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-21-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-21-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-21-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-21-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-21-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-21-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-21-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-21-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-21-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-21-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-21-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-21-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-21-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-21-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-21-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-21-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-21-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-21-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-21-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-21-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-21-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-21-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-21-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-21-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-21-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-21-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-21-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-21-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-21-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-21-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-21-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-21-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-21-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-21-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-21-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-21-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-21-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-21-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-21-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-21-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-21-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-21-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-21-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-21-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-21-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-21-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-21-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-21-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-21-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-21-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-21-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-21-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-21-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-21-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-21-100">100</a></span>
<span class="normal"><a href="#__codelineno-21-101">101</a></span>
<span class="normal"><a href="#__codelineno-21-102">102</a></span>
<span class="normal"><a href="#__codelineno-21-103">103</a></span>
<span class="normal"><a href="#__codelineno-21-104">104</a></span>
<span class="normal"><a href="#__codelineno-21-105">105</a></span>
<span class="normal"><a href="#__codelineno-21-106">106</a></span>
<span class="normal"><a href="#__codelineno-21-107">107</a></span>
<span class="normal"><a href="#__codelineno-21-108">108</a></span>
<span class="normal"><a href="#__codelineno-21-109">109</a></span>
<span class="normal"><a href="#__codelineno-21-110">110</a></span>
<span class="normal"><a href="#__codelineno-21-111">111</a></span>
<span class="normal"><a href="#__codelineno-21-112">112</a></span>
<span class="normal"><a href="#__codelineno-21-113">113</a></span>
<span class="normal"><a href="#__codelineno-21-114">114</a></span>
<span class="normal"><a href="#__codelineno-21-115">115</a></span>
<span class="normal"><a href="#__codelineno-21-116">116</a></span>
<span class="normal"><a href="#__codelineno-21-117">117</a></span>
<span class="normal"><a href="#__codelineno-21-118">118</a></span>
<span class="normal"><a href="#__codelineno-21-119">119</a></span>
<span class="normal"><a href="#__codelineno-21-120">120</a></span>
<span class="normal"><a href="#__codelineno-21-121">121</a></span>
<span class="normal"><a href="#__codelineno-21-122">122</a></span>
<span class="normal"><a href="#__codelineno-21-123">123</a></span>
<span class="normal"><a href="#__codelineno-21-124">124</a></span>
<span class="normal"><a href="#__codelineno-21-125">125</a></span>
<span class="normal"><a href="#__codelineno-21-126">126</a></span>
<span class="normal"><a href="#__codelineno-21-127">127</a></span>
<span class="normal"><a href="#__codelineno-21-128">128</a></span>
<span class="normal"><a href="#__codelineno-21-129">129</a></span>
<span class="normal"><a href="#__codelineno-21-130">130</a></span>
<span class="normal"><a href="#__codelineno-21-131">131</a></span>
<span class="normal"><a href="#__codelineno-21-132">132</a></span>
<span class="normal"><a href="#__codelineno-21-133">133</a></span>
<span class="normal"><a href="#__codelineno-21-134">134</a></span>
<span class="normal"><a href="#__codelineno-21-135">135</a></span>
<span class="normal"><a href="#__codelineno-21-136">136</a></span>
<span class="normal"><a href="#__codelineno-21-137">137</a></span>
<span class="normal"><a href="#__codelineno-21-138">138</a></span>
<span class="normal"><a href="#__codelineno-21-139">139</a></span>
<span class="normal"><a href="#__codelineno-21-140">140</a></span>
<span class="normal"><a href="#__codelineno-21-141">141</a></span>
<span class="normal"><a href="#__codelineno-21-142">142</a></span>
<span class="normal"><a href="#__codelineno-21-143">143</a></span>
<span class="normal"><a href="#__codelineno-21-144">144</a></span>
<span class="normal"><a href="#__codelineno-21-145">145</a></span>
<span class="normal"><a href="#__codelineno-21-146">146</a></span>
<span class="normal"><a href="#__codelineno-21-147">147</a></span>
<span class="normal"><a href="#__codelineno-21-148">148</a></span>
<span class="normal"><a href="#__codelineno-21-149">149</a></span>
<span class="normal"><a href="#__codelineno-21-150">150</a></span>
<span class="normal"><a href="#__codelineno-21-151">151</a></span>
<span class="normal"><a href="#__codelineno-21-152">152</a></span>
<span class="normal"><a href="#__codelineno-21-153">153</a></span>
<span class="normal"><a href="#__codelineno-21-154">154</a></span>
<span class="normal"><a href="#__codelineno-21-155">155</a></span>
<span class="normal"><a href="#__codelineno-21-156">156</a></span>
<span class="normal"><a href="#__codelineno-21-157">157</a></span>
<span class="normal"><a href="#__codelineno-21-158">158</a></span>
<span class="normal"><a href="#__codelineno-21-159">159</a></span>
<span class="normal"><a href="#__codelineno-21-160">160</a></span>
<span class="normal"><a href="#__codelineno-21-161">161</a></span>
<span class="normal"><a href="#__codelineno-21-162">162</a></span>
<span class="normal"><a href="#__codelineno-21-163">163</a></span>
<span class="normal"><a href="#__codelineno-21-164">164</a></span>
<span class="normal"><a href="#__codelineno-21-165">165</a></span>
<span class="normal"><a href="#__codelineno-21-166">166</a></span>
<span class="normal"><a href="#__codelineno-21-167">167</a></span>
<span class="normal"><a href="#__codelineno-21-168">168</a></span>
<span class="normal"><a href="#__codelineno-21-169">169</a></span>
<span class="normal"><a href="#__codelineno-21-170">170</a></span>
<span class="normal"><a href="#__codelineno-21-171">171</a></span>
<span class="normal"><a href="#__codelineno-21-172">172</a></span>
<span class="normal"><a href="#__codelineno-21-173">173</a></span>
<span class="normal"><a href="#__codelineno-21-174">174</a></span>
<span class="normal"><a href="#__codelineno-21-175">175</a></span>
<span class="normal"><a href="#__codelineno-21-176">176</a></span>
<span class="normal"><a href="#__codelineno-21-177">177</a></span>
<span class="normal"><a href="#__codelineno-21-178">178</a></span>
<span class="normal"><a href="#__codelineno-21-179">179</a></span>
<span class="normal"><a href="#__codelineno-21-180">180</a></span>
<span class="normal"><a href="#__codelineno-21-181">181</a></span>
<span class="normal"><a href="#__codelineno-21-182">182</a></span>
<span class="normal"><a href="#__codelineno-21-183">183</a></span>
<span class="normal"><a href="#__codelineno-21-184">184</a></span>
<span class="normal"><a href="#__codelineno-21-185">185</a></span>
<span class="normal"><a href="#__codelineno-21-186">186</a></span>
<span class="normal"><a href="#__codelineno-21-187">187</a></span>
<span class="normal"><a href="#__codelineno-21-188">188</a></span>
<span class="normal"><a href="#__codelineno-21-189">189</a></span>
<span class="normal"><a href="#__codelineno-21-190">190</a></span>
<span class="normal"><a href="#__codelineno-21-191">191</a></span>
<span class="normal"><a href="#__codelineno-21-192">192</a></span>
<span class="normal"><a href="#__codelineno-21-193">193</a></span>
<span class="normal"><a href="#__codelineno-21-194">194</a></span>
<span class="normal"><a href="#__codelineno-21-195">195</a></span>
<span class="normal"><a href="#__codelineno-21-196">196</a></span>
<span class="normal"><a href="#__codelineno-21-197">197</a></span>
<span class="normal"><a href="#__codelineno-21-198">198</a></span>
<span class="normal"><a href="#__codelineno-21-199">199</a></span>
<span class="normal"><a href="#__codelineno-21-200">200</a></span>
<span class="normal"><a href="#__codelineno-21-201">201</a></span>
<span class="normal"><a href="#__codelineno-21-202">202</a></span>
<span class="normal"><a href="#__codelineno-21-203">203</a></span>
<span class="normal"><a href="#__codelineno-21-204">204</a></span>
<span class="normal"><a href="#__codelineno-21-205">205</a></span>
<span class="normal"><a href="#__codelineno-21-206">206</a></span>
<span class="normal"><a href="#__codelineno-21-207">207</a></span>
<span class="normal"><a href="#__codelineno-21-208">208</a></span>
<span class="normal"><a href="#__codelineno-21-209">209</a></span>
<span class="normal"><a href="#__codelineno-21-210">210</a></span>
<span class="normal"><a href="#__codelineno-21-211">211</a></span>
<span class="normal"><a href="#__codelineno-21-212">212</a></span>
<span class="normal"><a href="#__codelineno-21-213">213</a></span>
<span class="normal"><a href="#__codelineno-21-214">214</a></span>
<span class="normal"><a href="#__codelineno-21-215">215</a></span>
<span class="normal"><a href="#__codelineno-21-216">216</a></span>
<span class="normal"><a href="#__codelineno-21-217">217</a></span>
<span class="normal"><a href="#__codelineno-21-218">218</a></span>
<span class="normal"><a href="#__codelineno-21-219">219</a></span>
<span class="normal"><a href="#__codelineno-21-220">220</a></span>
<span class="normal"><a href="#__codelineno-21-221">221</a></span>
<span class="normal"><a href="#__codelineno-21-222">222</a></span>
<span class="normal"><a href="#__codelineno-21-223">223</a></span>
<span class="normal"><a href="#__codelineno-21-224">224</a></span>
<span class="normal"><a href="#__codelineno-21-225">225</a></span>
<span class="normal"><a href="#__codelineno-21-226">226</a></span>
<span class="normal"><a href="#__codelineno-21-227">227</a></span>
<span class="normal"><a href="#__codelineno-21-228">228</a></span>
<span class="normal"><a href="#__codelineno-21-229">229</a></span>
<span class="normal"><a href="#__codelineno-21-230">230</a></span>
<span class="normal"><a href="#__codelineno-21-231">231</a></span>
<span class="normal"><a href="#__codelineno-21-232">232</a></span>
<span class="normal"><a href="#__codelineno-21-233">233</a></span>
<span class="normal"><a href="#__codelineno-21-234">234</a></span>
<span class="normal"><a href="#__codelineno-21-235">235</a></span>
<span class="normal"><a href="#__codelineno-21-236">236</a></span>
<span class="normal"><a href="#__codelineno-21-237">237</a></span>
<span class="normal"><a href="#__codelineno-21-238">238</a></span>
<span class="normal"><a href="#__codelineno-21-239">239</a></span>
<span class="normal"><a href="#__codelineno-21-240">240</a></span>
<span class="normal"><a href="#__codelineno-21-241">241</a></span>
<span class="normal"><a href="#__codelineno-21-242">242</a></span>
<span class="normal"><a href="#__codelineno-21-243">243</a></span>
<span class="normal"><a href="#__codelineno-21-244">244</a></span>
<span class="normal"><a href="#__codelineno-21-245">245</a></span>
<span class="normal"><a href="#__codelineno-21-246">246</a></span>
<span class="normal"><a href="#__codelineno-21-247">247</a></span>
<span class="normal"><a href="#__codelineno-21-248">248</a></span>
<span class="normal"><a href="#__codelineno-21-249">249</a></span>
<span class="normal"><a href="#__codelineno-21-250">250</a></span>
<span class="normal"><a href="#__codelineno-21-251">251</a></span>
<span class="normal"><a href="#__codelineno-21-252">252</a></span>
<span class="normal"><a href="#__codelineno-21-253">253</a></span>
<span class="normal"><a href="#__codelineno-21-254">254</a></span>
<span class="normal"><a href="#__codelineno-21-255">255</a></span>
<span class="normal"><a href="#__codelineno-21-256">256</a></span>
<span class="normal"><a href="#__codelineno-21-257">257</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-21-4" name="__codelineno-21-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-21-5" name="__codelineno-21-5"></a><span class="kn">import</span> <span class="nn">time</span>
<a id="__codelineno-21-6" name="__codelineno-21-6"></a>
<a id="__codelineno-21-7" name="__codelineno-21-7"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-21-8" name="__codelineno-21-8"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-21-9" name="__codelineno-21-9"></a>
<a id="__codelineno-21-10" name="__codelineno-21-10"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-21-11" name="__codelineno-21-11"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">480</span>
<a id="__codelineno-21-12" name="__codelineno-21-12"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-21-13" name="__codelineno-21-13"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-21-14" name="__codelineno-21-14"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-21-15" name="__codelineno-21-15"></a>
<a id="__codelineno-21-16" name="__codelineno-21-16"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-21-17" name="__codelineno-21-17"></a><span class="n">METEOR_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-21-18" name="__codelineno-21-18"></a><span class="n">METEOR_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-21-19" name="__codelineno-21-19"></a><span class="n">SHIP_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-21-20" name="__codelineno-21-20"></a><span class="n">SHIP_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-21-21" name="__codelineno-21-21"></a><span class="n">assets</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-21-22" name="__codelineno-21-22"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/starfield.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-21-23" name="__codelineno-21-23"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/meteorBrown_med1.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-21-24" name="__codelineno-21-24"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">],</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-21-25" name="__codelineno-21-25"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/playerShip1_orange.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-21-26" name="__codelineno-21-26"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">],</span> <span class="p">(</span><span class="n">SHIP_WIDTH</span><span class="p">,</span> <span class="n">SHIP_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-21-27" name="__codelineno-21-27"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;bullet_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/laserRed16.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-21-28" name="__codelineno-21-28"></a><span class="n">explosion_anim</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-21-29" name="__codelineno-21-29"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
<a id="__codelineno-21-30" name="__codelineno-21-30"></a>    <span class="c1"># Os arquivos de animação são numerados de 00 a 08</span>
<a id="__codelineno-21-31" name="__codelineno-21-31"></a>    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;assets/img/regularExplosion0</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-21-32" name="__codelineno-21-32"></a>    <span class="n">img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-21-33" name="__codelineno-21-33"></a>    <span class="n">img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
<a id="__codelineno-21-34" name="__codelineno-21-34"></a>    <span class="n">explosion_anim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<a id="__codelineno-21-35" name="__codelineno-21-35"></a><span class="n">assets</span><span class="p">[</span><span class="s2">&quot;explosion_anim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">explosion_anim</span>
<a id="__codelineno-21-36" name="__codelineno-21-36"></a>
<a id="__codelineno-21-37" name="__codelineno-21-37"></a><span class="c1"># Carrega os sons do jogo</span>
<a id="__codelineno-21-38" name="__codelineno-21-38"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/snd/tgfcoder-FrozenJam-SeamlessLoop.ogg&#39;</span><span class="p">)</span>
<a id="__codelineno-21-39" name="__codelineno-21-39"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">set_volume</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
<a id="__codelineno-21-40" name="__codelineno-21-40"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;boom_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/expl3.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-21-41" name="__codelineno-21-41"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;destroy_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/expl6.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-21-42" name="__codelineno-21-42"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;pew_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/pew.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-21-43" name="__codelineno-21-43"></a>
<a id="__codelineno-21-44" name="__codelineno-21-44"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-21-45" name="__codelineno-21-45"></a><span class="c1"># Definindo os novos tipos</span>
<a id="__codelineno-21-46" name="__codelineno-21-46"></a><span class="k">class</span> <span class="nc">Ship</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-21-47" name="__codelineno-21-47"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-21-48" name="__codelineno-21-48"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-21-49" name="__codelineno-21-49"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-21-50" name="__codelineno-21-50"></a>
<a id="__codelineno-21-51" name="__codelineno-21-51"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span>
<a id="__codelineno-21-52" name="__codelineno-21-52"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-21-53" name="__codelineno-21-53"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-21-54" name="__codelineno-21-54"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span>
<a id="__codelineno-21-55" name="__codelineno-21-55"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-21-56" name="__codelineno-21-56"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="o">=</span> <span class="n">groups</span>
<a id="__codelineno-21-57" name="__codelineno-21-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assets</span> <span class="o">=</span> <span class="n">assets</span>
<a id="__codelineno-21-58" name="__codelineno-21-58"></a>
<a id="__codelineno-21-59" name="__codelineno-21-59"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-21-60" name="__codelineno-21-60"></a>        <span class="c1"># Atualização da posição da nave</span>
<a id="__codelineno-21-61" name="__codelineno-21-61"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-21-62" name="__codelineno-21-62"></a>
<a id="__codelineno-21-63" name="__codelineno-21-63"></a>        <span class="c1"># Mantem dentro da tela</span>
<a id="__codelineno-21-64" name="__codelineno-21-64"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-21-65" name="__codelineno-21-65"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">WIDTH</span>
<a id="__codelineno-21-66" name="__codelineno-21-66"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-21-67" name="__codelineno-21-67"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-21-68" name="__codelineno-21-68"></a>
<a id="__codelineno-21-69" name="__codelineno-21-69"></a>    <span class="k">def</span> <span class="nf">shoot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-21-70" name="__codelineno-21-70"></a>        <span class="c1"># A nova bala vai ser criada logo acima e no centro horizontal da nave</span>
<a id="__codelineno-21-71" name="__codelineno-21-71"></a>        <span class="n">new_bullet</span> <span class="o">=</span> <span class="n">Bullet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span><span class="p">)</span>
<a id="__codelineno-21-72" name="__codelineno-21-72"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_sprites&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-21-73" name="__codelineno-21-73"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_bullets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-21-74" name="__codelineno-21-74"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;pew_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-21-75" name="__codelineno-21-75"></a>
<a id="__codelineno-21-76" name="__codelineno-21-76"></a><span class="k">class</span> <span class="nc">Meteor</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-21-77" name="__codelineno-21-77"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-21-78" name="__codelineno-21-78"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-21-79" name="__codelineno-21-79"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-21-80" name="__codelineno-21-80"></a>
<a id="__codelineno-21-81" name="__codelineno-21-81"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span>
<a id="__codelineno-21-82" name="__codelineno-21-82"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-21-83" name="__codelineno-21-83"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-21-84" name="__codelineno-21-84"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-21-85" name="__codelineno-21-85"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-21-86" name="__codelineno-21-86"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-21-87" name="__codelineno-21-87"></a>
<a id="__codelineno-21-88" name="__codelineno-21-88"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-21-89" name="__codelineno-21-89"></a>        <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-21-90" name="__codelineno-21-90"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-21-91" name="__codelineno-21-91"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-21-92" name="__codelineno-21-92"></a>        <span class="c1"># Se o meteoro passar do final da tela, volta para cima e sorteia</span>
<a id="__codelineno-21-93" name="__codelineno-21-93"></a>        <span class="c1"># novas posições e velocidades</span>
<a id="__codelineno-21-94" name="__codelineno-21-94"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-21-95" name="__codelineno-21-95"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-21-96" name="__codelineno-21-96"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-21-97" name="__codelineno-21-97"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-21-98" name="__codelineno-21-98"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-21-99" name="__codelineno-21-99"></a>
<a id="__codelineno-21-100" name="__codelineno-21-100"></a><span class="c1"># Classe Bullet que representa os tiros</span>
<a id="__codelineno-21-101" name="__codelineno-21-101"></a><span class="k">class</span> <span class="nc">Bullet</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-21-102" name="__codelineno-21-102"></a>    <span class="c1"># Construtor da classe.</span>
<a id="__codelineno-21-103" name="__codelineno-21-103"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assets</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">centerx</span><span class="p">):</span>
<a id="__codelineno-21-104" name="__codelineno-21-104"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-21-105" name="__codelineno-21-105"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-21-106" name="__codelineno-21-106"></a>
<a id="__codelineno-21-107" name="__codelineno-21-107"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;bullet_img&#39;</span><span class="p">]</span>
<a id="__codelineno-21-108" name="__codelineno-21-108"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-21-109" name="__codelineno-21-109"></a>
<a id="__codelineno-21-110" name="__codelineno-21-110"></a>        <span class="c1"># Coloca no lugar inicial definido em x, y do constutor</span>
<a id="__codelineno-21-111" name="__codelineno-21-111"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">centerx</span>
<a id="__codelineno-21-112" name="__codelineno-21-112"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">bottom</span>
<a id="__codelineno-21-113" name="__codelineno-21-113"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>  <span class="c1"># Velocidade fixa para cima</span>
<a id="__codelineno-21-114" name="__codelineno-21-114"></a>
<a id="__codelineno-21-115" name="__codelineno-21-115"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-21-116" name="__codelineno-21-116"></a>        <span class="c1"># A bala só se move no eixo y</span>
<a id="__codelineno-21-117" name="__codelineno-21-117"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-21-118" name="__codelineno-21-118"></a>
<a id="__codelineno-21-119" name="__codelineno-21-119"></a>        <span class="c1"># Se o tiro passar do inicio da tela, morre.</span>
<a id="__codelineno-21-120" name="__codelineno-21-120"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-21-121" name="__codelineno-21-121"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-21-122" name="__codelineno-21-122"></a>
<a id="__codelineno-21-123" name="__codelineno-21-123"></a><span class="c1"># Classe que representa uma explosão de meteoro</span>
<a id="__codelineno-21-124" name="__codelineno-21-124"></a><span class="k">class</span> <span class="nc">Explosion</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-21-125" name="__codelineno-21-125"></a>    <span class="c1"># Construtor da classe.</span>
<a id="__codelineno-21-126" name="__codelineno-21-126"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-21-127" name="__codelineno-21-127"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-21-128" name="__codelineno-21-128"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-21-129" name="__codelineno-21-129"></a>
<a id="__codelineno-21-130" name="__codelineno-21-130"></a>        <span class="c1"># Armazena a animação de explosão</span>
<a id="__codelineno-21-131" name="__codelineno-21-131"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;explosion_anim&#39;</span><span class="p">]</span>
<a id="__codelineno-21-132" name="__codelineno-21-132"></a>
<a id="__codelineno-21-133" name="__codelineno-21-133"></a>        <span class="c1"># Inicia o processo de animação colocando a primeira imagem na tela.</span>
<a id="__codelineno-21-134" name="__codelineno-21-134"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Armazena o índice atual na animação</span>
<a id="__codelineno-21-135" name="__codelineno-21-135"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span>  <span class="c1"># Pega a primeira imagem</span>
<a id="__codelineno-21-136" name="__codelineno-21-136"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-21-137" name="__codelineno-21-137"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>  <span class="c1"># Posiciona o centro da imagem</span>
<a id="__codelineno-21-138" name="__codelineno-21-138"></a>
<a id="__codelineno-21-139" name="__codelineno-21-139"></a>        <span class="c1"># Guarda o tick da primeira imagem, ou seja, o momento em que a imagem foi mostrada</span>
<a id="__codelineno-21-140" name="__codelineno-21-140"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-21-141" name="__codelineno-21-141"></a>
<a id="__codelineno-21-142" name="__codelineno-21-142"></a>        <span class="c1"># Controle de ticks de animação: troca de imagem a cada self.frame_ticks milissegundos.</span>
<a id="__codelineno-21-143" name="__codelineno-21-143"></a>        <span class="c1"># Quando pygame.time.get_ticks() - self.last_update &gt; self.frame_ticks a</span>
<a id="__codelineno-21-144" name="__codelineno-21-144"></a>        <span class="c1"># próxima imagem da animação será mostrada</span>
<a id="__codelineno-21-145" name="__codelineno-21-145"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frame_ticks</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-21-146" name="__codelineno-21-146"></a>
<a id="__codelineno-21-147" name="__codelineno-21-147"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-21-148" name="__codelineno-21-148"></a>        <span class="c1"># Verifica o tick atual.</span>
<a id="__codelineno-21-149" name="__codelineno-21-149"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-21-150" name="__codelineno-21-150"></a>        <span class="c1"># Verifica quantos ticks se passaram desde a ultima mudança de frame.</span>
<a id="__codelineno-21-151" name="__codelineno-21-151"></a>        <span class="n">elapsed_ticks</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span>
<a id="__codelineno-21-152" name="__codelineno-21-152"></a>
<a id="__codelineno-21-153" name="__codelineno-21-153"></a>        <span class="c1"># Se já está na hora de mudar de imagem...</span>
<a id="__codelineno-21-154" name="__codelineno-21-154"></a>        <span class="k">if</span> <span class="n">elapsed_ticks</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_ticks</span><span class="p">:</span>
<a id="__codelineno-21-155" name="__codelineno-21-155"></a>            <span class="c1"># Marca o tick da nova imagem.</span>
<a id="__codelineno-21-156" name="__codelineno-21-156"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span> <span class="o">=</span> <span class="n">now</span>
<a id="__codelineno-21-157" name="__codelineno-21-157"></a>
<a id="__codelineno-21-158" name="__codelineno-21-158"></a>            <span class="c1"># Avança um quadro.</span>
<a id="__codelineno-21-159" name="__codelineno-21-159"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-21-160" name="__codelineno-21-160"></a>
<a id="__codelineno-21-161" name="__codelineno-21-161"></a>            <span class="c1"># Verifica se já chegou no final da animação.</span>
<a id="__codelineno-21-162" name="__codelineno-21-162"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">):</span>
<a id="__codelineno-21-163" name="__codelineno-21-163"></a>                <span class="c1"># Se sim, tchau explosão!</span>
<a id="__codelineno-21-164" name="__codelineno-21-164"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-21-165" name="__codelineno-21-165"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-21-166" name="__codelineno-21-166"></a>                <span class="c1"># Se ainda não chegou ao fim da explosão, troca de imagem.</span>
<a id="__codelineno-21-167" name="__codelineno-21-167"></a>                <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span>
<a id="__codelineno-21-168" name="__codelineno-21-168"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span>
<a id="__codelineno-21-169" name="__codelineno-21-169"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-21-170" name="__codelineno-21-170"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
<a id="__codelineno-21-171" name="__codelineno-21-171"></a>
<a id="__codelineno-21-172" name="__codelineno-21-172"></a><span class="n">game</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-21-173" name="__codelineno-21-173"></a><span class="c1"># Variável para o ajuste de velocidade</span>
<a id="__codelineno-21-174" name="__codelineno-21-174"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<a id="__codelineno-21-175" name="__codelineno-21-175"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">30</span>
<a id="__codelineno-21-176" name="__codelineno-21-176"></a>
<a id="__codelineno-21-177" name="__codelineno-21-177"></a><span class="c1"># Criando um grupo de meteoros</span>
<a id="__codelineno-21-178" name="__codelineno-21-178"></a><span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-21-179" name="__codelineno-21-179"></a><span class="n">all_meteors</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-21-180" name="__codelineno-21-180"></a><span class="n">all_bullets</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-21-181" name="__codelineno-21-181"></a><span class="n">groups</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-21-182" name="__codelineno-21-182"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_sprites&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_sprites</span>
<a id="__codelineno-21-183" name="__codelineno-21-183"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_meteors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_meteors</span>
<a id="__codelineno-21-184" name="__codelineno-21-184"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_bullets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_bullets</span>
<a id="__codelineno-21-185" name="__codelineno-21-185"></a>
<a id="__codelineno-21-186" name="__codelineno-21-186"></a><span class="c1"># Criando o jogador</span>
<a id="__codelineno-21-187" name="__codelineno-21-187"></a><span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-21-188" name="__codelineno-21-188"></a><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-21-189" name="__codelineno-21-189"></a><span class="c1"># Criando os meteoros</span>
<a id="__codelineno-21-190" name="__codelineno-21-190"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a id="__codelineno-21-191" name="__codelineno-21-191"></a>    <span class="n">meteor</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-21-192" name="__codelineno-21-192"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-21-193" name="__codelineno-21-193"></a>    <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-21-194" name="__codelineno-21-194"></a>
<a id="__codelineno-21-195" name="__codelineno-21-195"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-21-196" name="__codelineno-21-196"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">loops</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-21-197" name="__codelineno-21-197"></a><span class="k">while</span> <span class="n">game</span><span class="p">:</span>
<a id="__codelineno-21-198" name="__codelineno-21-198"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
<a id="__codelineno-21-199" name="__codelineno-21-199"></a>
<a id="__codelineno-21-200" name="__codelineno-21-200"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-21-201" name="__codelineno-21-201"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-21-202" name="__codelineno-21-202"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-21-203" name="__codelineno-21-203"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-21-204" name="__codelineno-21-204"></a>            <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-21-205" name="__codelineno-21-205"></a>        <span class="c1"># Verifica se apertou alguma tecla.</span>
<a id="__codelineno-21-206" name="__codelineno-21-206"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>
<a id="__codelineno-21-207" name="__codelineno-21-207"></a>            <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-21-208" name="__codelineno-21-208"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-21-209" name="__codelineno-21-209"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-21-210" name="__codelineno-21-210"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-21-211" name="__codelineno-21-211"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-21-212" name="__codelineno-21-212"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_SPACE</span><span class="p">:</span>
<a id="__codelineno-21-213" name="__codelineno-21-213"></a>                <span class="n">player</span><span class="o">.</span><span class="n">shoot</span><span class="p">()</span>
<a id="__codelineno-21-214" name="__codelineno-21-214"></a>        <span class="c1"># Verifica se soltou alguma tecla.</span>
<a id="__codelineno-21-215" name="__codelineno-21-215"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYUP</span><span class="p">:</span>
<a id="__codelineno-21-216" name="__codelineno-21-216"></a>            <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-21-217" name="__codelineno-21-217"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-21-218" name="__codelineno-21-218"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-21-219" name="__codelineno-21-219"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-21-220" name="__codelineno-21-220"></a>                <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-21-221" name="__codelineno-21-221"></a>
<a id="__codelineno-21-222" name="__codelineno-21-222"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-21-223" name="__codelineno-21-223"></a>    <span class="c1"># Atualizando a posição dos meteoros</span>
<a id="__codelineno-21-224" name="__codelineno-21-224"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-21-225" name="__codelineno-21-225"></a>
<a id="__codelineno-21-226" name="__codelineno-21-226"></a>    <span class="c1"># Verifica se houve colisão entre tiro e meteoro</span>
<a id="__codelineno-21-227" name="__codelineno-21-227"></a>    <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">groupcollide</span><span class="p">(</span><span class="n">all_meteors</span><span class="p">,</span> <span class="n">all_bullets</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-21-228" name="__codelineno-21-228"></a>    <span class="k">for</span> <span class="n">meteor</span> <span class="ow">in</span> <span class="n">hits</span><span class="p">:</span> <span class="c1"># As chaves são os elementos do primeiro grupo (meteoros) que colidiram com alguma bala</span>
<a id="__codelineno-21-229" name="__codelineno-21-229"></a>        <span class="c1"># O meteoro e destruido e precisa ser recriado</span>
<a id="__codelineno-21-230" name="__codelineno-21-230"></a>        <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;destroy_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-21-231" name="__codelineno-21-231"></a>        <span class="n">m</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-21-232" name="__codelineno-21-232"></a>        <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-21-233" name="__codelineno-21-233"></a>        <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-21-234" name="__codelineno-21-234"></a>
<a id="__codelineno-21-235" name="__codelineno-21-235"></a>        <span class="c1"># No lugar do meteoro antigo, adicionar uma explosão.</span>
<a id="__codelineno-21-236" name="__codelineno-21-236"></a>        <span class="n">explosao</span> <span class="o">=</span> <span class="n">Explosion</span><span class="p">(</span><span class="n">meteor</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-21-237" name="__codelineno-21-237"></a>        <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">explosao</span><span class="p">)</span>
<a id="__codelineno-21-238" name="__codelineno-21-238"></a>
<a id="__codelineno-21-239" name="__codelineno-21-239"></a>    <span class="c1"># Verifica se houve colisão entre nave e meteoro</span>
<a id="__codelineno-21-240" name="__codelineno-21-240"></a>    <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">spritecollide</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">all_meteors</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-21-241" name="__codelineno-21-241"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hits</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-21-242" name="__codelineno-21-242"></a>        <span class="c1"># Toca o som da colisão</span>
<a id="__codelineno-21-243" name="__codelineno-21-243"></a>        <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;boom_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-21-244" name="__codelineno-21-244"></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Precisa esperar senão fecha</span>
<a id="__codelineno-21-245" name="__codelineno-21-245"></a>
<a id="__codelineno-21-246" name="__codelineno-21-246"></a>        <span class="n">game</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-21-247" name="__codelineno-21-247"></a>
<a id="__codelineno-21-248" name="__codelineno-21-248"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-21-249" name="__codelineno-21-249"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-21-250" name="__codelineno-21-250"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-21-251" name="__codelineno-21-251"></a>    <span class="c1"># Desenhando meteoros</span>
<a id="__codelineno-21-252" name="__codelineno-21-252"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-21-253" name="__codelineno-21-253"></a>
<a id="__codelineno-21-254" name="__codelineno-21-254"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-21-255" name="__codelineno-21-255"></a>
<a id="__codelineno-21-256" name="__codelineno-21-256"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-21-257" name="__codelineno-21-257"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<ul>
<li>Linhas 28 a 35: carrega as imagens da animação da explosão e guarda em uma lista. Adiciona a lista no dicionário <code class="language-python highlight"><span class="n">assets</span></code>;</li>
<li>Linhas 124 a 170: classe <code class="language-python highlight"><span class="n">Explosion</span></code>:</li>
<li>Linha 131: armazena a lista de imagens da animação em um atributo. Uma animação nada mais é que uma sucessão de imagens mostradas em um intervalo curto de tempo;</li>
<li>Linhas 134 a 137: coloca a primeira imagem da animação no atributo <code class="language-python highlight"><span class="bp">self</span><span class="o">.</span><span class="n">image</span></code> e define sua posição;</li>
<li>Linha 140: armazena o instante de tempo atual. Depois que passar <code class="language-python highlight"><span class="bp">self</span><span class="o">.</span><span class="n">frame_ticks</span></code> milissegundos a partir desse instante a próxima imagem será mostrada;</li>
<li>Linhas 154 a 170: método de atualização. Verifica se já se passaram <code class="language-python highlight"><span class="bp">self</span><span class="o">.</span><span class="n">frame_ticks</span></code> milissegundos desde que a última imagem foi mostrada. Em caso afirmativo, mostra a próxima imagem. Se já não existem mais imagens para mostrar, mata o sprite.</li>
<li>Linhas 236 e 237: cria o sprite de animação de explosão no mesmo lugar onde um meteoro foi explodido.</li>
</ul>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_15" id="exercise_15_0">
<p class="admonition-title">EXERCÍCIO 15</p>
<form class="exercise-form">
<p>Limite os tiros da nave a um tiro a cada 500 milissegundos. Dica: a lógica será semelhante à decisão de mostrar a próxima imagem da animação (a resposta estará no <code class="language-python highlight"><span class="n">jogo_v16</span><span class="o">.</span><span class="n">py</span></code>).</p>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="adicionando-estados">Adicionando estados</h2>
<p>Agora os meteoros estão bem legais, mas e a nave? Vamos agora introduzir um truque super útil para jogos (e vários outros programas de computador): a <strong>máquina de estados</strong>. Com uma máquina de estados, o programa apresenta comportamentos diferentes para cada estados. Esse é apenas o nome que damos para uma forma de estruturar o nosso código. Na prática você vai perceber que essa modificação não passa de um conjunto de <code class="language-python highlight"><span class="n">ifs</span></code>. No nosso jogo teremos a princípio 3 estados:</p>
<ol>
<li><code class="language-python highlight"><span class="n">DONE</span></code>: o jogo terminou;</li>
<li><code class="language-python highlight"><span class="n">PLAYING</span></code>: o jogador está jogando;</li>
<li><code class="language-python highlight"><span class="n">EXPLODING</span></code>: a nave está explodindo. Nesse estado o jogador não pode fazer nada (se ele apertar alguma coisa no teclado nada vai acontecer).</li>
</ol>
<p>A mudança para máquina de estados foi aplicada no <code class="language-python highlight"><span class="n">jogo_v16</span><span class="o">.</span><span class="n">py</span></code>. Observe que no novo arquivo mudamos o mecanismo do loop de jogo. Antes usávamos uma variável booleana para indicar se o jogo estava rodando ou não. Agora temos uma variável com um número inteiro que indica em qual estado estamos: rodando o jogo normalmente, estado de explosão da nave, ou se o jogo acabou. As principais mudanças são:</p>
<details class="info">
<summary>Código <code>referencia/jogo_v16.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">  1</a></span>
<span class="normal"><a href="#__codelineno-22-2">  2</a></span>
<span class="normal"><a href="#__codelineno-22-3">  3</a></span>
<span class="normal"><a href="#__codelineno-22-4">  4</a></span>
<span class="normal"><a href="#__codelineno-22-5">  5</a></span>
<span class="normal"><a href="#__codelineno-22-6">  6</a></span>
<span class="normal"><a href="#__codelineno-22-7">  7</a></span>
<span class="normal"><a href="#__codelineno-22-8">  8</a></span>
<span class="normal"><a href="#__codelineno-22-9">  9</a></span>
<span class="normal"><a href="#__codelineno-22-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-22-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-22-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-22-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-22-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-22-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-22-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-22-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-22-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-22-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-22-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-22-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-22-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-22-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-22-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-22-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-22-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-22-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-22-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-22-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-22-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-22-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-22-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-22-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-22-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-22-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-22-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-22-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-22-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-22-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-22-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-22-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-22-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-22-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-22-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-22-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-22-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-22-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-22-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-22-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-22-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-22-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-22-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-22-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-22-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-22-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-22-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-22-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-22-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-22-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-22-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-22-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-22-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-22-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-22-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-22-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-22-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-22-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-22-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-22-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-22-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-22-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-22-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-22-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-22-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-22-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-22-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-22-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-22-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-22-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-22-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-22-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-22-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-22-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-22-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-22-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-22-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-22-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-22-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-22-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-22-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-22-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-22-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-22-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-22-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-22-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-22-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-22-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-22-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-22-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-22-100">100</a></span>
<span class="normal"><a href="#__codelineno-22-101">101</a></span>
<span class="normal"><a href="#__codelineno-22-102">102</a></span>
<span class="normal"><a href="#__codelineno-22-103">103</a></span>
<span class="normal"><a href="#__codelineno-22-104">104</a></span>
<span class="normal"><a href="#__codelineno-22-105">105</a></span>
<span class="normal"><a href="#__codelineno-22-106">106</a></span>
<span class="normal"><a href="#__codelineno-22-107">107</a></span>
<span class="normal"><a href="#__codelineno-22-108">108</a></span>
<span class="normal"><a href="#__codelineno-22-109">109</a></span>
<span class="normal"><a href="#__codelineno-22-110">110</a></span>
<span class="normal"><a href="#__codelineno-22-111">111</a></span>
<span class="normal"><a href="#__codelineno-22-112">112</a></span>
<span class="normal"><a href="#__codelineno-22-113">113</a></span>
<span class="normal"><a href="#__codelineno-22-114">114</a></span>
<span class="normal"><a href="#__codelineno-22-115">115</a></span>
<span class="normal"><a href="#__codelineno-22-116">116</a></span>
<span class="normal"><a href="#__codelineno-22-117">117</a></span>
<span class="normal"><a href="#__codelineno-22-118">118</a></span>
<span class="normal"><a href="#__codelineno-22-119">119</a></span>
<span class="normal"><a href="#__codelineno-22-120">120</a></span>
<span class="normal"><a href="#__codelineno-22-121">121</a></span>
<span class="normal"><a href="#__codelineno-22-122">122</a></span>
<span class="normal"><a href="#__codelineno-22-123">123</a></span>
<span class="normal"><a href="#__codelineno-22-124">124</a></span>
<span class="normal"><a href="#__codelineno-22-125">125</a></span>
<span class="normal"><a href="#__codelineno-22-126">126</a></span>
<span class="normal"><a href="#__codelineno-22-127">127</a></span>
<span class="normal"><a href="#__codelineno-22-128">128</a></span>
<span class="normal"><a href="#__codelineno-22-129">129</a></span>
<span class="normal"><a href="#__codelineno-22-130">130</a></span>
<span class="normal"><a href="#__codelineno-22-131">131</a></span>
<span class="normal"><a href="#__codelineno-22-132">132</a></span>
<span class="normal"><a href="#__codelineno-22-133">133</a></span>
<span class="normal"><a href="#__codelineno-22-134">134</a></span>
<span class="normal"><a href="#__codelineno-22-135">135</a></span>
<span class="normal"><a href="#__codelineno-22-136">136</a></span>
<span class="normal"><a href="#__codelineno-22-137">137</a></span>
<span class="normal"><a href="#__codelineno-22-138">138</a></span>
<span class="normal"><a href="#__codelineno-22-139">139</a></span>
<span class="normal"><a href="#__codelineno-22-140">140</a></span>
<span class="normal"><a href="#__codelineno-22-141">141</a></span>
<span class="normal"><a href="#__codelineno-22-142">142</a></span>
<span class="normal"><a href="#__codelineno-22-143">143</a></span>
<span class="normal"><a href="#__codelineno-22-144">144</a></span>
<span class="normal"><a href="#__codelineno-22-145">145</a></span>
<span class="normal"><a href="#__codelineno-22-146">146</a></span>
<span class="normal"><a href="#__codelineno-22-147">147</a></span>
<span class="normal"><a href="#__codelineno-22-148">148</a></span>
<span class="normal"><a href="#__codelineno-22-149">149</a></span>
<span class="normal"><a href="#__codelineno-22-150">150</a></span>
<span class="normal"><a href="#__codelineno-22-151">151</a></span>
<span class="normal"><a href="#__codelineno-22-152">152</a></span>
<span class="normal"><a href="#__codelineno-22-153">153</a></span>
<span class="normal"><a href="#__codelineno-22-154">154</a></span>
<span class="normal"><a href="#__codelineno-22-155">155</a></span>
<span class="normal"><a href="#__codelineno-22-156">156</a></span>
<span class="normal"><a href="#__codelineno-22-157">157</a></span>
<span class="normal"><a href="#__codelineno-22-158">158</a></span>
<span class="normal"><a href="#__codelineno-22-159">159</a></span>
<span class="normal"><a href="#__codelineno-22-160">160</a></span>
<span class="normal"><a href="#__codelineno-22-161">161</a></span>
<span class="normal"><a href="#__codelineno-22-162">162</a></span>
<span class="normal"><a href="#__codelineno-22-163">163</a></span>
<span class="normal"><a href="#__codelineno-22-164">164</a></span>
<span class="normal"><a href="#__codelineno-22-165">165</a></span>
<span class="normal"><a href="#__codelineno-22-166">166</a></span>
<span class="normal"><a href="#__codelineno-22-167">167</a></span>
<span class="normal"><a href="#__codelineno-22-168">168</a></span>
<span class="normal"><a href="#__codelineno-22-169">169</a></span>
<span class="normal"><a href="#__codelineno-22-170">170</a></span>
<span class="normal"><a href="#__codelineno-22-171">171</a></span>
<span class="normal"><a href="#__codelineno-22-172">172</a></span>
<span class="normal"><a href="#__codelineno-22-173">173</a></span>
<span class="normal"><a href="#__codelineno-22-174">174</a></span>
<span class="normal"><a href="#__codelineno-22-175">175</a></span>
<span class="normal"><a href="#__codelineno-22-176">176</a></span>
<span class="normal"><a href="#__codelineno-22-177">177</a></span>
<span class="normal"><a href="#__codelineno-22-178">178</a></span>
<span class="normal"><a href="#__codelineno-22-179">179</a></span>
<span class="normal"><a href="#__codelineno-22-180">180</a></span>
<span class="normal"><a href="#__codelineno-22-181">181</a></span>
<span class="normal"><a href="#__codelineno-22-182">182</a></span>
<span class="normal"><a href="#__codelineno-22-183">183</a></span>
<span class="normal"><a href="#__codelineno-22-184">184</a></span>
<span class="normal"><a href="#__codelineno-22-185">185</a></span>
<span class="normal"><a href="#__codelineno-22-186">186</a></span>
<span class="normal"><a href="#__codelineno-22-187">187</a></span>
<span class="normal"><a href="#__codelineno-22-188">188</a></span>
<span class="normal"><a href="#__codelineno-22-189">189</a></span>
<span class="normal"><a href="#__codelineno-22-190">190</a></span>
<span class="normal"><a href="#__codelineno-22-191">191</a></span>
<span class="normal"><a href="#__codelineno-22-192">192</a></span>
<span class="normal"><a href="#__codelineno-22-193">193</a></span>
<span class="normal"><a href="#__codelineno-22-194">194</a></span>
<span class="normal"><a href="#__codelineno-22-195">195</a></span>
<span class="normal"><a href="#__codelineno-22-196">196</a></span>
<span class="normal"><a href="#__codelineno-22-197">197</a></span>
<span class="normal"><a href="#__codelineno-22-198">198</a></span>
<span class="normal"><a href="#__codelineno-22-199">199</a></span>
<span class="normal"><a href="#__codelineno-22-200">200</a></span>
<span class="normal"><a href="#__codelineno-22-201">201</a></span>
<span class="normal"><a href="#__codelineno-22-202">202</a></span>
<span class="normal"><a href="#__codelineno-22-203">203</a></span>
<span class="normal"><a href="#__codelineno-22-204">204</a></span>
<span class="normal"><a href="#__codelineno-22-205">205</a></span>
<span class="normal"><a href="#__codelineno-22-206">206</a></span>
<span class="normal"><a href="#__codelineno-22-207">207</a></span>
<span class="normal"><a href="#__codelineno-22-208">208</a></span>
<span class="normal"><a href="#__codelineno-22-209">209</a></span>
<span class="normal"><a href="#__codelineno-22-210">210</a></span>
<span class="normal"><a href="#__codelineno-22-211">211</a></span>
<span class="normal"><a href="#__codelineno-22-212">212</a></span>
<span class="normal"><a href="#__codelineno-22-213">213</a></span>
<span class="normal"><a href="#__codelineno-22-214">214</a></span>
<span class="normal"><a href="#__codelineno-22-215">215</a></span>
<span class="normal"><a href="#__codelineno-22-216">216</a></span>
<span class="normal"><a href="#__codelineno-22-217">217</a></span>
<span class="normal"><a href="#__codelineno-22-218">218</a></span>
<span class="normal"><a href="#__codelineno-22-219">219</a></span>
<span class="normal"><a href="#__codelineno-22-220">220</a></span>
<span class="normal"><a href="#__codelineno-22-221">221</a></span>
<span class="normal"><a href="#__codelineno-22-222">222</a></span>
<span class="normal"><a href="#__codelineno-22-223">223</a></span>
<span class="normal"><a href="#__codelineno-22-224">224</a></span>
<span class="normal"><a href="#__codelineno-22-225">225</a></span>
<span class="normal"><a href="#__codelineno-22-226">226</a></span>
<span class="normal"><a href="#__codelineno-22-227">227</a></span>
<span class="normal"><a href="#__codelineno-22-228">228</a></span>
<span class="normal"><a href="#__codelineno-22-229">229</a></span>
<span class="normal"><a href="#__codelineno-22-230">230</a></span>
<span class="normal"><a href="#__codelineno-22-231">231</a></span>
<span class="normal"><a href="#__codelineno-22-232">232</a></span>
<span class="normal"><a href="#__codelineno-22-233">233</a></span>
<span class="normal"><a href="#__codelineno-22-234">234</a></span>
<span class="normal"><a href="#__codelineno-22-235">235</a></span>
<span class="normal"><a href="#__codelineno-22-236">236</a></span>
<span class="normal"><a href="#__codelineno-22-237">237</a></span>
<span class="normal"><a href="#__codelineno-22-238">238</a></span>
<span class="normal"><a href="#__codelineno-22-239">239</a></span>
<span class="normal"><a href="#__codelineno-22-240">240</a></span>
<span class="normal"><a href="#__codelineno-22-241">241</a></span>
<span class="normal"><a href="#__codelineno-22-242">242</a></span>
<span class="normal"><a href="#__codelineno-22-243">243</a></span>
<span class="normal"><a href="#__codelineno-22-244">244</a></span>
<span class="normal"><a href="#__codelineno-22-245">245</a></span>
<span class="normal"><a href="#__codelineno-22-246">246</a></span>
<span class="normal"><a href="#__codelineno-22-247">247</a></span>
<span class="normal"><a href="#__codelineno-22-248">248</a></span>
<span class="normal"><a href="#__codelineno-22-249">249</a></span>
<span class="normal"><a href="#__codelineno-22-250">250</a></span>
<span class="normal"><a href="#__codelineno-22-251">251</a></span>
<span class="normal"><a href="#__codelineno-22-252">252</a></span>
<span class="normal"><a href="#__codelineno-22-253">253</a></span>
<span class="normal"><a href="#__codelineno-22-254">254</a></span>
<span class="normal"><a href="#__codelineno-22-255">255</a></span>
<span class="normal"><a href="#__codelineno-22-256">256</a></span>
<span class="normal"><a href="#__codelineno-22-257">257</a></span>
<span class="normal"><a href="#__codelineno-22-258">258</a></span>
<span class="normal"><a href="#__codelineno-22-259">259</a></span>
<span class="normal"><a href="#__codelineno-22-260">260</a></span>
<span class="normal"><a href="#__codelineno-22-261">261</a></span>
<span class="normal"><a href="#__codelineno-22-262">262</a></span>
<span class="normal"><a href="#__codelineno-22-263">263</a></span>
<span class="normal"><a href="#__codelineno-22-264">264</a></span>
<span class="normal"><a href="#__codelineno-22-265">265</a></span>
<span class="normal"><a href="#__codelineno-22-266">266</a></span>
<span class="normal"><a href="#__codelineno-22-267">267</a></span>
<span class="normal"><a href="#__codelineno-22-268">268</a></span>
<span class="normal"><a href="#__codelineno-22-269">269</a></span>
<span class="normal"><a href="#__codelineno-22-270">270</a></span>
<span class="normal"><a href="#__codelineno-22-271">271</a></span>
<span class="normal"><a href="#__codelineno-22-272">272</a></span>
<span class="normal"><a href="#__codelineno-22-273">273</a></span>
<span class="normal"><a href="#__codelineno-22-274">274</a></span>
<span class="normal"><a href="#__codelineno-22-275">275</a></span>
<span class="normal"><a href="#__codelineno-22-276">276</a></span>
<span class="normal"><a href="#__codelineno-22-277">277</a></span>
<span class="normal"><a href="#__codelineno-22-278">278</a></span>
<span class="normal"><a href="#__codelineno-22-279">279</a></span>
<span class="normal"><a href="#__codelineno-22-280">280</a></span>
<span class="normal"><a href="#__codelineno-22-281">281</a></span>
<span class="normal"><a href="#__codelineno-22-282">282</a></span>
<span class="normal"><a href="#__codelineno-22-283">283</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-22-3" name="__codelineno-22-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-22-4" name="__codelineno-22-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-22-5" name="__codelineno-22-5"></a>
<a id="__codelineno-22-6" name="__codelineno-22-6"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-22-7" name="__codelineno-22-7"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-22-8" name="__codelineno-22-8"></a>
<a id="__codelineno-22-9" name="__codelineno-22-9"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-22-10" name="__codelineno-22-10"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">480</span>
<a id="__codelineno-22-11" name="__codelineno-22-11"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-22-12" name="__codelineno-22-12"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-22-13" name="__codelineno-22-13"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-22-14" name="__codelineno-22-14"></a>
<a id="__codelineno-22-15" name="__codelineno-22-15"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-22-16" name="__codelineno-22-16"></a><span class="n">METEOR_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-22-17" name="__codelineno-22-17"></a><span class="n">METEOR_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-22-18" name="__codelineno-22-18"></a><span class="n">SHIP_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-22-19" name="__codelineno-22-19"></a><span class="n">SHIP_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-22-20" name="__codelineno-22-20"></a><span class="n">assets</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-22-21" name="__codelineno-22-21"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/starfield.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-22-22" name="__codelineno-22-22"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/meteorBrown_med1.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-22-23" name="__codelineno-22-23"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">],</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-22-24" name="__codelineno-22-24"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/playerShip1_orange.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-22-25" name="__codelineno-22-25"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">],</span> <span class="p">(</span><span class="n">SHIP_WIDTH</span><span class="p">,</span> <span class="n">SHIP_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-22-26" name="__codelineno-22-26"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;bullet_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/laserRed16.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-22-27" name="__codelineno-22-27"></a><span class="n">explosion_anim</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-22-28" name="__codelineno-22-28"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
<a id="__codelineno-22-29" name="__codelineno-22-29"></a>    <span class="c1"># Os arquivos de animação são numerados de 00 a 08</span>
<a id="__codelineno-22-30" name="__codelineno-22-30"></a>    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;assets/img/regularExplosion0</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-22-31" name="__codelineno-22-31"></a>    <span class="n">img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-22-32" name="__codelineno-22-32"></a>    <span class="n">img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
<a id="__codelineno-22-33" name="__codelineno-22-33"></a>    <span class="n">explosion_anim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<a id="__codelineno-22-34" name="__codelineno-22-34"></a><span class="n">assets</span><span class="p">[</span><span class="s2">&quot;explosion_anim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">explosion_anim</span>
<a id="__codelineno-22-35" name="__codelineno-22-35"></a>
<a id="__codelineno-22-36" name="__codelineno-22-36"></a><span class="c1"># Carrega os sons do jogo</span>
<a id="__codelineno-22-37" name="__codelineno-22-37"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/snd/tgfcoder-FrozenJam-SeamlessLoop.ogg&#39;</span><span class="p">)</span>
<a id="__codelineno-22-38" name="__codelineno-22-38"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">set_volume</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
<a id="__codelineno-22-39" name="__codelineno-22-39"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;boom_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/expl3.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-22-40" name="__codelineno-22-40"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;destroy_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/expl6.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-22-41" name="__codelineno-22-41"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;pew_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/pew.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-22-42" name="__codelineno-22-42"></a>
<a id="__codelineno-22-43" name="__codelineno-22-43"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-22-44" name="__codelineno-22-44"></a><span class="c1"># Definindo os novos tipos</span>
<a id="__codelineno-22-45" name="__codelineno-22-45"></a><span class="k">class</span> <span class="nc">Ship</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-22-46" name="__codelineno-22-46"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-22-47" name="__codelineno-22-47"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-22-48" name="__codelineno-22-48"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-22-49" name="__codelineno-22-49"></a>
<a id="__codelineno-22-50" name="__codelineno-22-50"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span>
<a id="__codelineno-22-51" name="__codelineno-22-51"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-22-52" name="__codelineno-22-52"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-22-53" name="__codelineno-22-53"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span>
<a id="__codelineno-22-54" name="__codelineno-22-54"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-22-55" name="__codelineno-22-55"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="o">=</span> <span class="n">groups</span>
<a id="__codelineno-22-56" name="__codelineno-22-56"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assets</span> <span class="o">=</span> <span class="n">assets</span>
<a id="__codelineno-22-57" name="__codelineno-22-57"></a>
<a id="__codelineno-22-58" name="__codelineno-22-58"></a>        <span class="c1"># Só será possível atirar uma vez a cada 500 milissegundos</span>
<a id="__codelineno-22-59" name="__codelineno-22-59"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-22-60" name="__codelineno-22-60"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shoot_ticks</span> <span class="o">=</span> <span class="mi">500</span>
<a id="__codelineno-22-61" name="__codelineno-22-61"></a>
<a id="__codelineno-22-62" name="__codelineno-22-62"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-22-63" name="__codelineno-22-63"></a>        <span class="c1"># Atualização da posição da nave</span>
<a id="__codelineno-22-64" name="__codelineno-22-64"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-22-65" name="__codelineno-22-65"></a>
<a id="__codelineno-22-66" name="__codelineno-22-66"></a>        <span class="c1"># Mantem dentro da tela</span>
<a id="__codelineno-22-67" name="__codelineno-22-67"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-22-68" name="__codelineno-22-68"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">WIDTH</span>
<a id="__codelineno-22-69" name="__codelineno-22-69"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-22-70" name="__codelineno-22-70"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-22-71" name="__codelineno-22-71"></a>
<a id="__codelineno-22-72" name="__codelineno-22-72"></a>    <span class="k">def</span> <span class="nf">shoot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-22-73" name="__codelineno-22-73"></a>        <span class="c1"># Verifica se pode atirar</span>
<a id="__codelineno-22-74" name="__codelineno-22-74"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-22-75" name="__codelineno-22-75"></a>        <span class="c1"># Verifica quantos ticks se passaram desde o último tiro.</span>
<a id="__codelineno-22-76" name="__codelineno-22-76"></a>        <span class="n">elapsed_ticks</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span>
<a id="__codelineno-22-77" name="__codelineno-22-77"></a>
<a id="__codelineno-22-78" name="__codelineno-22-78"></a>        <span class="c1"># Se já pode atirar novamente...</span>
<a id="__codelineno-22-79" name="__codelineno-22-79"></a>        <span class="k">if</span> <span class="n">elapsed_ticks</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">shoot_ticks</span><span class="p">:</span>
<a id="__codelineno-22-80" name="__codelineno-22-80"></a>            <span class="c1"># Marca o tick da nova imagem.</span>
<a id="__codelineno-22-81" name="__codelineno-22-81"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span> <span class="o">=</span> <span class="n">now</span>
<a id="__codelineno-22-82" name="__codelineno-22-82"></a>            <span class="c1"># A nova bala vai ser criada logo acima e no centro horizontal da nave</span>
<a id="__codelineno-22-83" name="__codelineno-22-83"></a>            <span class="n">new_bullet</span> <span class="o">=</span> <span class="n">Bullet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span><span class="p">)</span>
<a id="__codelineno-22-84" name="__codelineno-22-84"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_sprites&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-22-85" name="__codelineno-22-85"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_bullets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-22-86" name="__codelineno-22-86"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;pew_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-22-87" name="__codelineno-22-87"></a>
<a id="__codelineno-22-88" name="__codelineno-22-88"></a><span class="k">class</span> <span class="nc">Meteor</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-22-89" name="__codelineno-22-89"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-22-90" name="__codelineno-22-90"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-22-91" name="__codelineno-22-91"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-22-92" name="__codelineno-22-92"></a>
<a id="__codelineno-22-93" name="__codelineno-22-93"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span>
<a id="__codelineno-22-94" name="__codelineno-22-94"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-22-95" name="__codelineno-22-95"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-22-96" name="__codelineno-22-96"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-22-97" name="__codelineno-22-97"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-22-98" name="__codelineno-22-98"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-22-99" name="__codelineno-22-99"></a>
<a id="__codelineno-22-100" name="__codelineno-22-100"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-22-101" name="__codelineno-22-101"></a>        <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-22-102" name="__codelineno-22-102"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-22-103" name="__codelineno-22-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-22-104" name="__codelineno-22-104"></a>        <span class="c1"># Se o meteoro passar do final da tela, volta para cima e sorteia</span>
<a id="__codelineno-22-105" name="__codelineno-22-105"></a>        <span class="c1"># novas posições e velocidades</span>
<a id="__codelineno-22-106" name="__codelineno-22-106"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-22-107" name="__codelineno-22-107"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-22-108" name="__codelineno-22-108"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-22-109" name="__codelineno-22-109"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-22-110" name="__codelineno-22-110"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-22-111" name="__codelineno-22-111"></a>
<a id="__codelineno-22-112" name="__codelineno-22-112"></a><span class="c1"># Classe Bullet que representa os tiros</span>
<a id="__codelineno-22-113" name="__codelineno-22-113"></a><span class="k">class</span> <span class="nc">Bullet</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-22-114" name="__codelineno-22-114"></a>    <span class="c1"># Construtor da classe.</span>
<a id="__codelineno-22-115" name="__codelineno-22-115"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assets</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">centerx</span><span class="p">):</span>
<a id="__codelineno-22-116" name="__codelineno-22-116"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-22-117" name="__codelineno-22-117"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-22-118" name="__codelineno-22-118"></a>
<a id="__codelineno-22-119" name="__codelineno-22-119"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;bullet_img&#39;</span><span class="p">]</span>
<a id="__codelineno-22-120" name="__codelineno-22-120"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-22-121" name="__codelineno-22-121"></a>
<a id="__codelineno-22-122" name="__codelineno-22-122"></a>        <span class="c1"># Coloca no lugar inicial definido em x, y do constutor</span>
<a id="__codelineno-22-123" name="__codelineno-22-123"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">centerx</span>
<a id="__codelineno-22-124" name="__codelineno-22-124"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">bottom</span>
<a id="__codelineno-22-125" name="__codelineno-22-125"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>  <span class="c1"># Velocidade fixa para cima</span>
<a id="__codelineno-22-126" name="__codelineno-22-126"></a>
<a id="__codelineno-22-127" name="__codelineno-22-127"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-22-128" name="__codelineno-22-128"></a>        <span class="c1"># A bala só se move no eixo y</span>
<a id="__codelineno-22-129" name="__codelineno-22-129"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-22-130" name="__codelineno-22-130"></a>
<a id="__codelineno-22-131" name="__codelineno-22-131"></a>        <span class="c1"># Se o tiro passar do inicio da tela, morre.</span>
<a id="__codelineno-22-132" name="__codelineno-22-132"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-22-133" name="__codelineno-22-133"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-22-134" name="__codelineno-22-134"></a>
<a id="__codelineno-22-135" name="__codelineno-22-135"></a><span class="c1"># Classe que representa uma explosão de meteoro</span>
<a id="__codelineno-22-136" name="__codelineno-22-136"></a><span class="k">class</span> <span class="nc">Explosion</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-22-137" name="__codelineno-22-137"></a>    <span class="c1"># Construtor da classe.</span>
<a id="__codelineno-22-138" name="__codelineno-22-138"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-22-139" name="__codelineno-22-139"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-22-140" name="__codelineno-22-140"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-22-141" name="__codelineno-22-141"></a>
<a id="__codelineno-22-142" name="__codelineno-22-142"></a>        <span class="c1"># Armazena a animação de explosão</span>
<a id="__codelineno-22-143" name="__codelineno-22-143"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;explosion_anim&#39;</span><span class="p">]</span>
<a id="__codelineno-22-144" name="__codelineno-22-144"></a>
<a id="__codelineno-22-145" name="__codelineno-22-145"></a>        <span class="c1"># Inicia o processo de animação colocando a primeira imagem na tela.</span>
<a id="__codelineno-22-146" name="__codelineno-22-146"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Armazena o índice atual na animação</span>
<a id="__codelineno-22-147" name="__codelineno-22-147"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span>  <span class="c1"># Pega a primeira imagem</span>
<a id="__codelineno-22-148" name="__codelineno-22-148"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-22-149" name="__codelineno-22-149"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>  <span class="c1"># Posiciona o centro da imagem</span>
<a id="__codelineno-22-150" name="__codelineno-22-150"></a>
<a id="__codelineno-22-151" name="__codelineno-22-151"></a>        <span class="c1"># Guarda o tick da primeira imagem, ou seja, o momento em que a imagem foi mostrada</span>
<a id="__codelineno-22-152" name="__codelineno-22-152"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-22-153" name="__codelineno-22-153"></a>
<a id="__codelineno-22-154" name="__codelineno-22-154"></a>        <span class="c1"># Controle de ticks de animação: troca de imagem a cada self.frame_ticks milissegundos.</span>
<a id="__codelineno-22-155" name="__codelineno-22-155"></a>        <span class="c1"># Quando pygame.time.get_ticks() - self.last_update &gt; self.frame_ticks a</span>
<a id="__codelineno-22-156" name="__codelineno-22-156"></a>        <span class="c1"># próxima imagem da animação será mostrada</span>
<a id="__codelineno-22-157" name="__codelineno-22-157"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frame_ticks</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-22-158" name="__codelineno-22-158"></a>
<a id="__codelineno-22-159" name="__codelineno-22-159"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-22-160" name="__codelineno-22-160"></a>        <span class="c1"># Verifica o tick atual.</span>
<a id="__codelineno-22-161" name="__codelineno-22-161"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-22-162" name="__codelineno-22-162"></a>        <span class="c1"># Verifica quantos ticks se passaram desde a ultima mudança de frame.</span>
<a id="__codelineno-22-163" name="__codelineno-22-163"></a>        <span class="n">elapsed_ticks</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span>
<a id="__codelineno-22-164" name="__codelineno-22-164"></a>
<a id="__codelineno-22-165" name="__codelineno-22-165"></a>        <span class="c1"># Se já está na hora de mudar de imagem...</span>
<a id="__codelineno-22-166" name="__codelineno-22-166"></a>        <span class="k">if</span> <span class="n">elapsed_ticks</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_ticks</span><span class="p">:</span>
<a id="__codelineno-22-167" name="__codelineno-22-167"></a>            <span class="c1"># Marca o tick da nova imagem.</span>
<a id="__codelineno-22-168" name="__codelineno-22-168"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span> <span class="o">=</span> <span class="n">now</span>
<a id="__codelineno-22-169" name="__codelineno-22-169"></a>
<a id="__codelineno-22-170" name="__codelineno-22-170"></a>            <span class="c1"># Avança um quadro.</span>
<a id="__codelineno-22-171" name="__codelineno-22-171"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-22-172" name="__codelineno-22-172"></a>
<a id="__codelineno-22-173" name="__codelineno-22-173"></a>            <span class="c1"># Verifica se já chegou no final da animação.</span>
<a id="__codelineno-22-174" name="__codelineno-22-174"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">):</span>
<a id="__codelineno-22-175" name="__codelineno-22-175"></a>                <span class="c1"># Se sim, tchau explosão!</span>
<a id="__codelineno-22-176" name="__codelineno-22-176"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-22-177" name="__codelineno-22-177"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-22-178" name="__codelineno-22-178"></a>                <span class="c1"># Se ainda não chegou ao fim da explosão, troca de imagem.</span>
<a id="__codelineno-22-179" name="__codelineno-22-179"></a>                <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span>
<a id="__codelineno-22-180" name="__codelineno-22-180"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span>
<a id="__codelineno-22-181" name="__codelineno-22-181"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-22-182" name="__codelineno-22-182"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
<a id="__codelineno-22-183" name="__codelineno-22-183"></a>
<a id="__codelineno-22-184" name="__codelineno-22-184"></a><span class="c1"># Variável para o ajuste de velocidade</span>
<a id="__codelineno-22-185" name="__codelineno-22-185"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<a id="__codelineno-22-186" name="__codelineno-22-186"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">30</span>
<a id="__codelineno-22-187" name="__codelineno-22-187"></a>
<a id="__codelineno-22-188" name="__codelineno-22-188"></a><span class="c1"># Criando um grupo de meteoros</span>
<a id="__codelineno-22-189" name="__codelineno-22-189"></a><span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-22-190" name="__codelineno-22-190"></a><span class="n">all_meteors</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-22-191" name="__codelineno-22-191"></a><span class="n">all_bullets</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-22-192" name="__codelineno-22-192"></a><span class="n">groups</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-22-193" name="__codelineno-22-193"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_sprites&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_sprites</span>
<a id="__codelineno-22-194" name="__codelineno-22-194"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_meteors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_meteors</span>
<a id="__codelineno-22-195" name="__codelineno-22-195"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_bullets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_bullets</span>
<a id="__codelineno-22-196" name="__codelineno-22-196"></a>
<a id="__codelineno-22-197" name="__codelineno-22-197"></a><span class="c1"># Criando o jogador</span>
<a id="__codelineno-22-198" name="__codelineno-22-198"></a><span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-22-199" name="__codelineno-22-199"></a><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-22-200" name="__codelineno-22-200"></a><span class="c1"># Criando os meteoros</span>
<a id="__codelineno-22-201" name="__codelineno-22-201"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a id="__codelineno-22-202" name="__codelineno-22-202"></a>    <span class="n">meteor</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-22-203" name="__codelineno-22-203"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-22-204" name="__codelineno-22-204"></a>    <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-22-205" name="__codelineno-22-205"></a>
<a id="__codelineno-22-206" name="__codelineno-22-206"></a><span class="n">DONE</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-22-207" name="__codelineno-22-207"></a><span class="n">PLAYING</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-22-208" name="__codelineno-22-208"></a><span class="n">EXPLODING</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-22-209" name="__codelineno-22-209"></a><span class="n">state</span> <span class="o">=</span> <span class="n">PLAYING</span>
<a id="__codelineno-22-210" name="__codelineno-22-210"></a>
<a id="__codelineno-22-211" name="__codelineno-22-211"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-22-212" name="__codelineno-22-212"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">loops</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-22-213" name="__codelineno-22-213"></a><span class="k">while</span> <span class="n">state</span> <span class="o">!=</span> <span class="n">DONE</span><span class="p">:</span>
<a id="__codelineno-22-214" name="__codelineno-22-214"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
<a id="__codelineno-22-215" name="__codelineno-22-215"></a>
<a id="__codelineno-22-216" name="__codelineno-22-216"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-22-217" name="__codelineno-22-217"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-22-218" name="__codelineno-22-218"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-22-219" name="__codelineno-22-219"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-22-220" name="__codelineno-22-220"></a>            <span class="n">state</span> <span class="o">=</span> <span class="n">DONE</span>
<a id="__codelineno-22-221" name="__codelineno-22-221"></a>        <span class="c1"># Só verifica o teclado se está no estado de jogo</span>
<a id="__codelineno-22-222" name="__codelineno-22-222"></a>        <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">PLAYING</span><span class="p">:</span>
<a id="__codelineno-22-223" name="__codelineno-22-223"></a>            <span class="c1"># Verifica se apertou alguma tecla.</span>
<a id="__codelineno-22-224" name="__codelineno-22-224"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>
<a id="__codelineno-22-225" name="__codelineno-22-225"></a>                <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-22-226" name="__codelineno-22-226"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-22-227" name="__codelineno-22-227"></a>                    <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-22-228" name="__codelineno-22-228"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-22-229" name="__codelineno-22-229"></a>                    <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-22-230" name="__codelineno-22-230"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_SPACE</span><span class="p">:</span>
<a id="__codelineno-22-231" name="__codelineno-22-231"></a>                    <span class="n">player</span><span class="o">.</span><span class="n">shoot</span><span class="p">()</span>
<a id="__codelineno-22-232" name="__codelineno-22-232"></a>            <span class="c1"># Verifica se soltou alguma tecla.</span>
<a id="__codelineno-22-233" name="__codelineno-22-233"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYUP</span><span class="p">:</span>
<a id="__codelineno-22-234" name="__codelineno-22-234"></a>                <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-22-235" name="__codelineno-22-235"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-22-236" name="__codelineno-22-236"></a>                    <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-22-237" name="__codelineno-22-237"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-22-238" name="__codelineno-22-238"></a>                    <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-22-239" name="__codelineno-22-239"></a>
<a id="__codelineno-22-240" name="__codelineno-22-240"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-22-241" name="__codelineno-22-241"></a>    <span class="c1"># Atualizando a posição dos meteoros</span>
<a id="__codelineno-22-242" name="__codelineno-22-242"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-22-243" name="__codelineno-22-243"></a>
<a id="__codelineno-22-244" name="__codelineno-22-244"></a>    <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">PLAYING</span><span class="p">:</span>
<a id="__codelineno-22-245" name="__codelineno-22-245"></a>        <span class="c1"># Verifica se houve colisão entre tiro e meteoro</span>
<a id="__codelineno-22-246" name="__codelineno-22-246"></a>        <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">groupcollide</span><span class="p">(</span><span class="n">all_meteors</span><span class="p">,</span> <span class="n">all_bullets</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-22-247" name="__codelineno-22-247"></a>        <span class="k">for</span> <span class="n">meteor</span> <span class="ow">in</span> <span class="n">hits</span><span class="p">:</span> <span class="c1"># As chaves são os elementos do primeiro grupo (meteoros) que colidiram com alguma bala</span>
<a id="__codelineno-22-248" name="__codelineno-22-248"></a>            <span class="c1"># O meteoro e destruido e precisa ser recriado</span>
<a id="__codelineno-22-249" name="__codelineno-22-249"></a>            <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;destroy_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-22-250" name="__codelineno-22-250"></a>            <span class="n">m</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-22-251" name="__codelineno-22-251"></a>            <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-22-252" name="__codelineno-22-252"></a>            <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-22-253" name="__codelineno-22-253"></a>
<a id="__codelineno-22-254" name="__codelineno-22-254"></a>            <span class="c1"># No lugar do meteoro antigo, adicionar uma explosão.</span>
<a id="__codelineno-22-255" name="__codelineno-22-255"></a>            <span class="n">explosao</span> <span class="o">=</span> <span class="n">Explosion</span><span class="p">(</span><span class="n">meteor</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-22-256" name="__codelineno-22-256"></a>            <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">explosao</span><span class="p">)</span>
<a id="__codelineno-22-257" name="__codelineno-22-257"></a>
<a id="__codelineno-22-258" name="__codelineno-22-258"></a>        <span class="c1"># Verifica se houve colisão entre nave e meteoro</span>
<a id="__codelineno-22-259" name="__codelineno-22-259"></a>        <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">spritecollide</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">all_meteors</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-22-260" name="__codelineno-22-260"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hits</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-22-261" name="__codelineno-22-261"></a>            <span class="c1"># Toca o som da colisão</span>
<a id="__codelineno-22-262" name="__codelineno-22-262"></a>            <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;boom_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-22-263" name="__codelineno-22-263"></a>            <span class="n">player</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-22-264" name="__codelineno-22-264"></a>            <span class="n">explosao</span> <span class="o">=</span> <span class="n">Explosion</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-22-265" name="__codelineno-22-265"></a>            <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">explosao</span><span class="p">)</span>
<a id="__codelineno-22-266" name="__codelineno-22-266"></a>            <span class="n">state</span> <span class="o">=</span> <span class="n">EXPLODING</span>
<a id="__codelineno-22-267" name="__codelineno-22-267"></a>            <span class="n">explosion_tick</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-22-268" name="__codelineno-22-268"></a>            <span class="n">explosion_duration</span> <span class="o">=</span> <span class="n">explosao</span><span class="o">.</span><span class="n">frame_ticks</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">explosao</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">)</span> <span class="o">+</span> <span class="mi">400</span>
<a id="__codelineno-22-269" name="__codelineno-22-269"></a>    <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="n">EXPLODING</span><span class="p">:</span>
<a id="__codelineno-22-270" name="__codelineno-22-270"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-22-271" name="__codelineno-22-271"></a>        <span class="k">if</span> <span class="n">now</span> <span class="o">-</span> <span class="n">explosion_tick</span> <span class="o">&gt;</span> <span class="n">explosion_duration</span><span class="p">:</span>
<a id="__codelineno-22-272" name="__codelineno-22-272"></a>            <span class="n">state</span> <span class="o">=</span> <span class="n">DONE</span>
<a id="__codelineno-22-273" name="__codelineno-22-273"></a>
<a id="__codelineno-22-274" name="__codelineno-22-274"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-22-275" name="__codelineno-22-275"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-22-276" name="__codelineno-22-276"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-22-277" name="__codelineno-22-277"></a>    <span class="c1"># Desenhando meteoros</span>
<a id="__codelineno-22-278" name="__codelineno-22-278"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-22-279" name="__codelineno-22-279"></a>
<a id="__codelineno-22-280" name="__codelineno-22-280"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-22-281" name="__codelineno-22-281"></a>
<a id="__codelineno-22-282" name="__codelineno-22-282"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-22-283" name="__codelineno-22-283"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<ul>
<li>Linhas 59, 60 e 74 a 81: resposta do exercício 15;</li>
<li>Linhas 206 a 209: definindo constantes com o valor de cada estado (poderia ser qualquer valor) e definindo o estado inicial como <code class="language-python highlight"><span class="n">PLAYING</span></code>. Note que apagamos a variável <code class="language-python highlight"><span class="n">game</span></code> do código inteiro;</li>
<li>Linha 213: condição do loop principal depende do estado. O jogo para quando <code class="language-python highlight"><span class="n">state</span></code> é igual a <code class="language-python highlight"><span class="n">DONE</span></code>, ou seja, <code class="language-python highlight"><span class="mi">0</span></code>;</li>
<li>Linha 220: muda o estado para <code class="language-python highlight"><span class="n">DONE</span></code> se o jogador apertou no X para fechar a janela;</li>
<li>Linha 222: só aplica as consequências de eventos de teclado se o estado for <code class="language-python highlight"><span class="n">PLAYING</span></code>;</li>
<li>Linha 244: verifica colisões apenas se o estado for <code class="language-python highlight"><span class="n">PLAYING</span></code>;</li>
<li>Linhas 263 a 265: mata a nave (para ela sumir) e cria uma explosão no lugar;</li>
<li>Linhas 266 a 268: muda o estado para <code class="language-python highlight"><span class="n">EXPLODING</span></code> e armazena o instante de tempo em que esse estado começou. A variável <code class="language-python highlight"><span class="n">explosion_duration</span></code> guarda a duração da animação de explosão com um adicional de 400 milissegundos;</li>
<li>Linhas 269 a 272: se o estado for <code class="language-python highlight"><span class="n">EXPLODING</span></code> verifica se já passou o tempo necessário para a animação da explosão e depois termina o jogo (muda o estado para <code class="language-python highlight"><span class="n">DONE</span></code>).</li>
</ul>
<p>Note que com o uso da máquina de estados não precisamos mais do <code class="language-python highlight"><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></code> para esperar antes do jogo terminar.</p>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_16" id="exercise_16_0">
<p class="admonition-title">EXERCÍCIO 16</p>
<form class="exercise-form">
<p>Modifique o <code class="language-python highlight"><span class="n">jogo_v16</span><span class="o">.</span><span class="n">py</span></code> para que o jogo nunca acabe, ou seja, depois que a nave termina de explodir ela ressurge na posição inicial (a resposta estará no <code class="language-python highlight"><span class="n">jogo_v17</span><span class="o">.</span><span class="n">py</span></code>).</p>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="adicionando-um-placar">Adicionando um placar</h2>
<p>Vamos utilizar uma fonte com jeitão de arcade dos anos 80. Já vimos como desenhar texto na tela, então juntando esses conhecimentos podemos mostrar o placar ao longo do jogo. O <code class="language-python highlight"><span class="n">jogo_v17</span><span class="o">.</span><span class="n">py</span></code> implementa essa funcionalidade. As principais mudanças são:</p>
<details class="info">
<summary>Código <code>referencia/jogo_v17.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">  1</a></span>
<span class="normal"><a href="#__codelineno-23-2">  2</a></span>
<span class="normal"><a href="#__codelineno-23-3">  3</a></span>
<span class="normal"><a href="#__codelineno-23-4">  4</a></span>
<span class="normal"><a href="#__codelineno-23-5">  5</a></span>
<span class="normal"><a href="#__codelineno-23-6">  6</a></span>
<span class="normal"><a href="#__codelineno-23-7">  7</a></span>
<span class="normal"><a href="#__codelineno-23-8">  8</a></span>
<span class="normal"><a href="#__codelineno-23-9">  9</a></span>
<span class="normal"><a href="#__codelineno-23-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-23-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-23-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-23-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-23-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-23-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-23-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-23-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-23-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-23-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-23-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-23-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-23-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-23-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-23-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-23-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-23-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-23-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-23-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-23-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-23-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-23-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-23-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-23-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-23-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-23-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-23-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-23-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-23-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-23-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-23-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-23-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-23-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-23-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-23-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-23-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-23-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-23-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-23-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-23-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-23-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-23-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-23-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-23-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-23-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-23-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-23-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-23-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-23-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-23-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-23-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-23-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-23-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-23-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-23-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-23-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-23-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-23-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-23-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-23-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-23-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-23-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-23-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-23-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-23-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-23-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-23-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-23-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-23-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-23-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-23-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-23-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-23-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-23-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-23-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-23-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-23-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-23-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-23-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-23-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-23-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-23-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-23-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-23-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-23-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-23-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-23-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-23-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-23-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-23-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-23-100">100</a></span>
<span class="normal"><a href="#__codelineno-23-101">101</a></span>
<span class="normal"><a href="#__codelineno-23-102">102</a></span>
<span class="normal"><a href="#__codelineno-23-103">103</a></span>
<span class="normal"><a href="#__codelineno-23-104">104</a></span>
<span class="normal"><a href="#__codelineno-23-105">105</a></span>
<span class="normal"><a href="#__codelineno-23-106">106</a></span>
<span class="normal"><a href="#__codelineno-23-107">107</a></span>
<span class="normal"><a href="#__codelineno-23-108">108</a></span>
<span class="normal"><a href="#__codelineno-23-109">109</a></span>
<span class="normal"><a href="#__codelineno-23-110">110</a></span>
<span class="normal"><a href="#__codelineno-23-111">111</a></span>
<span class="normal"><a href="#__codelineno-23-112">112</a></span>
<span class="normal"><a href="#__codelineno-23-113">113</a></span>
<span class="normal"><a href="#__codelineno-23-114">114</a></span>
<span class="normal"><a href="#__codelineno-23-115">115</a></span>
<span class="normal"><a href="#__codelineno-23-116">116</a></span>
<span class="normal"><a href="#__codelineno-23-117">117</a></span>
<span class="normal"><a href="#__codelineno-23-118">118</a></span>
<span class="normal"><a href="#__codelineno-23-119">119</a></span>
<span class="normal"><a href="#__codelineno-23-120">120</a></span>
<span class="normal"><a href="#__codelineno-23-121">121</a></span>
<span class="normal"><a href="#__codelineno-23-122">122</a></span>
<span class="normal"><a href="#__codelineno-23-123">123</a></span>
<span class="normal"><a href="#__codelineno-23-124">124</a></span>
<span class="normal"><a href="#__codelineno-23-125">125</a></span>
<span class="normal"><a href="#__codelineno-23-126">126</a></span>
<span class="normal"><a href="#__codelineno-23-127">127</a></span>
<span class="normal"><a href="#__codelineno-23-128">128</a></span>
<span class="normal"><a href="#__codelineno-23-129">129</a></span>
<span class="normal"><a href="#__codelineno-23-130">130</a></span>
<span class="normal"><a href="#__codelineno-23-131">131</a></span>
<span class="normal"><a href="#__codelineno-23-132">132</a></span>
<span class="normal"><a href="#__codelineno-23-133">133</a></span>
<span class="normal"><a href="#__codelineno-23-134">134</a></span>
<span class="normal"><a href="#__codelineno-23-135">135</a></span>
<span class="normal"><a href="#__codelineno-23-136">136</a></span>
<span class="normal"><a href="#__codelineno-23-137">137</a></span>
<span class="normal"><a href="#__codelineno-23-138">138</a></span>
<span class="normal"><a href="#__codelineno-23-139">139</a></span>
<span class="normal"><a href="#__codelineno-23-140">140</a></span>
<span class="normal"><a href="#__codelineno-23-141">141</a></span>
<span class="normal"><a href="#__codelineno-23-142">142</a></span>
<span class="normal"><a href="#__codelineno-23-143">143</a></span>
<span class="normal"><a href="#__codelineno-23-144">144</a></span>
<span class="normal"><a href="#__codelineno-23-145">145</a></span>
<span class="normal"><a href="#__codelineno-23-146">146</a></span>
<span class="normal"><a href="#__codelineno-23-147">147</a></span>
<span class="normal"><a href="#__codelineno-23-148">148</a></span>
<span class="normal"><a href="#__codelineno-23-149">149</a></span>
<span class="normal"><a href="#__codelineno-23-150">150</a></span>
<span class="normal"><a href="#__codelineno-23-151">151</a></span>
<span class="normal"><a href="#__codelineno-23-152">152</a></span>
<span class="normal"><a href="#__codelineno-23-153">153</a></span>
<span class="normal"><a href="#__codelineno-23-154">154</a></span>
<span class="normal"><a href="#__codelineno-23-155">155</a></span>
<span class="normal"><a href="#__codelineno-23-156">156</a></span>
<span class="normal"><a href="#__codelineno-23-157">157</a></span>
<span class="normal"><a href="#__codelineno-23-158">158</a></span>
<span class="normal"><a href="#__codelineno-23-159">159</a></span>
<span class="normal"><a href="#__codelineno-23-160">160</a></span>
<span class="normal"><a href="#__codelineno-23-161">161</a></span>
<span class="normal"><a href="#__codelineno-23-162">162</a></span>
<span class="normal"><a href="#__codelineno-23-163">163</a></span>
<span class="normal"><a href="#__codelineno-23-164">164</a></span>
<span class="normal"><a href="#__codelineno-23-165">165</a></span>
<span class="normal"><a href="#__codelineno-23-166">166</a></span>
<span class="normal"><a href="#__codelineno-23-167">167</a></span>
<span class="normal"><a href="#__codelineno-23-168">168</a></span>
<span class="normal"><a href="#__codelineno-23-169">169</a></span>
<span class="normal"><a href="#__codelineno-23-170">170</a></span>
<span class="normal"><a href="#__codelineno-23-171">171</a></span>
<span class="normal"><a href="#__codelineno-23-172">172</a></span>
<span class="normal"><a href="#__codelineno-23-173">173</a></span>
<span class="normal"><a href="#__codelineno-23-174">174</a></span>
<span class="normal"><a href="#__codelineno-23-175">175</a></span>
<span class="normal"><a href="#__codelineno-23-176">176</a></span>
<span class="normal"><a href="#__codelineno-23-177">177</a></span>
<span class="normal"><a href="#__codelineno-23-178">178</a></span>
<span class="normal"><a href="#__codelineno-23-179">179</a></span>
<span class="normal"><a href="#__codelineno-23-180">180</a></span>
<span class="normal"><a href="#__codelineno-23-181">181</a></span>
<span class="normal"><a href="#__codelineno-23-182">182</a></span>
<span class="normal"><a href="#__codelineno-23-183">183</a></span>
<span class="normal"><a href="#__codelineno-23-184">184</a></span>
<span class="normal"><a href="#__codelineno-23-185">185</a></span>
<span class="normal"><a href="#__codelineno-23-186">186</a></span>
<span class="normal"><a href="#__codelineno-23-187">187</a></span>
<span class="normal"><a href="#__codelineno-23-188">188</a></span>
<span class="normal"><a href="#__codelineno-23-189">189</a></span>
<span class="normal"><a href="#__codelineno-23-190">190</a></span>
<span class="normal"><a href="#__codelineno-23-191">191</a></span>
<span class="normal"><a href="#__codelineno-23-192">192</a></span>
<span class="normal"><a href="#__codelineno-23-193">193</a></span>
<span class="normal"><a href="#__codelineno-23-194">194</a></span>
<span class="normal"><a href="#__codelineno-23-195">195</a></span>
<span class="normal"><a href="#__codelineno-23-196">196</a></span>
<span class="normal"><a href="#__codelineno-23-197">197</a></span>
<span class="normal"><a href="#__codelineno-23-198">198</a></span>
<span class="normal"><a href="#__codelineno-23-199">199</a></span>
<span class="normal"><a href="#__codelineno-23-200">200</a></span>
<span class="normal"><a href="#__codelineno-23-201">201</a></span>
<span class="normal"><a href="#__codelineno-23-202">202</a></span>
<span class="normal"><a href="#__codelineno-23-203">203</a></span>
<span class="normal"><a href="#__codelineno-23-204">204</a></span>
<span class="normal"><a href="#__codelineno-23-205">205</a></span>
<span class="normal"><a href="#__codelineno-23-206">206</a></span>
<span class="normal"><a href="#__codelineno-23-207">207</a></span>
<span class="normal"><a href="#__codelineno-23-208">208</a></span>
<span class="normal"><a href="#__codelineno-23-209">209</a></span>
<span class="normal"><a href="#__codelineno-23-210">210</a></span>
<span class="normal"><a href="#__codelineno-23-211">211</a></span>
<span class="normal"><a href="#__codelineno-23-212">212</a></span>
<span class="normal"><a href="#__codelineno-23-213">213</a></span>
<span class="normal"><a href="#__codelineno-23-214">214</a></span>
<span class="normal"><a href="#__codelineno-23-215">215</a></span>
<span class="normal"><a href="#__codelineno-23-216">216</a></span>
<span class="normal"><a href="#__codelineno-23-217">217</a></span>
<span class="normal"><a href="#__codelineno-23-218">218</a></span>
<span class="normal"><a href="#__codelineno-23-219">219</a></span>
<span class="normal"><a href="#__codelineno-23-220">220</a></span>
<span class="normal"><a href="#__codelineno-23-221">221</a></span>
<span class="normal"><a href="#__codelineno-23-222">222</a></span>
<span class="normal"><a href="#__codelineno-23-223">223</a></span>
<span class="normal"><a href="#__codelineno-23-224">224</a></span>
<span class="normal"><a href="#__codelineno-23-225">225</a></span>
<span class="normal"><a href="#__codelineno-23-226">226</a></span>
<span class="normal"><a href="#__codelineno-23-227">227</a></span>
<span class="normal"><a href="#__codelineno-23-228">228</a></span>
<span class="normal"><a href="#__codelineno-23-229">229</a></span>
<span class="normal"><a href="#__codelineno-23-230">230</a></span>
<span class="normal"><a href="#__codelineno-23-231">231</a></span>
<span class="normal"><a href="#__codelineno-23-232">232</a></span>
<span class="normal"><a href="#__codelineno-23-233">233</a></span>
<span class="normal"><a href="#__codelineno-23-234">234</a></span>
<span class="normal"><a href="#__codelineno-23-235">235</a></span>
<span class="normal"><a href="#__codelineno-23-236">236</a></span>
<span class="normal"><a href="#__codelineno-23-237">237</a></span>
<span class="normal"><a href="#__codelineno-23-238">238</a></span>
<span class="normal"><a href="#__codelineno-23-239">239</a></span>
<span class="normal"><a href="#__codelineno-23-240">240</a></span>
<span class="normal"><a href="#__codelineno-23-241">241</a></span>
<span class="normal"><a href="#__codelineno-23-242">242</a></span>
<span class="normal"><a href="#__codelineno-23-243">243</a></span>
<span class="normal"><a href="#__codelineno-23-244">244</a></span>
<span class="normal"><a href="#__codelineno-23-245">245</a></span>
<span class="normal"><a href="#__codelineno-23-246">246</a></span>
<span class="normal"><a href="#__codelineno-23-247">247</a></span>
<span class="normal"><a href="#__codelineno-23-248">248</a></span>
<span class="normal"><a href="#__codelineno-23-249">249</a></span>
<span class="normal"><a href="#__codelineno-23-250">250</a></span>
<span class="normal"><a href="#__codelineno-23-251">251</a></span>
<span class="normal"><a href="#__codelineno-23-252">252</a></span>
<span class="normal"><a href="#__codelineno-23-253">253</a></span>
<span class="normal"><a href="#__codelineno-23-254">254</a></span>
<span class="normal"><a href="#__codelineno-23-255">255</a></span>
<span class="normal"><a href="#__codelineno-23-256">256</a></span>
<span class="normal"><a href="#__codelineno-23-257">257</a></span>
<span class="normal"><a href="#__codelineno-23-258">258</a></span>
<span class="normal"><a href="#__codelineno-23-259">259</a></span>
<span class="normal"><a href="#__codelineno-23-260">260</a></span>
<span class="normal"><a href="#__codelineno-23-261">261</a></span>
<span class="normal"><a href="#__codelineno-23-262">262</a></span>
<span class="normal"><a href="#__codelineno-23-263">263</a></span>
<span class="normal"><a href="#__codelineno-23-264">264</a></span>
<span class="normal"><a href="#__codelineno-23-265">265</a></span>
<span class="normal"><a href="#__codelineno-23-266">266</a></span>
<span class="normal"><a href="#__codelineno-23-267">267</a></span>
<span class="normal"><a href="#__codelineno-23-268">268</a></span>
<span class="normal"><a href="#__codelineno-23-269">269</a></span>
<span class="normal"><a href="#__codelineno-23-270">270</a></span>
<span class="normal"><a href="#__codelineno-23-271">271</a></span>
<span class="normal"><a href="#__codelineno-23-272">272</a></span>
<span class="normal"><a href="#__codelineno-23-273">273</a></span>
<span class="normal"><a href="#__codelineno-23-274">274</a></span>
<span class="normal"><a href="#__codelineno-23-275">275</a></span>
<span class="normal"><a href="#__codelineno-23-276">276</a></span>
<span class="normal"><a href="#__codelineno-23-277">277</a></span>
<span class="normal"><a href="#__codelineno-23-278">278</a></span>
<span class="normal"><a href="#__codelineno-23-279">279</a></span>
<span class="normal"><a href="#__codelineno-23-280">280</a></span>
<span class="normal"><a href="#__codelineno-23-281">281</a></span>
<span class="normal"><a href="#__codelineno-23-282">282</a></span>
<span class="normal"><a href="#__codelineno-23-283">283</a></span>
<span class="normal"><a href="#__codelineno-23-284">284</a></span>
<span class="normal"><a href="#__codelineno-23-285">285</a></span>
<span class="normal"><a href="#__codelineno-23-286">286</a></span>
<span class="normal"><a href="#__codelineno-23-287">287</a></span>
<span class="normal"><a href="#__codelineno-23-288">288</a></span>
<span class="normal"><a href="#__codelineno-23-289">289</a></span>
<span class="normal"><a href="#__codelineno-23-290">290</a></span>
<span class="normal"><a href="#__codelineno-23-291">291</a></span>
<span class="normal"><a href="#__codelineno-23-292">292</a></span>
<span class="normal"><a href="#__codelineno-23-293">293</a></span>
<span class="normal"><a href="#__codelineno-23-294">294</a></span>
<span class="normal"><a href="#__codelineno-23-295">295</a></span>
<span class="normal"><a href="#__codelineno-23-296">296</a></span>
<span class="normal"><a href="#__codelineno-23-297">297</a></span>
<span class="normal"><a href="#__codelineno-23-298">298</a></span>
<span class="normal"><a href="#__codelineno-23-299">299</a></span>
<span class="normal"><a href="#__codelineno-23-300">300</a></span>
<span class="normal"><a href="#__codelineno-23-301">301</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a>
<a id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-23-7" name="__codelineno-23-7"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-23-8" name="__codelineno-23-8"></a>
<a id="__codelineno-23-9" name="__codelineno-23-9"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-23-10" name="__codelineno-23-10"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">480</span>
<a id="__codelineno-23-11" name="__codelineno-23-11"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-23-12" name="__codelineno-23-12"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-23-13" name="__codelineno-23-13"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-23-14" name="__codelineno-23-14"></a>
<a id="__codelineno-23-15" name="__codelineno-23-15"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-23-16" name="__codelineno-23-16"></a><span class="n">METEOR_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-23-17" name="__codelineno-23-17"></a><span class="n">METEOR_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-23-18" name="__codelineno-23-18"></a><span class="n">SHIP_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-23-19" name="__codelineno-23-19"></a><span class="n">SHIP_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-23-20" name="__codelineno-23-20"></a><span class="n">assets</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-23-21" name="__codelineno-23-21"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/starfield.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-23-22" name="__codelineno-23-22"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/meteorBrown_med1.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-23-23" name="__codelineno-23-23"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">],</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-23-24" name="__codelineno-23-24"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/playerShip1_orange.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-23-25" name="__codelineno-23-25"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">],</span> <span class="p">(</span><span class="n">SHIP_WIDTH</span><span class="p">,</span> <span class="n">SHIP_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-23-26" name="__codelineno-23-26"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;bullet_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/laserRed16.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-23-27" name="__codelineno-23-27"></a><span class="n">explosion_anim</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-23-28" name="__codelineno-23-28"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
<a id="__codelineno-23-29" name="__codelineno-23-29"></a>    <span class="c1"># Os arquivos de animação são numerados de 00 a 08</span>
<a id="__codelineno-23-30" name="__codelineno-23-30"></a>    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;assets/img/regularExplosion0</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-23-31" name="__codelineno-23-31"></a>    <span class="n">img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-23-32" name="__codelineno-23-32"></a>    <span class="n">img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
<a id="__codelineno-23-33" name="__codelineno-23-33"></a>    <span class="n">explosion_anim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<a id="__codelineno-23-34" name="__codelineno-23-34"></a><span class="n">assets</span><span class="p">[</span><span class="s2">&quot;explosion_anim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">explosion_anim</span>
<a id="__codelineno-23-35" name="__codelineno-23-35"></a><span class="n">assets</span><span class="p">[</span><span class="s2">&quot;score_font&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="s1">&#39;assets/font/PressStart2P.ttf&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
<a id="__codelineno-23-36" name="__codelineno-23-36"></a>
<a id="__codelineno-23-37" name="__codelineno-23-37"></a><span class="c1"># Carrega os sons do jogo</span>
<a id="__codelineno-23-38" name="__codelineno-23-38"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/snd/tgfcoder-FrozenJam-SeamlessLoop.ogg&#39;</span><span class="p">)</span>
<a id="__codelineno-23-39" name="__codelineno-23-39"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">set_volume</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
<a id="__codelineno-23-40" name="__codelineno-23-40"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;boom_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/expl3.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-23-41" name="__codelineno-23-41"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;destroy_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/expl6.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-23-42" name="__codelineno-23-42"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;pew_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/pew.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-23-43" name="__codelineno-23-43"></a>
<a id="__codelineno-23-44" name="__codelineno-23-44"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-23-45" name="__codelineno-23-45"></a><span class="c1"># Definindo os novos tipos</span>
<a id="__codelineno-23-46" name="__codelineno-23-46"></a><span class="k">class</span> <span class="nc">Ship</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-23-47" name="__codelineno-23-47"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-23-48" name="__codelineno-23-48"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-23-49" name="__codelineno-23-49"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-23-50" name="__codelineno-23-50"></a>
<a id="__codelineno-23-51" name="__codelineno-23-51"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span>
<a id="__codelineno-23-52" name="__codelineno-23-52"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-23-53" name="__codelineno-23-53"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-23-54" name="__codelineno-23-54"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span>
<a id="__codelineno-23-55" name="__codelineno-23-55"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-23-56" name="__codelineno-23-56"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="o">=</span> <span class="n">groups</span>
<a id="__codelineno-23-57" name="__codelineno-23-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assets</span> <span class="o">=</span> <span class="n">assets</span>
<a id="__codelineno-23-58" name="__codelineno-23-58"></a>
<a id="__codelineno-23-59" name="__codelineno-23-59"></a>        <span class="c1"># Só será possível atirar uma vez a cada 500 milissegundos</span>
<a id="__codelineno-23-60" name="__codelineno-23-60"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-23-61" name="__codelineno-23-61"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shoot_ticks</span> <span class="o">=</span> <span class="mi">500</span>
<a id="__codelineno-23-62" name="__codelineno-23-62"></a>
<a id="__codelineno-23-63" name="__codelineno-23-63"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-23-64" name="__codelineno-23-64"></a>        <span class="c1"># Atualização da posição da nave</span>
<a id="__codelineno-23-65" name="__codelineno-23-65"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-23-66" name="__codelineno-23-66"></a>
<a id="__codelineno-23-67" name="__codelineno-23-67"></a>        <span class="c1"># Mantem dentro da tela</span>
<a id="__codelineno-23-68" name="__codelineno-23-68"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-23-69" name="__codelineno-23-69"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">WIDTH</span>
<a id="__codelineno-23-70" name="__codelineno-23-70"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-23-71" name="__codelineno-23-71"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-23-72" name="__codelineno-23-72"></a>
<a id="__codelineno-23-73" name="__codelineno-23-73"></a>    <span class="k">def</span> <span class="nf">shoot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-23-74" name="__codelineno-23-74"></a>        <span class="c1"># Verifica se pode atirar</span>
<a id="__codelineno-23-75" name="__codelineno-23-75"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-23-76" name="__codelineno-23-76"></a>        <span class="c1"># Verifica quantos ticks se passaram desde o último tiro.</span>
<a id="__codelineno-23-77" name="__codelineno-23-77"></a>        <span class="n">elapsed_ticks</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span>
<a id="__codelineno-23-78" name="__codelineno-23-78"></a>
<a id="__codelineno-23-79" name="__codelineno-23-79"></a>        <span class="c1"># Se já pode atirar novamente...</span>
<a id="__codelineno-23-80" name="__codelineno-23-80"></a>        <span class="k">if</span> <span class="n">elapsed_ticks</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">shoot_ticks</span><span class="p">:</span>
<a id="__codelineno-23-81" name="__codelineno-23-81"></a>            <span class="c1"># Marca o tick da nova imagem.</span>
<a id="__codelineno-23-82" name="__codelineno-23-82"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span> <span class="o">=</span> <span class="n">now</span>
<a id="__codelineno-23-83" name="__codelineno-23-83"></a>            <span class="c1"># A nova bala vai ser criada logo acima e no centro horizontal da nave</span>
<a id="__codelineno-23-84" name="__codelineno-23-84"></a>            <span class="n">new_bullet</span> <span class="o">=</span> <span class="n">Bullet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span><span class="p">)</span>
<a id="__codelineno-23-85" name="__codelineno-23-85"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_sprites&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-23-86" name="__codelineno-23-86"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_bullets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-23-87" name="__codelineno-23-87"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;pew_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-23-88" name="__codelineno-23-88"></a>
<a id="__codelineno-23-89" name="__codelineno-23-89"></a><span class="k">class</span> <span class="nc">Meteor</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-23-90" name="__codelineno-23-90"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-23-91" name="__codelineno-23-91"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-23-92" name="__codelineno-23-92"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-23-93" name="__codelineno-23-93"></a>
<a id="__codelineno-23-94" name="__codelineno-23-94"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span>
<a id="__codelineno-23-95" name="__codelineno-23-95"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-23-96" name="__codelineno-23-96"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-23-97" name="__codelineno-23-97"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-23-98" name="__codelineno-23-98"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-23-99" name="__codelineno-23-99"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-23-100" name="__codelineno-23-100"></a>
<a id="__codelineno-23-101" name="__codelineno-23-101"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-23-102" name="__codelineno-23-102"></a>        <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-23-103" name="__codelineno-23-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-23-104" name="__codelineno-23-104"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-23-105" name="__codelineno-23-105"></a>        <span class="c1"># Se o meteoro passar do final da tela, volta para cima e sorteia</span>
<a id="__codelineno-23-106" name="__codelineno-23-106"></a>        <span class="c1"># novas posições e velocidades</span>
<a id="__codelineno-23-107" name="__codelineno-23-107"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-23-108" name="__codelineno-23-108"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-23-109" name="__codelineno-23-109"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-23-110" name="__codelineno-23-110"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-23-111" name="__codelineno-23-111"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-23-112" name="__codelineno-23-112"></a>
<a id="__codelineno-23-113" name="__codelineno-23-113"></a><span class="c1"># Classe Bullet que representa os tiros</span>
<a id="__codelineno-23-114" name="__codelineno-23-114"></a><span class="k">class</span> <span class="nc">Bullet</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-23-115" name="__codelineno-23-115"></a>    <span class="c1"># Construtor da classe.</span>
<a id="__codelineno-23-116" name="__codelineno-23-116"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assets</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">centerx</span><span class="p">):</span>
<a id="__codelineno-23-117" name="__codelineno-23-117"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-23-118" name="__codelineno-23-118"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-23-119" name="__codelineno-23-119"></a>
<a id="__codelineno-23-120" name="__codelineno-23-120"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;bullet_img&#39;</span><span class="p">]</span>
<a id="__codelineno-23-121" name="__codelineno-23-121"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-23-122" name="__codelineno-23-122"></a>
<a id="__codelineno-23-123" name="__codelineno-23-123"></a>        <span class="c1"># Coloca no lugar inicial definido em x, y do constutor</span>
<a id="__codelineno-23-124" name="__codelineno-23-124"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">centerx</span>
<a id="__codelineno-23-125" name="__codelineno-23-125"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">bottom</span>
<a id="__codelineno-23-126" name="__codelineno-23-126"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>  <span class="c1"># Velocidade fixa para cima</span>
<a id="__codelineno-23-127" name="__codelineno-23-127"></a>
<a id="__codelineno-23-128" name="__codelineno-23-128"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-23-129" name="__codelineno-23-129"></a>        <span class="c1"># A bala só se move no eixo y</span>
<a id="__codelineno-23-130" name="__codelineno-23-130"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-23-131" name="__codelineno-23-131"></a>
<a id="__codelineno-23-132" name="__codelineno-23-132"></a>        <span class="c1"># Se o tiro passar do inicio da tela, morre.</span>
<a id="__codelineno-23-133" name="__codelineno-23-133"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-23-134" name="__codelineno-23-134"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-23-135" name="__codelineno-23-135"></a>
<a id="__codelineno-23-136" name="__codelineno-23-136"></a><span class="c1"># Classe que representa uma explosão de meteoro</span>
<a id="__codelineno-23-137" name="__codelineno-23-137"></a><span class="k">class</span> <span class="nc">Explosion</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-23-138" name="__codelineno-23-138"></a>    <span class="c1"># Construtor da classe.</span>
<a id="__codelineno-23-139" name="__codelineno-23-139"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-23-140" name="__codelineno-23-140"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-23-141" name="__codelineno-23-141"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-23-142" name="__codelineno-23-142"></a>
<a id="__codelineno-23-143" name="__codelineno-23-143"></a>        <span class="c1"># Armazena a animação de explosão</span>
<a id="__codelineno-23-144" name="__codelineno-23-144"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;explosion_anim&#39;</span><span class="p">]</span>
<a id="__codelineno-23-145" name="__codelineno-23-145"></a>
<a id="__codelineno-23-146" name="__codelineno-23-146"></a>        <span class="c1"># Inicia o processo de animação colocando a primeira imagem na tela.</span>
<a id="__codelineno-23-147" name="__codelineno-23-147"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Armazena o índice atual na animação</span>
<a id="__codelineno-23-148" name="__codelineno-23-148"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span>  <span class="c1"># Pega a primeira imagem</span>
<a id="__codelineno-23-149" name="__codelineno-23-149"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-23-150" name="__codelineno-23-150"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>  <span class="c1"># Posiciona o centro da imagem</span>
<a id="__codelineno-23-151" name="__codelineno-23-151"></a>
<a id="__codelineno-23-152" name="__codelineno-23-152"></a>        <span class="c1"># Guarda o tick da primeira imagem, ou seja, o momento em que a imagem foi mostrada</span>
<a id="__codelineno-23-153" name="__codelineno-23-153"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-23-154" name="__codelineno-23-154"></a>
<a id="__codelineno-23-155" name="__codelineno-23-155"></a>        <span class="c1"># Controle de ticks de animação: troca de imagem a cada self.frame_ticks milissegundos.</span>
<a id="__codelineno-23-156" name="__codelineno-23-156"></a>        <span class="c1"># Quando pygame.time.get_ticks() - self.last_update &gt; self.frame_ticks a</span>
<a id="__codelineno-23-157" name="__codelineno-23-157"></a>        <span class="c1"># próxima imagem da animação será mostrada</span>
<a id="__codelineno-23-158" name="__codelineno-23-158"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frame_ticks</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-23-159" name="__codelineno-23-159"></a>
<a id="__codelineno-23-160" name="__codelineno-23-160"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-23-161" name="__codelineno-23-161"></a>        <span class="c1"># Verifica o tick atual.</span>
<a id="__codelineno-23-162" name="__codelineno-23-162"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-23-163" name="__codelineno-23-163"></a>        <span class="c1"># Verifica quantos ticks se passaram desde a ultima mudança de frame.</span>
<a id="__codelineno-23-164" name="__codelineno-23-164"></a>        <span class="n">elapsed_ticks</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span>
<a id="__codelineno-23-165" name="__codelineno-23-165"></a>
<a id="__codelineno-23-166" name="__codelineno-23-166"></a>        <span class="c1"># Se já está na hora de mudar de imagem...</span>
<a id="__codelineno-23-167" name="__codelineno-23-167"></a>        <span class="k">if</span> <span class="n">elapsed_ticks</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_ticks</span><span class="p">:</span>
<a id="__codelineno-23-168" name="__codelineno-23-168"></a>            <span class="c1"># Marca o tick da nova imagem.</span>
<a id="__codelineno-23-169" name="__codelineno-23-169"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span> <span class="o">=</span> <span class="n">now</span>
<a id="__codelineno-23-170" name="__codelineno-23-170"></a>
<a id="__codelineno-23-171" name="__codelineno-23-171"></a>            <span class="c1"># Avança um quadro.</span>
<a id="__codelineno-23-172" name="__codelineno-23-172"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-23-173" name="__codelineno-23-173"></a>
<a id="__codelineno-23-174" name="__codelineno-23-174"></a>            <span class="c1"># Verifica se já chegou no final da animação.</span>
<a id="__codelineno-23-175" name="__codelineno-23-175"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">):</span>
<a id="__codelineno-23-176" name="__codelineno-23-176"></a>                <span class="c1"># Se sim, tchau explosão!</span>
<a id="__codelineno-23-177" name="__codelineno-23-177"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-23-178" name="__codelineno-23-178"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-23-179" name="__codelineno-23-179"></a>                <span class="c1"># Se ainda não chegou ao fim da explosão, troca de imagem.</span>
<a id="__codelineno-23-180" name="__codelineno-23-180"></a>                <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span>
<a id="__codelineno-23-181" name="__codelineno-23-181"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span>
<a id="__codelineno-23-182" name="__codelineno-23-182"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-23-183" name="__codelineno-23-183"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
<a id="__codelineno-23-184" name="__codelineno-23-184"></a>
<a id="__codelineno-23-185" name="__codelineno-23-185"></a><span class="c1"># Variável para o ajuste de velocidade</span>
<a id="__codelineno-23-186" name="__codelineno-23-186"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<a id="__codelineno-23-187" name="__codelineno-23-187"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">30</span>
<a id="__codelineno-23-188" name="__codelineno-23-188"></a>
<a id="__codelineno-23-189" name="__codelineno-23-189"></a><span class="c1"># Criando um grupo de meteoros</span>
<a id="__codelineno-23-190" name="__codelineno-23-190"></a><span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-23-191" name="__codelineno-23-191"></a><span class="n">all_meteors</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-23-192" name="__codelineno-23-192"></a><span class="n">all_bullets</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-23-193" name="__codelineno-23-193"></a><span class="n">groups</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-23-194" name="__codelineno-23-194"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_sprites&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_sprites</span>
<a id="__codelineno-23-195" name="__codelineno-23-195"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_meteors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_meteors</span>
<a id="__codelineno-23-196" name="__codelineno-23-196"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_bullets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_bullets</span>
<a id="__codelineno-23-197" name="__codelineno-23-197"></a>
<a id="__codelineno-23-198" name="__codelineno-23-198"></a><span class="c1"># Criando o jogador</span>
<a id="__codelineno-23-199" name="__codelineno-23-199"></a><span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-23-200" name="__codelineno-23-200"></a><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-23-201" name="__codelineno-23-201"></a><span class="c1"># Criando os meteoros</span>
<a id="__codelineno-23-202" name="__codelineno-23-202"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a id="__codelineno-23-203" name="__codelineno-23-203"></a>    <span class="n">meteor</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-23-204" name="__codelineno-23-204"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-23-205" name="__codelineno-23-205"></a>    <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-23-206" name="__codelineno-23-206"></a>
<a id="__codelineno-23-207" name="__codelineno-23-207"></a><span class="n">DONE</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-23-208" name="__codelineno-23-208"></a><span class="n">PLAYING</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-23-209" name="__codelineno-23-209"></a><span class="n">EXPLODING</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-23-210" name="__codelineno-23-210"></a><span class="n">state</span> <span class="o">=</span> <span class="n">PLAYING</span>
<a id="__codelineno-23-211" name="__codelineno-23-211"></a>
<a id="__codelineno-23-212" name="__codelineno-23-212"></a><span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-23-213" name="__codelineno-23-213"></a><span class="n">keys_down</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-23-214" name="__codelineno-23-214"></a>
<a id="__codelineno-23-215" name="__codelineno-23-215"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-23-216" name="__codelineno-23-216"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">loops</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-23-217" name="__codelineno-23-217"></a><span class="k">while</span> <span class="n">state</span> <span class="o">!=</span> <span class="n">DONE</span><span class="p">:</span>
<a id="__codelineno-23-218" name="__codelineno-23-218"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
<a id="__codelineno-23-219" name="__codelineno-23-219"></a>
<a id="__codelineno-23-220" name="__codelineno-23-220"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-23-221" name="__codelineno-23-221"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-23-222" name="__codelineno-23-222"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-23-223" name="__codelineno-23-223"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-23-224" name="__codelineno-23-224"></a>            <span class="n">state</span> <span class="o">=</span> <span class="n">DONE</span>
<a id="__codelineno-23-225" name="__codelineno-23-225"></a>        <span class="c1"># Só verifica o teclado se está no estado de jogo</span>
<a id="__codelineno-23-226" name="__codelineno-23-226"></a>        <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">PLAYING</span><span class="p">:</span>
<a id="__codelineno-23-227" name="__codelineno-23-227"></a>            <span class="c1"># Verifica se apertou alguma tecla.</span>
<a id="__codelineno-23-228" name="__codelineno-23-228"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>
<a id="__codelineno-23-229" name="__codelineno-23-229"></a>                <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-23-230" name="__codelineno-23-230"></a>                <span class="n">keys_down</span><span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-23-231" name="__codelineno-23-231"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-23-232" name="__codelineno-23-232"></a>                    <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-23-233" name="__codelineno-23-233"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-23-234" name="__codelineno-23-234"></a>                    <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-23-235" name="__codelineno-23-235"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_SPACE</span><span class="p">:</span>
<a id="__codelineno-23-236" name="__codelineno-23-236"></a>                    <span class="n">player</span><span class="o">.</span><span class="n">shoot</span><span class="p">()</span>
<a id="__codelineno-23-237" name="__codelineno-23-237"></a>            <span class="c1"># Verifica se soltou alguma tecla.</span>
<a id="__codelineno-23-238" name="__codelineno-23-238"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYUP</span><span class="p">:</span>
<a id="__codelineno-23-239" name="__codelineno-23-239"></a>                <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-23-240" name="__codelineno-23-240"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="ow">in</span> <span class="n">keys_down</span> <span class="ow">and</span> <span class="n">keys_down</span><span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">]:</span>
<a id="__codelineno-23-241" name="__codelineno-23-241"></a>                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-23-242" name="__codelineno-23-242"></a>                        <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-23-243" name="__codelineno-23-243"></a>                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-23-244" name="__codelineno-23-244"></a>                        <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-23-245" name="__codelineno-23-245"></a>
<a id="__codelineno-23-246" name="__codelineno-23-246"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-23-247" name="__codelineno-23-247"></a>    <span class="c1"># Atualizando a posição dos meteoros</span>
<a id="__codelineno-23-248" name="__codelineno-23-248"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-23-249" name="__codelineno-23-249"></a>
<a id="__codelineno-23-250" name="__codelineno-23-250"></a>    <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">PLAYING</span><span class="p">:</span>
<a id="__codelineno-23-251" name="__codelineno-23-251"></a>        <span class="c1"># Verifica se houve colisão entre tiro e meteoro</span>
<a id="__codelineno-23-252" name="__codelineno-23-252"></a>        <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">groupcollide</span><span class="p">(</span><span class="n">all_meteors</span><span class="p">,</span> <span class="n">all_bullets</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-23-253" name="__codelineno-23-253"></a>        <span class="k">for</span> <span class="n">meteor</span> <span class="ow">in</span> <span class="n">hits</span><span class="p">:</span> <span class="c1"># As chaves são os elementos do primeiro grupo (meteoros) que colidiram com alguma bala</span>
<a id="__codelineno-23-254" name="__codelineno-23-254"></a>            <span class="c1"># O meteoro e destruido e precisa ser recriado</span>
<a id="__codelineno-23-255" name="__codelineno-23-255"></a>            <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;destroy_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-23-256" name="__codelineno-23-256"></a>            <span class="n">m</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-23-257" name="__codelineno-23-257"></a>            <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-23-258" name="__codelineno-23-258"></a>            <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-23-259" name="__codelineno-23-259"></a>
<a id="__codelineno-23-260" name="__codelineno-23-260"></a>            <span class="c1"># No lugar do meteoro antigo, adicionar uma explosão.</span>
<a id="__codelineno-23-261" name="__codelineno-23-261"></a>            <span class="n">explosao</span> <span class="o">=</span> <span class="n">Explosion</span><span class="p">(</span><span class="n">meteor</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-23-262" name="__codelineno-23-262"></a>            <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">explosao</span><span class="p">)</span>
<a id="__codelineno-23-263" name="__codelineno-23-263"></a>
<a id="__codelineno-23-264" name="__codelineno-23-264"></a>            <span class="c1"># Ganhou pontos!</span>
<a id="__codelineno-23-265" name="__codelineno-23-265"></a>            <span class="n">score</span> <span class="o">+=</span> <span class="mi">100</span>
<a id="__codelineno-23-266" name="__codelineno-23-266"></a>
<a id="__codelineno-23-267" name="__codelineno-23-267"></a>        <span class="c1"># Verifica se houve colisão entre nave e meteoro</span>
<a id="__codelineno-23-268" name="__codelineno-23-268"></a>        <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">spritecollide</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">all_meteors</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-23-269" name="__codelineno-23-269"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hits</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-23-270" name="__codelineno-23-270"></a>            <span class="c1"># Toca o som da colisão</span>
<a id="__codelineno-23-271" name="__codelineno-23-271"></a>            <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;boom_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-23-272" name="__codelineno-23-272"></a>            <span class="n">player</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-23-273" name="__codelineno-23-273"></a>            <span class="n">explosao</span> <span class="o">=</span> <span class="n">Explosion</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-23-274" name="__codelineno-23-274"></a>            <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">explosao</span><span class="p">)</span>
<a id="__codelineno-23-275" name="__codelineno-23-275"></a>            <span class="n">state</span> <span class="o">=</span> <span class="n">EXPLODING</span>
<a id="__codelineno-23-276" name="__codelineno-23-276"></a>            <span class="n">keys_down</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-23-277" name="__codelineno-23-277"></a>            <span class="n">explosion_tick</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-23-278" name="__codelineno-23-278"></a>            <span class="n">explosion_duration</span> <span class="o">=</span> <span class="n">explosao</span><span class="o">.</span><span class="n">frame_ticks</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">explosao</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">)</span> <span class="o">+</span> <span class="mi">400</span>
<a id="__codelineno-23-279" name="__codelineno-23-279"></a>    <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="n">EXPLODING</span><span class="p">:</span>
<a id="__codelineno-23-280" name="__codelineno-23-280"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-23-281" name="__codelineno-23-281"></a>        <span class="k">if</span> <span class="n">now</span> <span class="o">-</span> <span class="n">explosion_tick</span> <span class="o">&gt;</span> <span class="n">explosion_duration</span><span class="p">:</span>
<a id="__codelineno-23-282" name="__codelineno-23-282"></a>            <span class="n">state</span> <span class="o">=</span> <span class="n">PLAYING</span>
<a id="__codelineno-23-283" name="__codelineno-23-283"></a>            <span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-23-284" name="__codelineno-23-284"></a>            <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-23-285" name="__codelineno-23-285"></a>
<a id="__codelineno-23-286" name="__codelineno-23-286"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-23-287" name="__codelineno-23-287"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-23-288" name="__codelineno-23-288"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-23-289" name="__codelineno-23-289"></a>    <span class="c1"># Desenhando meteoros</span>
<a id="__codelineno-23-290" name="__codelineno-23-290"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-23-291" name="__codelineno-23-291"></a>
<a id="__codelineno-23-292" name="__codelineno-23-292"></a>    <span class="c1"># Desenhando o score</span>
<a id="__codelineno-23-293" name="__codelineno-23-293"></a>    <span class="n">text_surface</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;score_font&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:08d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">score</span><span class="p">),</span> <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-23-294" name="__codelineno-23-294"></a>    <span class="n">text_rect</span> <span class="o">=</span> <span class="n">text_surface</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-23-295" name="__codelineno-23-295"></a>    <span class="n">text_rect</span><span class="o">.</span><span class="n">midtop</span> <span class="o">=</span> <span class="p">(</span><span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-23-296" name="__codelineno-23-296"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">text_surface</span><span class="p">,</span> <span class="n">text_rect</span><span class="p">)</span>
<a id="__codelineno-23-297" name="__codelineno-23-297"></a>
<a id="__codelineno-23-298" name="__codelineno-23-298"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-23-299" name="__codelineno-23-299"></a>
<a id="__codelineno-23-300" name="__codelineno-23-300"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-23-301" name="__codelineno-23-301"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<ul>
<li>Linha 35: carrega a fonte que será utilizada para mostrar o placar;</li>
<li>Linhas 212 e 265: inicializa o placar com <code class="language-python highlight"><span class="mi">0</span></code>. Toda vez que um meteoro explode o jogador ganha 100 pontos;</li>
<li>Linhas 213, 230, 240 e 276: cria um dicionário de teclas que guarda se uma tecla estava pressionada ou não. Quando ocorre um evento de tecla levantada (<code class="language-python highlight"><span class="n">pygame</span><span class="o">.</span><span class="n">KEYUP</span></code>), verifica se essa tecla estava previamente pressionada. Isso é necessário para evitar um problema quando a nave explode enquanto uma tecla está apertada. Nesse caso, quando a nave é recriada e o jogador solta a tecla seria aplicada uma velocidade contrária. Por esse motivo, na linha 276 o dicionário é apagado quando o estado muda para <code class="language-python highlight"><span class="n">EXPLODING</span></code>;</li>
<li>Linhas 282 a 284: resposta do exercício 16;</li>
<li>Linhas 293 a 296: desenha o placar.</li>
</ul>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_17" id="exercise_17_0">
<p class="admonition-title">EXERCÍCIO 17</p>
<form class="exercise-form">
<p>Modifique o <code class="language-python highlight"><span class="n">jogo_v17</span><span class="o">.</span><span class="n">py</span></code> para que o placar seja zerado quando a nave explode.</p>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="sistema-de-vidas">Sistema de vidas</h2>
<p>O <code class="language-python highlight"><span class="n">jogo_v18</span><span class="o">.</span><span class="n">py</span></code> implementa um sistema de vidas. O jogador terá 3 vidas. Depois que morrer 3 vezes o jogo termina. As principais mudanças são:</p>
<details class="info">
<summary>Código <code>referencia/jogo_v18.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">  1</a></span>
<span class="normal"><a href="#__codelineno-24-2">  2</a></span>
<span class="normal"><a href="#__codelineno-24-3">  3</a></span>
<span class="normal"><a href="#__codelineno-24-4">  4</a></span>
<span class="normal"><a href="#__codelineno-24-5">  5</a></span>
<span class="normal"><a href="#__codelineno-24-6">  6</a></span>
<span class="normal"><a href="#__codelineno-24-7">  7</a></span>
<span class="normal"><a href="#__codelineno-24-8">  8</a></span>
<span class="normal"><a href="#__codelineno-24-9">  9</a></span>
<span class="normal"><a href="#__codelineno-24-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-24-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-24-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-24-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-24-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-24-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-24-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-24-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-24-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-24-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-24-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-24-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-24-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-24-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-24-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-24-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-24-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-24-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-24-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-24-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-24-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-24-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-24-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-24-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-24-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-24-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-24-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-24-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-24-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-24-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-24-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-24-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-24-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-24-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-24-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-24-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-24-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-24-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-24-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-24-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-24-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-24-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-24-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-24-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-24-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-24-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-24-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-24-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-24-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-24-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-24-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-24-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-24-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-24-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-24-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-24-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-24-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-24-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-24-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-24-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-24-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-24-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-24-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-24-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-24-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-24-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-24-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-24-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-24-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-24-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-24-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-24-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-24-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-24-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-24-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-24-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-24-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-24-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-24-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-24-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-24-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-24-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-24-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-24-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-24-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-24-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-24-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-24-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-24-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-24-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-24-100">100</a></span>
<span class="normal"><a href="#__codelineno-24-101">101</a></span>
<span class="normal"><a href="#__codelineno-24-102">102</a></span>
<span class="normal"><a href="#__codelineno-24-103">103</a></span>
<span class="normal"><a href="#__codelineno-24-104">104</a></span>
<span class="normal"><a href="#__codelineno-24-105">105</a></span>
<span class="normal"><a href="#__codelineno-24-106">106</a></span>
<span class="normal"><a href="#__codelineno-24-107">107</a></span>
<span class="normal"><a href="#__codelineno-24-108">108</a></span>
<span class="normal"><a href="#__codelineno-24-109">109</a></span>
<span class="normal"><a href="#__codelineno-24-110">110</a></span>
<span class="normal"><a href="#__codelineno-24-111">111</a></span>
<span class="normal"><a href="#__codelineno-24-112">112</a></span>
<span class="normal"><a href="#__codelineno-24-113">113</a></span>
<span class="normal"><a href="#__codelineno-24-114">114</a></span>
<span class="normal"><a href="#__codelineno-24-115">115</a></span>
<span class="normal"><a href="#__codelineno-24-116">116</a></span>
<span class="normal"><a href="#__codelineno-24-117">117</a></span>
<span class="normal"><a href="#__codelineno-24-118">118</a></span>
<span class="normal"><a href="#__codelineno-24-119">119</a></span>
<span class="normal"><a href="#__codelineno-24-120">120</a></span>
<span class="normal"><a href="#__codelineno-24-121">121</a></span>
<span class="normal"><a href="#__codelineno-24-122">122</a></span>
<span class="normal"><a href="#__codelineno-24-123">123</a></span>
<span class="normal"><a href="#__codelineno-24-124">124</a></span>
<span class="normal"><a href="#__codelineno-24-125">125</a></span>
<span class="normal"><a href="#__codelineno-24-126">126</a></span>
<span class="normal"><a href="#__codelineno-24-127">127</a></span>
<span class="normal"><a href="#__codelineno-24-128">128</a></span>
<span class="normal"><a href="#__codelineno-24-129">129</a></span>
<span class="normal"><a href="#__codelineno-24-130">130</a></span>
<span class="normal"><a href="#__codelineno-24-131">131</a></span>
<span class="normal"><a href="#__codelineno-24-132">132</a></span>
<span class="normal"><a href="#__codelineno-24-133">133</a></span>
<span class="normal"><a href="#__codelineno-24-134">134</a></span>
<span class="normal"><a href="#__codelineno-24-135">135</a></span>
<span class="normal"><a href="#__codelineno-24-136">136</a></span>
<span class="normal"><a href="#__codelineno-24-137">137</a></span>
<span class="normal"><a href="#__codelineno-24-138">138</a></span>
<span class="normal"><a href="#__codelineno-24-139">139</a></span>
<span class="normal"><a href="#__codelineno-24-140">140</a></span>
<span class="normal"><a href="#__codelineno-24-141">141</a></span>
<span class="normal"><a href="#__codelineno-24-142">142</a></span>
<span class="normal"><a href="#__codelineno-24-143">143</a></span>
<span class="normal"><a href="#__codelineno-24-144">144</a></span>
<span class="normal"><a href="#__codelineno-24-145">145</a></span>
<span class="normal"><a href="#__codelineno-24-146">146</a></span>
<span class="normal"><a href="#__codelineno-24-147">147</a></span>
<span class="normal"><a href="#__codelineno-24-148">148</a></span>
<span class="normal"><a href="#__codelineno-24-149">149</a></span>
<span class="normal"><a href="#__codelineno-24-150">150</a></span>
<span class="normal"><a href="#__codelineno-24-151">151</a></span>
<span class="normal"><a href="#__codelineno-24-152">152</a></span>
<span class="normal"><a href="#__codelineno-24-153">153</a></span>
<span class="normal"><a href="#__codelineno-24-154">154</a></span>
<span class="normal"><a href="#__codelineno-24-155">155</a></span>
<span class="normal"><a href="#__codelineno-24-156">156</a></span>
<span class="normal"><a href="#__codelineno-24-157">157</a></span>
<span class="normal"><a href="#__codelineno-24-158">158</a></span>
<span class="normal"><a href="#__codelineno-24-159">159</a></span>
<span class="normal"><a href="#__codelineno-24-160">160</a></span>
<span class="normal"><a href="#__codelineno-24-161">161</a></span>
<span class="normal"><a href="#__codelineno-24-162">162</a></span>
<span class="normal"><a href="#__codelineno-24-163">163</a></span>
<span class="normal"><a href="#__codelineno-24-164">164</a></span>
<span class="normal"><a href="#__codelineno-24-165">165</a></span>
<span class="normal"><a href="#__codelineno-24-166">166</a></span>
<span class="normal"><a href="#__codelineno-24-167">167</a></span>
<span class="normal"><a href="#__codelineno-24-168">168</a></span>
<span class="normal"><a href="#__codelineno-24-169">169</a></span>
<span class="normal"><a href="#__codelineno-24-170">170</a></span>
<span class="normal"><a href="#__codelineno-24-171">171</a></span>
<span class="normal"><a href="#__codelineno-24-172">172</a></span>
<span class="normal"><a href="#__codelineno-24-173">173</a></span>
<span class="normal"><a href="#__codelineno-24-174">174</a></span>
<span class="normal"><a href="#__codelineno-24-175">175</a></span>
<span class="normal"><a href="#__codelineno-24-176">176</a></span>
<span class="normal"><a href="#__codelineno-24-177">177</a></span>
<span class="normal"><a href="#__codelineno-24-178">178</a></span>
<span class="normal"><a href="#__codelineno-24-179">179</a></span>
<span class="normal"><a href="#__codelineno-24-180">180</a></span>
<span class="normal"><a href="#__codelineno-24-181">181</a></span>
<span class="normal"><a href="#__codelineno-24-182">182</a></span>
<span class="normal"><a href="#__codelineno-24-183">183</a></span>
<span class="normal"><a href="#__codelineno-24-184">184</a></span>
<span class="normal"><a href="#__codelineno-24-185">185</a></span>
<span class="normal"><a href="#__codelineno-24-186">186</a></span>
<span class="normal"><a href="#__codelineno-24-187">187</a></span>
<span class="normal"><a href="#__codelineno-24-188">188</a></span>
<span class="normal"><a href="#__codelineno-24-189">189</a></span>
<span class="normal"><a href="#__codelineno-24-190">190</a></span>
<span class="normal"><a href="#__codelineno-24-191">191</a></span>
<span class="normal"><a href="#__codelineno-24-192">192</a></span>
<span class="normal"><a href="#__codelineno-24-193">193</a></span>
<span class="normal"><a href="#__codelineno-24-194">194</a></span>
<span class="normal"><a href="#__codelineno-24-195">195</a></span>
<span class="normal"><a href="#__codelineno-24-196">196</a></span>
<span class="normal"><a href="#__codelineno-24-197">197</a></span>
<span class="normal"><a href="#__codelineno-24-198">198</a></span>
<span class="normal"><a href="#__codelineno-24-199">199</a></span>
<span class="normal"><a href="#__codelineno-24-200">200</a></span>
<span class="normal"><a href="#__codelineno-24-201">201</a></span>
<span class="normal"><a href="#__codelineno-24-202">202</a></span>
<span class="normal"><a href="#__codelineno-24-203">203</a></span>
<span class="normal"><a href="#__codelineno-24-204">204</a></span>
<span class="normal"><a href="#__codelineno-24-205">205</a></span>
<span class="normal"><a href="#__codelineno-24-206">206</a></span>
<span class="normal"><a href="#__codelineno-24-207">207</a></span>
<span class="normal"><a href="#__codelineno-24-208">208</a></span>
<span class="normal"><a href="#__codelineno-24-209">209</a></span>
<span class="normal"><a href="#__codelineno-24-210">210</a></span>
<span class="normal"><a href="#__codelineno-24-211">211</a></span>
<span class="normal"><a href="#__codelineno-24-212">212</a></span>
<span class="normal"><a href="#__codelineno-24-213">213</a></span>
<span class="normal"><a href="#__codelineno-24-214">214</a></span>
<span class="normal"><a href="#__codelineno-24-215">215</a></span>
<span class="normal"><a href="#__codelineno-24-216">216</a></span>
<span class="normal"><a href="#__codelineno-24-217">217</a></span>
<span class="normal"><a href="#__codelineno-24-218">218</a></span>
<span class="normal"><a href="#__codelineno-24-219">219</a></span>
<span class="normal"><a href="#__codelineno-24-220">220</a></span>
<span class="normal"><a href="#__codelineno-24-221">221</a></span>
<span class="normal"><a href="#__codelineno-24-222">222</a></span>
<span class="normal"><a href="#__codelineno-24-223">223</a></span>
<span class="normal"><a href="#__codelineno-24-224">224</a></span>
<span class="normal"><a href="#__codelineno-24-225">225</a></span>
<span class="normal"><a href="#__codelineno-24-226">226</a></span>
<span class="normal"><a href="#__codelineno-24-227">227</a></span>
<span class="normal"><a href="#__codelineno-24-228">228</a></span>
<span class="normal"><a href="#__codelineno-24-229">229</a></span>
<span class="normal"><a href="#__codelineno-24-230">230</a></span>
<span class="normal"><a href="#__codelineno-24-231">231</a></span>
<span class="normal"><a href="#__codelineno-24-232">232</a></span>
<span class="normal"><a href="#__codelineno-24-233">233</a></span>
<span class="normal"><a href="#__codelineno-24-234">234</a></span>
<span class="normal"><a href="#__codelineno-24-235">235</a></span>
<span class="normal"><a href="#__codelineno-24-236">236</a></span>
<span class="normal"><a href="#__codelineno-24-237">237</a></span>
<span class="normal"><a href="#__codelineno-24-238">238</a></span>
<span class="normal"><a href="#__codelineno-24-239">239</a></span>
<span class="normal"><a href="#__codelineno-24-240">240</a></span>
<span class="normal"><a href="#__codelineno-24-241">241</a></span>
<span class="normal"><a href="#__codelineno-24-242">242</a></span>
<span class="normal"><a href="#__codelineno-24-243">243</a></span>
<span class="normal"><a href="#__codelineno-24-244">244</a></span>
<span class="normal"><a href="#__codelineno-24-245">245</a></span>
<span class="normal"><a href="#__codelineno-24-246">246</a></span>
<span class="normal"><a href="#__codelineno-24-247">247</a></span>
<span class="normal"><a href="#__codelineno-24-248">248</a></span>
<span class="normal"><a href="#__codelineno-24-249">249</a></span>
<span class="normal"><a href="#__codelineno-24-250">250</a></span>
<span class="normal"><a href="#__codelineno-24-251">251</a></span>
<span class="normal"><a href="#__codelineno-24-252">252</a></span>
<span class="normal"><a href="#__codelineno-24-253">253</a></span>
<span class="normal"><a href="#__codelineno-24-254">254</a></span>
<span class="normal"><a href="#__codelineno-24-255">255</a></span>
<span class="normal"><a href="#__codelineno-24-256">256</a></span>
<span class="normal"><a href="#__codelineno-24-257">257</a></span>
<span class="normal"><a href="#__codelineno-24-258">258</a></span>
<span class="normal"><a href="#__codelineno-24-259">259</a></span>
<span class="normal"><a href="#__codelineno-24-260">260</a></span>
<span class="normal"><a href="#__codelineno-24-261">261</a></span>
<span class="normal"><a href="#__codelineno-24-262">262</a></span>
<span class="normal"><a href="#__codelineno-24-263">263</a></span>
<span class="normal"><a href="#__codelineno-24-264">264</a></span>
<span class="normal"><a href="#__codelineno-24-265">265</a></span>
<span class="normal"><a href="#__codelineno-24-266">266</a></span>
<span class="normal"><a href="#__codelineno-24-267">267</a></span>
<span class="normal"><a href="#__codelineno-24-268">268</a></span>
<span class="normal"><a href="#__codelineno-24-269">269</a></span>
<span class="normal"><a href="#__codelineno-24-270">270</a></span>
<span class="normal"><a href="#__codelineno-24-271">271</a></span>
<span class="normal"><a href="#__codelineno-24-272">272</a></span>
<span class="normal"><a href="#__codelineno-24-273">273</a></span>
<span class="normal"><a href="#__codelineno-24-274">274</a></span>
<span class="normal"><a href="#__codelineno-24-275">275</a></span>
<span class="normal"><a href="#__codelineno-24-276">276</a></span>
<span class="normal"><a href="#__codelineno-24-277">277</a></span>
<span class="normal"><a href="#__codelineno-24-278">278</a></span>
<span class="normal"><a href="#__codelineno-24-279">279</a></span>
<span class="normal"><a href="#__codelineno-24-280">280</a></span>
<span class="normal"><a href="#__codelineno-24-281">281</a></span>
<span class="normal"><a href="#__codelineno-24-282">282</a></span>
<span class="normal"><a href="#__codelineno-24-283">283</a></span>
<span class="normal"><a href="#__codelineno-24-284">284</a></span>
<span class="normal"><a href="#__codelineno-24-285">285</a></span>
<span class="normal"><a href="#__codelineno-24-286">286</a></span>
<span class="normal"><a href="#__codelineno-24-287">287</a></span>
<span class="normal"><a href="#__codelineno-24-288">288</a></span>
<span class="normal"><a href="#__codelineno-24-289">289</a></span>
<span class="normal"><a href="#__codelineno-24-290">290</a></span>
<span class="normal"><a href="#__codelineno-24-291">291</a></span>
<span class="normal"><a href="#__codelineno-24-292">292</a></span>
<span class="normal"><a href="#__codelineno-24-293">293</a></span>
<span class="normal"><a href="#__codelineno-24-294">294</a></span>
<span class="normal"><a href="#__codelineno-24-295">295</a></span>
<span class="normal"><a href="#__codelineno-24-296">296</a></span>
<span class="normal"><a href="#__codelineno-24-297">297</a></span>
<span class="normal"><a href="#__codelineno-24-298">298</a></span>
<span class="normal"><a href="#__codelineno-24-299">299</a></span>
<span class="normal"><a href="#__codelineno-24-300">300</a></span>
<span class="normal"><a href="#__codelineno-24-301">301</a></span>
<span class="normal"><a href="#__codelineno-24-302">302</a></span>
<span class="normal"><a href="#__codelineno-24-303">303</a></span>
<span class="normal"><a href="#__codelineno-24-304">304</a></span>
<span class="normal"><a href="#__codelineno-24-305">305</a></span>
<span class="normal"><a href="#__codelineno-24-306">306</a></span>
<span class="normal"><a href="#__codelineno-24-307">307</a></span>
<span class="normal"><a href="#__codelineno-24-308">308</a></span>
<span class="normal"><a href="#__codelineno-24-309">309</a></span>
<span class="normal"><a href="#__codelineno-24-310">310</a></span>
<span class="normal"><a href="#__codelineno-24-311">311</a></span>
<span class="normal"><a href="#__codelineno-24-312">312</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a>
<a id="__codelineno-24-6" name="__codelineno-24-6"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-24-7" name="__codelineno-24-7"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-24-8" name="__codelineno-24-8"></a>
<a id="__codelineno-24-9" name="__codelineno-24-9"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-24-10" name="__codelineno-24-10"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">480</span>
<a id="__codelineno-24-11" name="__codelineno-24-11"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-24-12" name="__codelineno-24-12"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-24-13" name="__codelineno-24-13"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-24-14" name="__codelineno-24-14"></a>
<a id="__codelineno-24-15" name="__codelineno-24-15"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-24-16" name="__codelineno-24-16"></a><span class="n">METEOR_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-24-17" name="__codelineno-24-17"></a><span class="n">METEOR_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-24-18" name="__codelineno-24-18"></a><span class="n">SHIP_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-24-19" name="__codelineno-24-19"></a><span class="n">SHIP_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-24-20" name="__codelineno-24-20"></a><span class="n">assets</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-24-21" name="__codelineno-24-21"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/starfield.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-24-22" name="__codelineno-24-22"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/meteorBrown_med1.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-24-23" name="__codelineno-24-23"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">],</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-24-24" name="__codelineno-24-24"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/playerShip1_orange.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-24-25" name="__codelineno-24-25"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">],</span> <span class="p">(</span><span class="n">SHIP_WIDTH</span><span class="p">,</span> <span class="n">SHIP_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-24-26" name="__codelineno-24-26"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;bullet_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/laserRed16.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-24-27" name="__codelineno-24-27"></a><span class="n">explosion_anim</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-24-28" name="__codelineno-24-28"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
<a id="__codelineno-24-29" name="__codelineno-24-29"></a>    <span class="c1"># Os arquivos de animação são numerados de 00 a 08</span>
<a id="__codelineno-24-30" name="__codelineno-24-30"></a>    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;assets/img/regularExplosion0</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-24-31" name="__codelineno-24-31"></a>    <span class="n">img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-24-32" name="__codelineno-24-32"></a>    <span class="n">img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
<a id="__codelineno-24-33" name="__codelineno-24-33"></a>    <span class="n">explosion_anim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<a id="__codelineno-24-34" name="__codelineno-24-34"></a><span class="n">assets</span><span class="p">[</span><span class="s2">&quot;explosion_anim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">explosion_anim</span>
<a id="__codelineno-24-35" name="__codelineno-24-35"></a><span class="n">assets</span><span class="p">[</span><span class="s2">&quot;score_font&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="s1">&#39;assets/font/PressStart2P.ttf&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
<a id="__codelineno-24-36" name="__codelineno-24-36"></a>
<a id="__codelineno-24-37" name="__codelineno-24-37"></a><span class="c1"># Carrega os sons do jogo</span>
<a id="__codelineno-24-38" name="__codelineno-24-38"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/snd/tgfcoder-FrozenJam-SeamlessLoop.ogg&#39;</span><span class="p">)</span>
<a id="__codelineno-24-39" name="__codelineno-24-39"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">set_volume</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
<a id="__codelineno-24-40" name="__codelineno-24-40"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;boom_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/expl3.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-24-41" name="__codelineno-24-41"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;destroy_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/expl6.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-24-42" name="__codelineno-24-42"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;pew_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/pew.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-24-43" name="__codelineno-24-43"></a>
<a id="__codelineno-24-44" name="__codelineno-24-44"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-24-45" name="__codelineno-24-45"></a><span class="c1"># Definindo os novos tipos</span>
<a id="__codelineno-24-46" name="__codelineno-24-46"></a><span class="k">class</span> <span class="nc">Ship</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-24-47" name="__codelineno-24-47"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-24-48" name="__codelineno-24-48"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-24-49" name="__codelineno-24-49"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-24-50" name="__codelineno-24-50"></a>
<a id="__codelineno-24-51" name="__codelineno-24-51"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span>
<a id="__codelineno-24-52" name="__codelineno-24-52"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-24-53" name="__codelineno-24-53"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-24-54" name="__codelineno-24-54"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span>
<a id="__codelineno-24-55" name="__codelineno-24-55"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-24-56" name="__codelineno-24-56"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="o">=</span> <span class="n">groups</span>
<a id="__codelineno-24-57" name="__codelineno-24-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assets</span> <span class="o">=</span> <span class="n">assets</span>
<a id="__codelineno-24-58" name="__codelineno-24-58"></a>
<a id="__codelineno-24-59" name="__codelineno-24-59"></a>        <span class="c1"># Só será possível atirar uma vez a cada 500 milissegundos</span>
<a id="__codelineno-24-60" name="__codelineno-24-60"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-24-61" name="__codelineno-24-61"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shoot_ticks</span> <span class="o">=</span> <span class="mi">500</span>
<a id="__codelineno-24-62" name="__codelineno-24-62"></a>
<a id="__codelineno-24-63" name="__codelineno-24-63"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-24-64" name="__codelineno-24-64"></a>        <span class="c1"># Atualização da posição da nave</span>
<a id="__codelineno-24-65" name="__codelineno-24-65"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-24-66" name="__codelineno-24-66"></a>
<a id="__codelineno-24-67" name="__codelineno-24-67"></a>        <span class="c1"># Mantem dentro da tela</span>
<a id="__codelineno-24-68" name="__codelineno-24-68"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-24-69" name="__codelineno-24-69"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">WIDTH</span>
<a id="__codelineno-24-70" name="__codelineno-24-70"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-24-71" name="__codelineno-24-71"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-24-72" name="__codelineno-24-72"></a>
<a id="__codelineno-24-73" name="__codelineno-24-73"></a>    <span class="k">def</span> <span class="nf">shoot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-24-74" name="__codelineno-24-74"></a>        <span class="c1"># Verifica se pode atirar</span>
<a id="__codelineno-24-75" name="__codelineno-24-75"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-24-76" name="__codelineno-24-76"></a>        <span class="c1"># Verifica quantos ticks se passaram desde o último tiro.</span>
<a id="__codelineno-24-77" name="__codelineno-24-77"></a>        <span class="n">elapsed_ticks</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span>
<a id="__codelineno-24-78" name="__codelineno-24-78"></a>
<a id="__codelineno-24-79" name="__codelineno-24-79"></a>        <span class="c1"># Se já pode atirar novamente...</span>
<a id="__codelineno-24-80" name="__codelineno-24-80"></a>        <span class="k">if</span> <span class="n">elapsed_ticks</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">shoot_ticks</span><span class="p">:</span>
<a id="__codelineno-24-81" name="__codelineno-24-81"></a>            <span class="c1"># Marca o tick da nova imagem.</span>
<a id="__codelineno-24-82" name="__codelineno-24-82"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span> <span class="o">=</span> <span class="n">now</span>
<a id="__codelineno-24-83" name="__codelineno-24-83"></a>            <span class="c1"># A nova bala vai ser criada logo acima e no centro horizontal da nave</span>
<a id="__codelineno-24-84" name="__codelineno-24-84"></a>            <span class="n">new_bullet</span> <span class="o">=</span> <span class="n">Bullet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span><span class="p">)</span>
<a id="__codelineno-24-85" name="__codelineno-24-85"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_sprites&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-24-86" name="__codelineno-24-86"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_bullets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-24-87" name="__codelineno-24-87"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;pew_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-24-88" name="__codelineno-24-88"></a>
<a id="__codelineno-24-89" name="__codelineno-24-89"></a><span class="k">class</span> <span class="nc">Meteor</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-24-90" name="__codelineno-24-90"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-24-91" name="__codelineno-24-91"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-24-92" name="__codelineno-24-92"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-24-93" name="__codelineno-24-93"></a>
<a id="__codelineno-24-94" name="__codelineno-24-94"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span>
<a id="__codelineno-24-95" name="__codelineno-24-95"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-24-96" name="__codelineno-24-96"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-24-97" name="__codelineno-24-97"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-24-98" name="__codelineno-24-98"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-24-99" name="__codelineno-24-99"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-24-100" name="__codelineno-24-100"></a>
<a id="__codelineno-24-101" name="__codelineno-24-101"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-24-102" name="__codelineno-24-102"></a>        <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-24-103" name="__codelineno-24-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-24-104" name="__codelineno-24-104"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-24-105" name="__codelineno-24-105"></a>        <span class="c1"># Se o meteoro passar do final da tela, volta para cima e sorteia</span>
<a id="__codelineno-24-106" name="__codelineno-24-106"></a>        <span class="c1"># novas posições e velocidades</span>
<a id="__codelineno-24-107" name="__codelineno-24-107"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-24-108" name="__codelineno-24-108"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-24-109" name="__codelineno-24-109"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-24-110" name="__codelineno-24-110"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-24-111" name="__codelineno-24-111"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-24-112" name="__codelineno-24-112"></a>
<a id="__codelineno-24-113" name="__codelineno-24-113"></a><span class="c1"># Classe Bullet que representa os tiros</span>
<a id="__codelineno-24-114" name="__codelineno-24-114"></a><span class="k">class</span> <span class="nc">Bullet</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-24-115" name="__codelineno-24-115"></a>    <span class="c1"># Construtor da classe.</span>
<a id="__codelineno-24-116" name="__codelineno-24-116"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assets</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">centerx</span><span class="p">):</span>
<a id="__codelineno-24-117" name="__codelineno-24-117"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-24-118" name="__codelineno-24-118"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-24-119" name="__codelineno-24-119"></a>
<a id="__codelineno-24-120" name="__codelineno-24-120"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;bullet_img&#39;</span><span class="p">]</span>
<a id="__codelineno-24-121" name="__codelineno-24-121"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-24-122" name="__codelineno-24-122"></a>
<a id="__codelineno-24-123" name="__codelineno-24-123"></a>        <span class="c1"># Coloca no lugar inicial definido em x, y do constutor</span>
<a id="__codelineno-24-124" name="__codelineno-24-124"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">centerx</span>
<a id="__codelineno-24-125" name="__codelineno-24-125"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">bottom</span>
<a id="__codelineno-24-126" name="__codelineno-24-126"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>  <span class="c1"># Velocidade fixa para cima</span>
<a id="__codelineno-24-127" name="__codelineno-24-127"></a>
<a id="__codelineno-24-128" name="__codelineno-24-128"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-24-129" name="__codelineno-24-129"></a>        <span class="c1"># A bala só se move no eixo y</span>
<a id="__codelineno-24-130" name="__codelineno-24-130"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-24-131" name="__codelineno-24-131"></a>
<a id="__codelineno-24-132" name="__codelineno-24-132"></a>        <span class="c1"># Se o tiro passar do inicio da tela, morre.</span>
<a id="__codelineno-24-133" name="__codelineno-24-133"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-24-134" name="__codelineno-24-134"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-24-135" name="__codelineno-24-135"></a>
<a id="__codelineno-24-136" name="__codelineno-24-136"></a><span class="c1"># Classe que representa uma explosão de meteoro</span>
<a id="__codelineno-24-137" name="__codelineno-24-137"></a><span class="k">class</span> <span class="nc">Explosion</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-24-138" name="__codelineno-24-138"></a>    <span class="c1"># Construtor da classe.</span>
<a id="__codelineno-24-139" name="__codelineno-24-139"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-24-140" name="__codelineno-24-140"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-24-141" name="__codelineno-24-141"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-24-142" name="__codelineno-24-142"></a>
<a id="__codelineno-24-143" name="__codelineno-24-143"></a>        <span class="c1"># Armazena a animação de explosão</span>
<a id="__codelineno-24-144" name="__codelineno-24-144"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;explosion_anim&#39;</span><span class="p">]</span>
<a id="__codelineno-24-145" name="__codelineno-24-145"></a>
<a id="__codelineno-24-146" name="__codelineno-24-146"></a>        <span class="c1"># Inicia o processo de animação colocando a primeira imagem na tela.</span>
<a id="__codelineno-24-147" name="__codelineno-24-147"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Armazena o índice atual na animação</span>
<a id="__codelineno-24-148" name="__codelineno-24-148"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span>  <span class="c1"># Pega a primeira imagem</span>
<a id="__codelineno-24-149" name="__codelineno-24-149"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-24-150" name="__codelineno-24-150"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>  <span class="c1"># Posiciona o centro da imagem</span>
<a id="__codelineno-24-151" name="__codelineno-24-151"></a>
<a id="__codelineno-24-152" name="__codelineno-24-152"></a>        <span class="c1"># Guarda o tick da primeira imagem, ou seja, o momento em que a imagem foi mostrada</span>
<a id="__codelineno-24-153" name="__codelineno-24-153"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-24-154" name="__codelineno-24-154"></a>
<a id="__codelineno-24-155" name="__codelineno-24-155"></a>        <span class="c1"># Controle de ticks de animação: troca de imagem a cada self.frame_ticks milissegundos.</span>
<a id="__codelineno-24-156" name="__codelineno-24-156"></a>        <span class="c1"># Quando pygame.time.get_ticks() - self.last_update &gt; self.frame_ticks a</span>
<a id="__codelineno-24-157" name="__codelineno-24-157"></a>        <span class="c1"># próxima imagem da animação será mostrada</span>
<a id="__codelineno-24-158" name="__codelineno-24-158"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frame_ticks</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-24-159" name="__codelineno-24-159"></a>
<a id="__codelineno-24-160" name="__codelineno-24-160"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-24-161" name="__codelineno-24-161"></a>        <span class="c1"># Verifica o tick atual.</span>
<a id="__codelineno-24-162" name="__codelineno-24-162"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-24-163" name="__codelineno-24-163"></a>        <span class="c1"># Verifica quantos ticks se passaram desde a ultima mudança de frame.</span>
<a id="__codelineno-24-164" name="__codelineno-24-164"></a>        <span class="n">elapsed_ticks</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span>
<a id="__codelineno-24-165" name="__codelineno-24-165"></a>
<a id="__codelineno-24-166" name="__codelineno-24-166"></a>        <span class="c1"># Se já está na hora de mudar de imagem...</span>
<a id="__codelineno-24-167" name="__codelineno-24-167"></a>        <span class="k">if</span> <span class="n">elapsed_ticks</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_ticks</span><span class="p">:</span>
<a id="__codelineno-24-168" name="__codelineno-24-168"></a>            <span class="c1"># Marca o tick da nova imagem.</span>
<a id="__codelineno-24-169" name="__codelineno-24-169"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span> <span class="o">=</span> <span class="n">now</span>
<a id="__codelineno-24-170" name="__codelineno-24-170"></a>
<a id="__codelineno-24-171" name="__codelineno-24-171"></a>            <span class="c1"># Avança um quadro.</span>
<a id="__codelineno-24-172" name="__codelineno-24-172"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-24-173" name="__codelineno-24-173"></a>
<a id="__codelineno-24-174" name="__codelineno-24-174"></a>            <span class="c1"># Verifica se já chegou no final da animação.</span>
<a id="__codelineno-24-175" name="__codelineno-24-175"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">):</span>
<a id="__codelineno-24-176" name="__codelineno-24-176"></a>                <span class="c1"># Se sim, tchau explosão!</span>
<a id="__codelineno-24-177" name="__codelineno-24-177"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-24-178" name="__codelineno-24-178"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-24-179" name="__codelineno-24-179"></a>                <span class="c1"># Se ainda não chegou ao fim da explosão, troca de imagem.</span>
<a id="__codelineno-24-180" name="__codelineno-24-180"></a>                <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span>
<a id="__codelineno-24-181" name="__codelineno-24-181"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span>
<a id="__codelineno-24-182" name="__codelineno-24-182"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-24-183" name="__codelineno-24-183"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
<a id="__codelineno-24-184" name="__codelineno-24-184"></a>
<a id="__codelineno-24-185" name="__codelineno-24-185"></a><span class="c1"># Variável para o ajuste de velocidade</span>
<a id="__codelineno-24-186" name="__codelineno-24-186"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<a id="__codelineno-24-187" name="__codelineno-24-187"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">30</span>
<a id="__codelineno-24-188" name="__codelineno-24-188"></a>
<a id="__codelineno-24-189" name="__codelineno-24-189"></a><span class="c1"># Criando um grupo de meteoros</span>
<a id="__codelineno-24-190" name="__codelineno-24-190"></a><span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-24-191" name="__codelineno-24-191"></a><span class="n">all_meteors</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-24-192" name="__codelineno-24-192"></a><span class="n">all_bullets</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-24-193" name="__codelineno-24-193"></a><span class="n">groups</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-24-194" name="__codelineno-24-194"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_sprites&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_sprites</span>
<a id="__codelineno-24-195" name="__codelineno-24-195"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_meteors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_meteors</span>
<a id="__codelineno-24-196" name="__codelineno-24-196"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_bullets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_bullets</span>
<a id="__codelineno-24-197" name="__codelineno-24-197"></a>
<a id="__codelineno-24-198" name="__codelineno-24-198"></a><span class="c1"># Criando o jogador</span>
<a id="__codelineno-24-199" name="__codelineno-24-199"></a><span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-24-200" name="__codelineno-24-200"></a><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-24-201" name="__codelineno-24-201"></a><span class="c1"># Criando os meteoros</span>
<a id="__codelineno-24-202" name="__codelineno-24-202"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a id="__codelineno-24-203" name="__codelineno-24-203"></a>    <span class="n">meteor</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-24-204" name="__codelineno-24-204"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-24-205" name="__codelineno-24-205"></a>    <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-24-206" name="__codelineno-24-206"></a>
<a id="__codelineno-24-207" name="__codelineno-24-207"></a><span class="n">DONE</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-24-208" name="__codelineno-24-208"></a><span class="n">PLAYING</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-24-209" name="__codelineno-24-209"></a><span class="n">EXPLODING</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-24-210" name="__codelineno-24-210"></a><span class="n">state</span> <span class="o">=</span> <span class="n">PLAYING</span>
<a id="__codelineno-24-211" name="__codelineno-24-211"></a>
<a id="__codelineno-24-212" name="__codelineno-24-212"></a><span class="n">keys_down</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-24-213" name="__codelineno-24-213"></a><span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-24-214" name="__codelineno-24-214"></a><span class="n">lives</span> <span class="o">=</span> <span class="mi">3</span>
<a id="__codelineno-24-215" name="__codelineno-24-215"></a>
<a id="__codelineno-24-216" name="__codelineno-24-216"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-24-217" name="__codelineno-24-217"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">loops</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-24-218" name="__codelineno-24-218"></a><span class="k">while</span> <span class="n">state</span> <span class="o">!=</span> <span class="n">DONE</span><span class="p">:</span>
<a id="__codelineno-24-219" name="__codelineno-24-219"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
<a id="__codelineno-24-220" name="__codelineno-24-220"></a>
<a id="__codelineno-24-221" name="__codelineno-24-221"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-24-222" name="__codelineno-24-222"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-24-223" name="__codelineno-24-223"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-24-224" name="__codelineno-24-224"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-24-225" name="__codelineno-24-225"></a>            <span class="n">state</span> <span class="o">=</span> <span class="n">DONE</span>
<a id="__codelineno-24-226" name="__codelineno-24-226"></a>        <span class="c1"># Só verifica o teclado se está no estado de jogo</span>
<a id="__codelineno-24-227" name="__codelineno-24-227"></a>        <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">PLAYING</span><span class="p">:</span>
<a id="__codelineno-24-228" name="__codelineno-24-228"></a>            <span class="c1"># Verifica se apertou alguma tecla.</span>
<a id="__codelineno-24-229" name="__codelineno-24-229"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>
<a id="__codelineno-24-230" name="__codelineno-24-230"></a>                <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-24-231" name="__codelineno-24-231"></a>                <span class="n">keys_down</span><span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-24-232" name="__codelineno-24-232"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-24-233" name="__codelineno-24-233"></a>                    <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-24-234" name="__codelineno-24-234"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-24-235" name="__codelineno-24-235"></a>                    <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-24-236" name="__codelineno-24-236"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_SPACE</span><span class="p">:</span>
<a id="__codelineno-24-237" name="__codelineno-24-237"></a>                    <span class="n">player</span><span class="o">.</span><span class="n">shoot</span><span class="p">()</span>
<a id="__codelineno-24-238" name="__codelineno-24-238"></a>            <span class="c1"># Verifica se soltou alguma tecla.</span>
<a id="__codelineno-24-239" name="__codelineno-24-239"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYUP</span><span class="p">:</span>
<a id="__codelineno-24-240" name="__codelineno-24-240"></a>                <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-24-241" name="__codelineno-24-241"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="ow">in</span> <span class="n">keys_down</span> <span class="ow">and</span> <span class="n">keys_down</span><span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">]:</span>
<a id="__codelineno-24-242" name="__codelineno-24-242"></a>                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-24-243" name="__codelineno-24-243"></a>                        <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-24-244" name="__codelineno-24-244"></a>                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-24-245" name="__codelineno-24-245"></a>                        <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-24-246" name="__codelineno-24-246"></a>
<a id="__codelineno-24-247" name="__codelineno-24-247"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-24-248" name="__codelineno-24-248"></a>    <span class="c1"># Atualizando a posição dos meteoros</span>
<a id="__codelineno-24-249" name="__codelineno-24-249"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-24-250" name="__codelineno-24-250"></a>
<a id="__codelineno-24-251" name="__codelineno-24-251"></a>    <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">PLAYING</span><span class="p">:</span>
<a id="__codelineno-24-252" name="__codelineno-24-252"></a>        <span class="c1"># Verifica se houve colisão entre tiro e meteoro</span>
<a id="__codelineno-24-253" name="__codelineno-24-253"></a>        <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">groupcollide</span><span class="p">(</span><span class="n">all_meteors</span><span class="p">,</span> <span class="n">all_bullets</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-24-254" name="__codelineno-24-254"></a>        <span class="k">for</span> <span class="n">meteor</span> <span class="ow">in</span> <span class="n">hits</span><span class="p">:</span> <span class="c1"># As chaves são os elementos do primeiro grupo (meteoros) que colidiram com alguma bala</span>
<a id="__codelineno-24-255" name="__codelineno-24-255"></a>            <span class="c1"># O meteoro e destruido e precisa ser recriado</span>
<a id="__codelineno-24-256" name="__codelineno-24-256"></a>            <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;destroy_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-24-257" name="__codelineno-24-257"></a>            <span class="n">m</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-24-258" name="__codelineno-24-258"></a>            <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-24-259" name="__codelineno-24-259"></a>            <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-24-260" name="__codelineno-24-260"></a>
<a id="__codelineno-24-261" name="__codelineno-24-261"></a>            <span class="c1"># No lugar do meteoro antigo, adicionar uma explosão.</span>
<a id="__codelineno-24-262" name="__codelineno-24-262"></a>            <span class="n">explosao</span> <span class="o">=</span> <span class="n">Explosion</span><span class="p">(</span><span class="n">meteor</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-24-263" name="__codelineno-24-263"></a>            <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">explosao</span><span class="p">)</span>
<a id="__codelineno-24-264" name="__codelineno-24-264"></a>
<a id="__codelineno-24-265" name="__codelineno-24-265"></a>            <span class="c1"># Ganhou pontos!</span>
<a id="__codelineno-24-266" name="__codelineno-24-266"></a>            <span class="n">score</span> <span class="o">+=</span> <span class="mi">100</span>
<a id="__codelineno-24-267" name="__codelineno-24-267"></a>
<a id="__codelineno-24-268" name="__codelineno-24-268"></a>        <span class="c1"># Verifica se houve colisão entre nave e meteoro</span>
<a id="__codelineno-24-269" name="__codelineno-24-269"></a>        <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">spritecollide</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">all_meteors</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-24-270" name="__codelineno-24-270"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hits</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-24-271" name="__codelineno-24-271"></a>            <span class="c1"># Toca o som da colisão</span>
<a id="__codelineno-24-272" name="__codelineno-24-272"></a>            <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;boom_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-24-273" name="__codelineno-24-273"></a>            <span class="n">player</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-24-274" name="__codelineno-24-274"></a>            <span class="n">lives</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-24-275" name="__codelineno-24-275"></a>            <span class="n">explosao</span> <span class="o">=</span> <span class="n">Explosion</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-24-276" name="__codelineno-24-276"></a>            <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">explosao</span><span class="p">)</span>
<a id="__codelineno-24-277" name="__codelineno-24-277"></a>            <span class="n">state</span> <span class="o">=</span> <span class="n">EXPLODING</span>
<a id="__codelineno-24-278" name="__codelineno-24-278"></a>            <span class="n">keys_down</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-24-279" name="__codelineno-24-279"></a>            <span class="n">explosion_tick</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-24-280" name="__codelineno-24-280"></a>            <span class="n">explosion_duration</span> <span class="o">=</span> <span class="n">explosao</span><span class="o">.</span><span class="n">frame_ticks</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">explosao</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">)</span> <span class="o">+</span> <span class="mi">400</span>
<a id="__codelineno-24-281" name="__codelineno-24-281"></a>    <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="n">EXPLODING</span><span class="p">:</span>
<a id="__codelineno-24-282" name="__codelineno-24-282"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-24-283" name="__codelineno-24-283"></a>        <span class="k">if</span> <span class="n">now</span> <span class="o">-</span> <span class="n">explosion_tick</span> <span class="o">&gt;</span> <span class="n">explosion_duration</span><span class="p">:</span>
<a id="__codelineno-24-284" name="__codelineno-24-284"></a>            <span class="k">if</span> <span class="n">lives</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-24-285" name="__codelineno-24-285"></a>                <span class="n">state</span> <span class="o">=</span> <span class="n">DONE</span>
<a id="__codelineno-24-286" name="__codelineno-24-286"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-24-287" name="__codelineno-24-287"></a>                <span class="n">state</span> <span class="o">=</span> <span class="n">PLAYING</span>
<a id="__codelineno-24-288" name="__codelineno-24-288"></a>                <span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-24-289" name="__codelineno-24-289"></a>                <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-24-290" name="__codelineno-24-290"></a>
<a id="__codelineno-24-291" name="__codelineno-24-291"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-24-292" name="__codelineno-24-292"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-24-293" name="__codelineno-24-293"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-24-294" name="__codelineno-24-294"></a>    <span class="c1"># Desenhando meteoros</span>
<a id="__codelineno-24-295" name="__codelineno-24-295"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-24-296" name="__codelineno-24-296"></a>
<a id="__codelineno-24-297" name="__codelineno-24-297"></a>    <span class="c1"># Desenhando o score</span>
<a id="__codelineno-24-298" name="__codelineno-24-298"></a>    <span class="n">text_surface</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;score_font&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:08d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">score</span><span class="p">),</span> <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-24-299" name="__codelineno-24-299"></a>    <span class="n">text_rect</span> <span class="o">=</span> <span class="n">text_surface</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-24-300" name="__codelineno-24-300"></a>    <span class="n">text_rect</span><span class="o">.</span><span class="n">midtop</span> <span class="o">=</span> <span class="p">(</span><span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-24-301" name="__codelineno-24-301"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">text_surface</span><span class="p">,</span> <span class="n">text_rect</span><span class="p">)</span>
<a id="__codelineno-24-302" name="__codelineno-24-302"></a>
<a id="__codelineno-24-303" name="__codelineno-24-303"></a>    <span class="c1"># Desenhando as vidas</span>
<a id="__codelineno-24-304" name="__codelineno-24-304"></a>    <span class="n">text_surface</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;score_font&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="mi">9829</span><span class="p">)</span> <span class="o">*</span> <span class="n">lives</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-24-305" name="__codelineno-24-305"></a>    <span class="n">text_rect</span> <span class="o">=</span> <span class="n">text_surface</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-24-306" name="__codelineno-24-306"></a>    <span class="n">text_rect</span><span class="o">.</span><span class="n">bottomleft</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-24-307" name="__codelineno-24-307"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">text_surface</span><span class="p">,</span> <span class="n">text_rect</span><span class="p">)</span>
<a id="__codelineno-24-308" name="__codelineno-24-308"></a>
<a id="__codelineno-24-309" name="__codelineno-24-309"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-24-310" name="__codelineno-24-310"></a>
<a id="__codelineno-24-311" name="__codelineno-24-311"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-24-312" name="__codelineno-24-312"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<ul>
<li>Linhas 214 e 274: inicializa o número de vidas com 3 e diminui toda vez que a nave explode;</li>
<li>Linhas 284 a 286: se a quantidade de vidas chegar a zero o jogo termina;</li>
<li>Linhas 304 a 307: desenha as vidas.</li>
</ul>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_18" id="exercise_18_0">
<p class="admonition-title">EXERCÍCIO 18</p>
<form class="exercise-form">
<p>Modifique o <code class="language-python highlight"><span class="n">jogo_v18</span><span class="o">.</span><span class="n">py</span></code> para que o jogador ganhe automaticamente uma vida a cada 1.000 pontos. A resposta estará no <code class="language-python highlight"><span class="n">jogo_v19</span><span class="o">.</span><span class="n">py</span></code>.</p>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h2 id="melhorando-a-colisao">Melhorando a colisão</h2>
<p>Talvez você tenha percebido que a colisão entre sprites nem sempre é muito boa. Isso acontece porque as colisões são feitas por padrão entre as imagens, ou seja, entre os retângulos (mesmo que sejam transparentes). O <code class="language-python highlight"><span class="n">jogo_v19</span><span class="o">.</span><span class="n">py</span></code> utiliza uma função mais precisa de colisão. Para isso é necessário criar máscaras de colisão. Uma máscara de colisão é uma imagem na qual os valores iguais a zero serão ignorados no teste de colisão. Para utilizar a colisão entre máscaras é necessário que o sprite possua um atributo <code class="language-python highlight"><span class="n">mask</span></code>. As principais mudanças são:</p>
<details class="info">
<summary>Código <code>referencia/jogo_v19.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">  1</a></span>
<span class="normal"><a href="#__codelineno-25-2">  2</a></span>
<span class="normal"><a href="#__codelineno-25-3">  3</a></span>
<span class="normal"><a href="#__codelineno-25-4">  4</a></span>
<span class="normal"><a href="#__codelineno-25-5">  5</a></span>
<span class="normal"><a href="#__codelineno-25-6">  6</a></span>
<span class="normal"><a href="#__codelineno-25-7">  7</a></span>
<span class="normal"><a href="#__codelineno-25-8">  8</a></span>
<span class="normal"><a href="#__codelineno-25-9">  9</a></span>
<span class="normal"><a href="#__codelineno-25-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-25-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-25-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-25-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-25-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-25-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-25-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-25-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-25-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-25-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-25-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-25-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-25-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-25-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-25-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-25-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-25-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-25-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-25-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-25-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-25-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-25-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-25-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-25-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-25-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-25-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-25-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-25-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-25-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-25-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-25-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-25-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-25-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-25-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-25-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-25-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-25-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-25-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-25-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-25-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-25-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-25-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-25-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-25-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-25-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-25-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-25-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-25-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-25-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-25-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-25-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-25-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-25-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-25-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-25-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-25-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-25-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-25-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-25-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-25-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-25-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-25-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-25-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-25-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-25-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-25-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-25-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-25-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-25-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-25-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-25-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-25-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-25-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-25-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-25-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-25-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-25-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-25-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-25-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-25-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-25-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-25-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-25-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-25-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-25-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-25-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-25-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-25-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-25-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-25-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-25-100">100</a></span>
<span class="normal"><a href="#__codelineno-25-101">101</a></span>
<span class="normal"><a href="#__codelineno-25-102">102</a></span>
<span class="normal"><a href="#__codelineno-25-103">103</a></span>
<span class="normal"><a href="#__codelineno-25-104">104</a></span>
<span class="normal"><a href="#__codelineno-25-105">105</a></span>
<span class="normal"><a href="#__codelineno-25-106">106</a></span>
<span class="normal"><a href="#__codelineno-25-107">107</a></span>
<span class="normal"><a href="#__codelineno-25-108">108</a></span>
<span class="normal"><a href="#__codelineno-25-109">109</a></span>
<span class="normal"><a href="#__codelineno-25-110">110</a></span>
<span class="normal"><a href="#__codelineno-25-111">111</a></span>
<span class="normal"><a href="#__codelineno-25-112">112</a></span>
<span class="normal"><a href="#__codelineno-25-113">113</a></span>
<span class="normal"><a href="#__codelineno-25-114">114</a></span>
<span class="normal"><a href="#__codelineno-25-115">115</a></span>
<span class="normal"><a href="#__codelineno-25-116">116</a></span>
<span class="normal"><a href="#__codelineno-25-117">117</a></span>
<span class="normal"><a href="#__codelineno-25-118">118</a></span>
<span class="normal"><a href="#__codelineno-25-119">119</a></span>
<span class="normal"><a href="#__codelineno-25-120">120</a></span>
<span class="normal"><a href="#__codelineno-25-121">121</a></span>
<span class="normal"><a href="#__codelineno-25-122">122</a></span>
<span class="normal"><a href="#__codelineno-25-123">123</a></span>
<span class="normal"><a href="#__codelineno-25-124">124</a></span>
<span class="normal"><a href="#__codelineno-25-125">125</a></span>
<span class="normal"><a href="#__codelineno-25-126">126</a></span>
<span class="normal"><a href="#__codelineno-25-127">127</a></span>
<span class="normal"><a href="#__codelineno-25-128">128</a></span>
<span class="normal"><a href="#__codelineno-25-129">129</a></span>
<span class="normal"><a href="#__codelineno-25-130">130</a></span>
<span class="normal"><a href="#__codelineno-25-131">131</a></span>
<span class="normal"><a href="#__codelineno-25-132">132</a></span>
<span class="normal"><a href="#__codelineno-25-133">133</a></span>
<span class="normal"><a href="#__codelineno-25-134">134</a></span>
<span class="normal"><a href="#__codelineno-25-135">135</a></span>
<span class="normal"><a href="#__codelineno-25-136">136</a></span>
<span class="normal"><a href="#__codelineno-25-137">137</a></span>
<span class="normal"><a href="#__codelineno-25-138">138</a></span>
<span class="normal"><a href="#__codelineno-25-139">139</a></span>
<span class="normal"><a href="#__codelineno-25-140">140</a></span>
<span class="normal"><a href="#__codelineno-25-141">141</a></span>
<span class="normal"><a href="#__codelineno-25-142">142</a></span>
<span class="normal"><a href="#__codelineno-25-143">143</a></span>
<span class="normal"><a href="#__codelineno-25-144">144</a></span>
<span class="normal"><a href="#__codelineno-25-145">145</a></span>
<span class="normal"><a href="#__codelineno-25-146">146</a></span>
<span class="normal"><a href="#__codelineno-25-147">147</a></span>
<span class="normal"><a href="#__codelineno-25-148">148</a></span>
<span class="normal"><a href="#__codelineno-25-149">149</a></span>
<span class="normal"><a href="#__codelineno-25-150">150</a></span>
<span class="normal"><a href="#__codelineno-25-151">151</a></span>
<span class="normal"><a href="#__codelineno-25-152">152</a></span>
<span class="normal"><a href="#__codelineno-25-153">153</a></span>
<span class="normal"><a href="#__codelineno-25-154">154</a></span>
<span class="normal"><a href="#__codelineno-25-155">155</a></span>
<span class="normal"><a href="#__codelineno-25-156">156</a></span>
<span class="normal"><a href="#__codelineno-25-157">157</a></span>
<span class="normal"><a href="#__codelineno-25-158">158</a></span>
<span class="normal"><a href="#__codelineno-25-159">159</a></span>
<span class="normal"><a href="#__codelineno-25-160">160</a></span>
<span class="normal"><a href="#__codelineno-25-161">161</a></span>
<span class="normal"><a href="#__codelineno-25-162">162</a></span>
<span class="normal"><a href="#__codelineno-25-163">163</a></span>
<span class="normal"><a href="#__codelineno-25-164">164</a></span>
<span class="normal"><a href="#__codelineno-25-165">165</a></span>
<span class="normal"><a href="#__codelineno-25-166">166</a></span>
<span class="normal"><a href="#__codelineno-25-167">167</a></span>
<span class="normal"><a href="#__codelineno-25-168">168</a></span>
<span class="normal"><a href="#__codelineno-25-169">169</a></span>
<span class="normal"><a href="#__codelineno-25-170">170</a></span>
<span class="normal"><a href="#__codelineno-25-171">171</a></span>
<span class="normal"><a href="#__codelineno-25-172">172</a></span>
<span class="normal"><a href="#__codelineno-25-173">173</a></span>
<span class="normal"><a href="#__codelineno-25-174">174</a></span>
<span class="normal"><a href="#__codelineno-25-175">175</a></span>
<span class="normal"><a href="#__codelineno-25-176">176</a></span>
<span class="normal"><a href="#__codelineno-25-177">177</a></span>
<span class="normal"><a href="#__codelineno-25-178">178</a></span>
<span class="normal"><a href="#__codelineno-25-179">179</a></span>
<span class="normal"><a href="#__codelineno-25-180">180</a></span>
<span class="normal"><a href="#__codelineno-25-181">181</a></span>
<span class="normal"><a href="#__codelineno-25-182">182</a></span>
<span class="normal"><a href="#__codelineno-25-183">183</a></span>
<span class="normal"><a href="#__codelineno-25-184">184</a></span>
<span class="normal"><a href="#__codelineno-25-185">185</a></span>
<span class="normal"><a href="#__codelineno-25-186">186</a></span>
<span class="normal"><a href="#__codelineno-25-187">187</a></span>
<span class="normal"><a href="#__codelineno-25-188">188</a></span>
<span class="normal"><a href="#__codelineno-25-189">189</a></span>
<span class="normal"><a href="#__codelineno-25-190">190</a></span>
<span class="normal"><a href="#__codelineno-25-191">191</a></span>
<span class="normal"><a href="#__codelineno-25-192">192</a></span>
<span class="normal"><a href="#__codelineno-25-193">193</a></span>
<span class="normal"><a href="#__codelineno-25-194">194</a></span>
<span class="normal"><a href="#__codelineno-25-195">195</a></span>
<span class="normal"><a href="#__codelineno-25-196">196</a></span>
<span class="normal"><a href="#__codelineno-25-197">197</a></span>
<span class="normal"><a href="#__codelineno-25-198">198</a></span>
<span class="normal"><a href="#__codelineno-25-199">199</a></span>
<span class="normal"><a href="#__codelineno-25-200">200</a></span>
<span class="normal"><a href="#__codelineno-25-201">201</a></span>
<span class="normal"><a href="#__codelineno-25-202">202</a></span>
<span class="normal"><a href="#__codelineno-25-203">203</a></span>
<span class="normal"><a href="#__codelineno-25-204">204</a></span>
<span class="normal"><a href="#__codelineno-25-205">205</a></span>
<span class="normal"><a href="#__codelineno-25-206">206</a></span>
<span class="normal"><a href="#__codelineno-25-207">207</a></span>
<span class="normal"><a href="#__codelineno-25-208">208</a></span>
<span class="normal"><a href="#__codelineno-25-209">209</a></span>
<span class="normal"><a href="#__codelineno-25-210">210</a></span>
<span class="normal"><a href="#__codelineno-25-211">211</a></span>
<span class="normal"><a href="#__codelineno-25-212">212</a></span>
<span class="normal"><a href="#__codelineno-25-213">213</a></span>
<span class="normal"><a href="#__codelineno-25-214">214</a></span>
<span class="normal"><a href="#__codelineno-25-215">215</a></span>
<span class="normal"><a href="#__codelineno-25-216">216</a></span>
<span class="normal"><a href="#__codelineno-25-217">217</a></span>
<span class="normal"><a href="#__codelineno-25-218">218</a></span>
<span class="normal"><a href="#__codelineno-25-219">219</a></span>
<span class="normal"><a href="#__codelineno-25-220">220</a></span>
<span class="normal"><a href="#__codelineno-25-221">221</a></span>
<span class="normal"><a href="#__codelineno-25-222">222</a></span>
<span class="normal"><a href="#__codelineno-25-223">223</a></span>
<span class="normal"><a href="#__codelineno-25-224">224</a></span>
<span class="normal"><a href="#__codelineno-25-225">225</a></span>
<span class="normal"><a href="#__codelineno-25-226">226</a></span>
<span class="normal"><a href="#__codelineno-25-227">227</a></span>
<span class="normal"><a href="#__codelineno-25-228">228</a></span>
<span class="normal"><a href="#__codelineno-25-229">229</a></span>
<span class="normal"><a href="#__codelineno-25-230">230</a></span>
<span class="normal"><a href="#__codelineno-25-231">231</a></span>
<span class="normal"><a href="#__codelineno-25-232">232</a></span>
<span class="normal"><a href="#__codelineno-25-233">233</a></span>
<span class="normal"><a href="#__codelineno-25-234">234</a></span>
<span class="normal"><a href="#__codelineno-25-235">235</a></span>
<span class="normal"><a href="#__codelineno-25-236">236</a></span>
<span class="normal"><a href="#__codelineno-25-237">237</a></span>
<span class="normal"><a href="#__codelineno-25-238">238</a></span>
<span class="normal"><a href="#__codelineno-25-239">239</a></span>
<span class="normal"><a href="#__codelineno-25-240">240</a></span>
<span class="normal"><a href="#__codelineno-25-241">241</a></span>
<span class="normal"><a href="#__codelineno-25-242">242</a></span>
<span class="normal"><a href="#__codelineno-25-243">243</a></span>
<span class="normal"><a href="#__codelineno-25-244">244</a></span>
<span class="normal"><a href="#__codelineno-25-245">245</a></span>
<span class="normal"><a href="#__codelineno-25-246">246</a></span>
<span class="normal"><a href="#__codelineno-25-247">247</a></span>
<span class="normal"><a href="#__codelineno-25-248">248</a></span>
<span class="normal"><a href="#__codelineno-25-249">249</a></span>
<span class="normal"><a href="#__codelineno-25-250">250</a></span>
<span class="normal"><a href="#__codelineno-25-251">251</a></span>
<span class="normal"><a href="#__codelineno-25-252">252</a></span>
<span class="normal"><a href="#__codelineno-25-253">253</a></span>
<span class="normal"><a href="#__codelineno-25-254">254</a></span>
<span class="normal"><a href="#__codelineno-25-255">255</a></span>
<span class="normal"><a href="#__codelineno-25-256">256</a></span>
<span class="normal"><a href="#__codelineno-25-257">257</a></span>
<span class="normal"><a href="#__codelineno-25-258">258</a></span>
<span class="normal"><a href="#__codelineno-25-259">259</a></span>
<span class="normal"><a href="#__codelineno-25-260">260</a></span>
<span class="normal"><a href="#__codelineno-25-261">261</a></span>
<span class="normal"><a href="#__codelineno-25-262">262</a></span>
<span class="normal"><a href="#__codelineno-25-263">263</a></span>
<span class="normal"><a href="#__codelineno-25-264">264</a></span>
<span class="normal"><a href="#__codelineno-25-265">265</a></span>
<span class="normal"><a href="#__codelineno-25-266">266</a></span>
<span class="normal"><a href="#__codelineno-25-267">267</a></span>
<span class="normal"><a href="#__codelineno-25-268">268</a></span>
<span class="normal"><a href="#__codelineno-25-269">269</a></span>
<span class="normal"><a href="#__codelineno-25-270">270</a></span>
<span class="normal"><a href="#__codelineno-25-271">271</a></span>
<span class="normal"><a href="#__codelineno-25-272">272</a></span>
<span class="normal"><a href="#__codelineno-25-273">273</a></span>
<span class="normal"><a href="#__codelineno-25-274">274</a></span>
<span class="normal"><a href="#__codelineno-25-275">275</a></span>
<span class="normal"><a href="#__codelineno-25-276">276</a></span>
<span class="normal"><a href="#__codelineno-25-277">277</a></span>
<span class="normal"><a href="#__codelineno-25-278">278</a></span>
<span class="normal"><a href="#__codelineno-25-279">279</a></span>
<span class="normal"><a href="#__codelineno-25-280">280</a></span>
<span class="normal"><a href="#__codelineno-25-281">281</a></span>
<span class="normal"><a href="#__codelineno-25-282">282</a></span>
<span class="normal"><a href="#__codelineno-25-283">283</a></span>
<span class="normal"><a href="#__codelineno-25-284">284</a></span>
<span class="normal"><a href="#__codelineno-25-285">285</a></span>
<span class="normal"><a href="#__codelineno-25-286">286</a></span>
<span class="normal"><a href="#__codelineno-25-287">287</a></span>
<span class="normal"><a href="#__codelineno-25-288">288</a></span>
<span class="normal"><a href="#__codelineno-25-289">289</a></span>
<span class="normal"><a href="#__codelineno-25-290">290</a></span>
<span class="normal"><a href="#__codelineno-25-291">291</a></span>
<span class="normal"><a href="#__codelineno-25-292">292</a></span>
<span class="normal"><a href="#__codelineno-25-293">293</a></span>
<span class="normal"><a href="#__codelineno-25-294">294</a></span>
<span class="normal"><a href="#__codelineno-25-295">295</a></span>
<span class="normal"><a href="#__codelineno-25-296">296</a></span>
<span class="normal"><a href="#__codelineno-25-297">297</a></span>
<span class="normal"><a href="#__codelineno-25-298">298</a></span>
<span class="normal"><a href="#__codelineno-25-299">299</a></span>
<span class="normal"><a href="#__codelineno-25-300">300</a></span>
<span class="normal"><a href="#__codelineno-25-301">301</a></span>
<span class="normal"><a href="#__codelineno-25-302">302</a></span>
<span class="normal"><a href="#__codelineno-25-303">303</a></span>
<span class="normal"><a href="#__codelineno-25-304">304</a></span>
<span class="normal"><a href="#__codelineno-25-305">305</a></span>
<span class="normal"><a href="#__codelineno-25-306">306</a></span>
<span class="normal"><a href="#__codelineno-25-307">307</a></span>
<span class="normal"><a href="#__codelineno-25-308">308</a></span>
<span class="normal"><a href="#__codelineno-25-309">309</a></span>
<span class="normal"><a href="#__codelineno-25-310">310</a></span>
<span class="normal"><a href="#__codelineno-25-311">311</a></span>
<span class="normal"><a href="#__codelineno-25-312">312</a></span>
<span class="normal"><a href="#__codelineno-25-313">313</a></span>
<span class="normal"><a href="#__codelineno-25-314">314</a></span>
<span class="normal"><a href="#__codelineno-25-315">315</a></span>
<span class="normal"><a href="#__codelineno-25-316">316</a></span>
<span class="normal"><a href="#__codelineno-25-317">317</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-25-2" name="__codelineno-25-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-25-4" name="__codelineno-25-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-25-5" name="__codelineno-25-5"></a>
<a id="__codelineno-25-6" name="__codelineno-25-6"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-25-7" name="__codelineno-25-7"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-25-8" name="__codelineno-25-8"></a>
<a id="__codelineno-25-9" name="__codelineno-25-9"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-25-10" name="__codelineno-25-10"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">480</span>
<a id="__codelineno-25-11" name="__codelineno-25-11"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-25-12" name="__codelineno-25-12"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-25-13" name="__codelineno-25-13"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-25-14" name="__codelineno-25-14"></a>
<a id="__codelineno-25-15" name="__codelineno-25-15"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-25-16" name="__codelineno-25-16"></a><span class="n">METEOR_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-25-17" name="__codelineno-25-17"></a><span class="n">METEOR_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-25-18" name="__codelineno-25-18"></a><span class="n">SHIP_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-25-19" name="__codelineno-25-19"></a><span class="n">SHIP_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-25-20" name="__codelineno-25-20"></a><span class="n">assets</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-25-21" name="__codelineno-25-21"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/starfield.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-25-22" name="__codelineno-25-22"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/meteorBrown_med1.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-25-23" name="__codelineno-25-23"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">],</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-25-24" name="__codelineno-25-24"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/playerShip1_orange.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-25-25" name="__codelineno-25-25"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">],</span> <span class="p">(</span><span class="n">SHIP_WIDTH</span><span class="p">,</span> <span class="n">SHIP_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-25-26" name="__codelineno-25-26"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;bullet_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/laserRed16.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-25-27" name="__codelineno-25-27"></a><span class="n">explosion_anim</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-25-28" name="__codelineno-25-28"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
<a id="__codelineno-25-29" name="__codelineno-25-29"></a>    <span class="c1"># Os arquivos de animação são numerados de 00 a 08</span>
<a id="__codelineno-25-30" name="__codelineno-25-30"></a>    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;assets/img/regularExplosion0</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-25-31" name="__codelineno-25-31"></a>    <span class="n">img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-25-32" name="__codelineno-25-32"></a>    <span class="n">img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
<a id="__codelineno-25-33" name="__codelineno-25-33"></a>    <span class="n">explosion_anim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<a id="__codelineno-25-34" name="__codelineno-25-34"></a><span class="n">assets</span><span class="p">[</span><span class="s2">&quot;explosion_anim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">explosion_anim</span>
<a id="__codelineno-25-35" name="__codelineno-25-35"></a><span class="n">assets</span><span class="p">[</span><span class="s2">&quot;score_font&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="s1">&#39;assets/font/PressStart2P.ttf&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
<a id="__codelineno-25-36" name="__codelineno-25-36"></a>
<a id="__codelineno-25-37" name="__codelineno-25-37"></a><span class="c1"># Carrega os sons do jogo</span>
<a id="__codelineno-25-38" name="__codelineno-25-38"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/snd/tgfcoder-FrozenJam-SeamlessLoop.ogg&#39;</span><span class="p">)</span>
<a id="__codelineno-25-39" name="__codelineno-25-39"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">set_volume</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
<a id="__codelineno-25-40" name="__codelineno-25-40"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;boom_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/expl3.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-25-41" name="__codelineno-25-41"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;destroy_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/expl6.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-25-42" name="__codelineno-25-42"></a><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;pew_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/pew.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-25-43" name="__codelineno-25-43"></a>
<a id="__codelineno-25-44" name="__codelineno-25-44"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-25-45" name="__codelineno-25-45"></a><span class="c1"># Definindo os novos tipos</span>
<a id="__codelineno-25-46" name="__codelineno-25-46"></a><span class="k">class</span> <span class="nc">Ship</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-25-47" name="__codelineno-25-47"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-25-48" name="__codelineno-25-48"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-25-49" name="__codelineno-25-49"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-25-50" name="__codelineno-25-50"></a>
<a id="__codelineno-25-51" name="__codelineno-25-51"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span>
<a id="__codelineno-25-52" name="__codelineno-25-52"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">from_surface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
<a id="__codelineno-25-53" name="__codelineno-25-53"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-25-54" name="__codelineno-25-54"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-25-55" name="__codelineno-25-55"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span>
<a id="__codelineno-25-56" name="__codelineno-25-56"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-25-57" name="__codelineno-25-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="o">=</span> <span class="n">groups</span>
<a id="__codelineno-25-58" name="__codelineno-25-58"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assets</span> <span class="o">=</span> <span class="n">assets</span>
<a id="__codelineno-25-59" name="__codelineno-25-59"></a>
<a id="__codelineno-25-60" name="__codelineno-25-60"></a>        <span class="c1"># Só será possível atirar uma vez a cada 500 milissegundos</span>
<a id="__codelineno-25-61" name="__codelineno-25-61"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-25-62" name="__codelineno-25-62"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shoot_ticks</span> <span class="o">=</span> <span class="mi">500</span>
<a id="__codelineno-25-63" name="__codelineno-25-63"></a>
<a id="__codelineno-25-64" name="__codelineno-25-64"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-25-65" name="__codelineno-25-65"></a>        <span class="c1"># Atualização da posição da nave</span>
<a id="__codelineno-25-66" name="__codelineno-25-66"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-25-67" name="__codelineno-25-67"></a>
<a id="__codelineno-25-68" name="__codelineno-25-68"></a>        <span class="c1"># Mantem dentro da tela</span>
<a id="__codelineno-25-69" name="__codelineno-25-69"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-25-70" name="__codelineno-25-70"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">WIDTH</span>
<a id="__codelineno-25-71" name="__codelineno-25-71"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-25-72" name="__codelineno-25-72"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-25-73" name="__codelineno-25-73"></a>
<a id="__codelineno-25-74" name="__codelineno-25-74"></a>    <span class="k">def</span> <span class="nf">shoot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-25-75" name="__codelineno-25-75"></a>        <span class="c1"># Verifica se pode atirar</span>
<a id="__codelineno-25-76" name="__codelineno-25-76"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-25-77" name="__codelineno-25-77"></a>        <span class="c1"># Verifica quantos ticks se passaram desde o último tiro.</span>
<a id="__codelineno-25-78" name="__codelineno-25-78"></a>        <span class="n">elapsed_ticks</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span>
<a id="__codelineno-25-79" name="__codelineno-25-79"></a>
<a id="__codelineno-25-80" name="__codelineno-25-80"></a>        <span class="c1"># Se já pode atirar novamente...</span>
<a id="__codelineno-25-81" name="__codelineno-25-81"></a>        <span class="k">if</span> <span class="n">elapsed_ticks</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">shoot_ticks</span><span class="p">:</span>
<a id="__codelineno-25-82" name="__codelineno-25-82"></a>            <span class="c1"># Marca o tick da nova imagem.</span>
<a id="__codelineno-25-83" name="__codelineno-25-83"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span> <span class="o">=</span> <span class="n">now</span>
<a id="__codelineno-25-84" name="__codelineno-25-84"></a>            <span class="c1"># A nova bala vai ser criada logo acima e no centro horizontal da nave</span>
<a id="__codelineno-25-85" name="__codelineno-25-85"></a>            <span class="n">new_bullet</span> <span class="o">=</span> <span class="n">Bullet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span><span class="p">)</span>
<a id="__codelineno-25-86" name="__codelineno-25-86"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_sprites&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-25-87" name="__codelineno-25-87"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_bullets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-25-88" name="__codelineno-25-88"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;pew_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-25-89" name="__codelineno-25-89"></a>
<a id="__codelineno-25-90" name="__codelineno-25-90"></a><span class="k">class</span> <span class="nc">Meteor</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-25-91" name="__codelineno-25-91"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-25-92" name="__codelineno-25-92"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-25-93" name="__codelineno-25-93"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-25-94" name="__codelineno-25-94"></a>
<a id="__codelineno-25-95" name="__codelineno-25-95"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span>
<a id="__codelineno-25-96" name="__codelineno-25-96"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">from_surface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
<a id="__codelineno-25-97" name="__codelineno-25-97"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-25-98" name="__codelineno-25-98"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-25-99" name="__codelineno-25-99"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-25-100" name="__codelineno-25-100"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-25-101" name="__codelineno-25-101"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-25-102" name="__codelineno-25-102"></a>
<a id="__codelineno-25-103" name="__codelineno-25-103"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-25-104" name="__codelineno-25-104"></a>        <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-25-105" name="__codelineno-25-105"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-25-106" name="__codelineno-25-106"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-25-107" name="__codelineno-25-107"></a>        <span class="c1"># Se o meteoro passar do final da tela, volta para cima e sorteia</span>
<a id="__codelineno-25-108" name="__codelineno-25-108"></a>        <span class="c1"># novas posições e velocidades</span>
<a id="__codelineno-25-109" name="__codelineno-25-109"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-25-110" name="__codelineno-25-110"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-25-111" name="__codelineno-25-111"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-25-112" name="__codelineno-25-112"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-25-113" name="__codelineno-25-113"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-25-114" name="__codelineno-25-114"></a>
<a id="__codelineno-25-115" name="__codelineno-25-115"></a><span class="c1"># Classe Bullet que representa os tiros</span>
<a id="__codelineno-25-116" name="__codelineno-25-116"></a><span class="k">class</span> <span class="nc">Bullet</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-25-117" name="__codelineno-25-117"></a>    <span class="c1"># Construtor da classe.</span>
<a id="__codelineno-25-118" name="__codelineno-25-118"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assets</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">centerx</span><span class="p">):</span>
<a id="__codelineno-25-119" name="__codelineno-25-119"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-25-120" name="__codelineno-25-120"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-25-121" name="__codelineno-25-121"></a>
<a id="__codelineno-25-122" name="__codelineno-25-122"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;bullet_img&#39;</span><span class="p">]</span>
<a id="__codelineno-25-123" name="__codelineno-25-123"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">from_surface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
<a id="__codelineno-25-124" name="__codelineno-25-124"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-25-125" name="__codelineno-25-125"></a>
<a id="__codelineno-25-126" name="__codelineno-25-126"></a>        <span class="c1"># Coloca no lugar inicial definido em x, y do constutor</span>
<a id="__codelineno-25-127" name="__codelineno-25-127"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">centerx</span>
<a id="__codelineno-25-128" name="__codelineno-25-128"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">bottom</span>
<a id="__codelineno-25-129" name="__codelineno-25-129"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>  <span class="c1"># Velocidade fixa para cima</span>
<a id="__codelineno-25-130" name="__codelineno-25-130"></a>
<a id="__codelineno-25-131" name="__codelineno-25-131"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-25-132" name="__codelineno-25-132"></a>        <span class="c1"># A bala só se move no eixo y</span>
<a id="__codelineno-25-133" name="__codelineno-25-133"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-25-134" name="__codelineno-25-134"></a>
<a id="__codelineno-25-135" name="__codelineno-25-135"></a>        <span class="c1"># Se o tiro passar do inicio da tela, morre.</span>
<a id="__codelineno-25-136" name="__codelineno-25-136"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-25-137" name="__codelineno-25-137"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-25-138" name="__codelineno-25-138"></a>
<a id="__codelineno-25-139" name="__codelineno-25-139"></a><span class="c1"># Classe que representa uma explosão de meteoro</span>
<a id="__codelineno-25-140" name="__codelineno-25-140"></a><span class="k">class</span> <span class="nc">Explosion</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-25-141" name="__codelineno-25-141"></a>    <span class="c1"># Construtor da classe.</span>
<a id="__codelineno-25-142" name="__codelineno-25-142"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-25-143" name="__codelineno-25-143"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-25-144" name="__codelineno-25-144"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-25-145" name="__codelineno-25-145"></a>
<a id="__codelineno-25-146" name="__codelineno-25-146"></a>        <span class="c1"># Armazena a animação de explosão</span>
<a id="__codelineno-25-147" name="__codelineno-25-147"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;explosion_anim&#39;</span><span class="p">]</span>
<a id="__codelineno-25-148" name="__codelineno-25-148"></a>
<a id="__codelineno-25-149" name="__codelineno-25-149"></a>        <span class="c1"># Inicia o processo de animação colocando a primeira imagem na tela.</span>
<a id="__codelineno-25-150" name="__codelineno-25-150"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Armazena o índice atual na animação</span>
<a id="__codelineno-25-151" name="__codelineno-25-151"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span>  <span class="c1"># Pega a primeira imagem</span>
<a id="__codelineno-25-152" name="__codelineno-25-152"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-25-153" name="__codelineno-25-153"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>  <span class="c1"># Posiciona o centro da imagem</span>
<a id="__codelineno-25-154" name="__codelineno-25-154"></a>
<a id="__codelineno-25-155" name="__codelineno-25-155"></a>        <span class="c1"># Guarda o tick da primeira imagem, ou seja, o momento em que a imagem foi mostrada</span>
<a id="__codelineno-25-156" name="__codelineno-25-156"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-25-157" name="__codelineno-25-157"></a>
<a id="__codelineno-25-158" name="__codelineno-25-158"></a>        <span class="c1"># Controle de ticks de animação: troca de imagem a cada self.frame_ticks milissegundos.</span>
<a id="__codelineno-25-159" name="__codelineno-25-159"></a>        <span class="c1"># Quando pygame.time.get_ticks() - self.last_update &gt; self.frame_ticks a</span>
<a id="__codelineno-25-160" name="__codelineno-25-160"></a>        <span class="c1"># próxima imagem da animação será mostrada</span>
<a id="__codelineno-25-161" name="__codelineno-25-161"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frame_ticks</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-25-162" name="__codelineno-25-162"></a>
<a id="__codelineno-25-163" name="__codelineno-25-163"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-25-164" name="__codelineno-25-164"></a>        <span class="c1"># Verifica o tick atual.</span>
<a id="__codelineno-25-165" name="__codelineno-25-165"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-25-166" name="__codelineno-25-166"></a>        <span class="c1"># Verifica quantos ticks se passaram desde a ultima mudança de frame.</span>
<a id="__codelineno-25-167" name="__codelineno-25-167"></a>        <span class="n">elapsed_ticks</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span>
<a id="__codelineno-25-168" name="__codelineno-25-168"></a>
<a id="__codelineno-25-169" name="__codelineno-25-169"></a>        <span class="c1"># Se já está na hora de mudar de imagem...</span>
<a id="__codelineno-25-170" name="__codelineno-25-170"></a>        <span class="k">if</span> <span class="n">elapsed_ticks</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_ticks</span><span class="p">:</span>
<a id="__codelineno-25-171" name="__codelineno-25-171"></a>            <span class="c1"># Marca o tick da nova imagem.</span>
<a id="__codelineno-25-172" name="__codelineno-25-172"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span> <span class="o">=</span> <span class="n">now</span>
<a id="__codelineno-25-173" name="__codelineno-25-173"></a>
<a id="__codelineno-25-174" name="__codelineno-25-174"></a>            <span class="c1"># Avança um quadro.</span>
<a id="__codelineno-25-175" name="__codelineno-25-175"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-25-176" name="__codelineno-25-176"></a>
<a id="__codelineno-25-177" name="__codelineno-25-177"></a>            <span class="c1"># Verifica se já chegou no final da animação.</span>
<a id="__codelineno-25-178" name="__codelineno-25-178"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">):</span>
<a id="__codelineno-25-179" name="__codelineno-25-179"></a>                <span class="c1"># Se sim, tchau explosão!</span>
<a id="__codelineno-25-180" name="__codelineno-25-180"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-25-181" name="__codelineno-25-181"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-25-182" name="__codelineno-25-182"></a>                <span class="c1"># Se ainda não chegou ao fim da explosão, troca de imagem.</span>
<a id="__codelineno-25-183" name="__codelineno-25-183"></a>                <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span>
<a id="__codelineno-25-184" name="__codelineno-25-184"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span>
<a id="__codelineno-25-185" name="__codelineno-25-185"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-25-186" name="__codelineno-25-186"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
<a id="__codelineno-25-187" name="__codelineno-25-187"></a>
<a id="__codelineno-25-188" name="__codelineno-25-188"></a><span class="c1"># Variável para o ajuste de velocidade</span>
<a id="__codelineno-25-189" name="__codelineno-25-189"></a><span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<a id="__codelineno-25-190" name="__codelineno-25-190"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">30</span>
<a id="__codelineno-25-191" name="__codelineno-25-191"></a>
<a id="__codelineno-25-192" name="__codelineno-25-192"></a><span class="c1"># Criando um grupo de meteoros</span>
<a id="__codelineno-25-193" name="__codelineno-25-193"></a><span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-25-194" name="__codelineno-25-194"></a><span class="n">all_meteors</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-25-195" name="__codelineno-25-195"></a><span class="n">all_bullets</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-25-196" name="__codelineno-25-196"></a><span class="n">groups</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-25-197" name="__codelineno-25-197"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_sprites&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_sprites</span>
<a id="__codelineno-25-198" name="__codelineno-25-198"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_meteors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_meteors</span>
<a id="__codelineno-25-199" name="__codelineno-25-199"></a><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_bullets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_bullets</span>
<a id="__codelineno-25-200" name="__codelineno-25-200"></a>
<a id="__codelineno-25-201" name="__codelineno-25-201"></a><span class="c1"># Criando o jogador</span>
<a id="__codelineno-25-202" name="__codelineno-25-202"></a><span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-25-203" name="__codelineno-25-203"></a><span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-25-204" name="__codelineno-25-204"></a><span class="c1"># Criando os meteoros</span>
<a id="__codelineno-25-205" name="__codelineno-25-205"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a id="__codelineno-25-206" name="__codelineno-25-206"></a>    <span class="n">meteor</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-25-207" name="__codelineno-25-207"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-25-208" name="__codelineno-25-208"></a>    <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-25-209" name="__codelineno-25-209"></a>
<a id="__codelineno-25-210" name="__codelineno-25-210"></a><span class="n">DONE</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-25-211" name="__codelineno-25-211"></a><span class="n">PLAYING</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-25-212" name="__codelineno-25-212"></a><span class="n">EXPLODING</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-25-213" name="__codelineno-25-213"></a><span class="n">state</span> <span class="o">=</span> <span class="n">PLAYING</span>
<a id="__codelineno-25-214" name="__codelineno-25-214"></a>
<a id="__codelineno-25-215" name="__codelineno-25-215"></a><span class="n">keys_down</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-25-216" name="__codelineno-25-216"></a><span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-25-217" name="__codelineno-25-217"></a><span class="n">lives</span> <span class="o">=</span> <span class="mi">3</span>
<a id="__codelineno-25-218" name="__codelineno-25-218"></a>
<a id="__codelineno-25-219" name="__codelineno-25-219"></a><span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-25-220" name="__codelineno-25-220"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">loops</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-25-221" name="__codelineno-25-221"></a><span class="k">while</span> <span class="n">state</span> <span class="o">!=</span> <span class="n">DONE</span><span class="p">:</span>
<a id="__codelineno-25-222" name="__codelineno-25-222"></a>    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
<a id="__codelineno-25-223" name="__codelineno-25-223"></a>
<a id="__codelineno-25-224" name="__codelineno-25-224"></a>    <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-25-225" name="__codelineno-25-225"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-25-226" name="__codelineno-25-226"></a>        <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-25-227" name="__codelineno-25-227"></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-25-228" name="__codelineno-25-228"></a>            <span class="n">state</span> <span class="o">=</span> <span class="n">DONE</span>
<a id="__codelineno-25-229" name="__codelineno-25-229"></a>        <span class="c1"># Só verifica o teclado se está no estado de jogo</span>
<a id="__codelineno-25-230" name="__codelineno-25-230"></a>        <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">PLAYING</span><span class="p">:</span>
<a id="__codelineno-25-231" name="__codelineno-25-231"></a>            <span class="c1"># Verifica se apertou alguma tecla.</span>
<a id="__codelineno-25-232" name="__codelineno-25-232"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>
<a id="__codelineno-25-233" name="__codelineno-25-233"></a>                <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-25-234" name="__codelineno-25-234"></a>                <span class="n">keys_down</span><span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-25-235" name="__codelineno-25-235"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-25-236" name="__codelineno-25-236"></a>                    <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-25-237" name="__codelineno-25-237"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-25-238" name="__codelineno-25-238"></a>                    <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-25-239" name="__codelineno-25-239"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_SPACE</span><span class="p">:</span>
<a id="__codelineno-25-240" name="__codelineno-25-240"></a>                    <span class="n">player</span><span class="o">.</span><span class="n">shoot</span><span class="p">()</span>
<a id="__codelineno-25-241" name="__codelineno-25-241"></a>            <span class="c1"># Verifica se soltou alguma tecla.</span>
<a id="__codelineno-25-242" name="__codelineno-25-242"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYUP</span><span class="p">:</span>
<a id="__codelineno-25-243" name="__codelineno-25-243"></a>                <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-25-244" name="__codelineno-25-244"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="ow">in</span> <span class="n">keys_down</span> <span class="ow">and</span> <span class="n">keys_down</span><span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">]:</span>
<a id="__codelineno-25-245" name="__codelineno-25-245"></a>                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-25-246" name="__codelineno-25-246"></a>                        <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-25-247" name="__codelineno-25-247"></a>                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-25-248" name="__codelineno-25-248"></a>                        <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-25-249" name="__codelineno-25-249"></a>
<a id="__codelineno-25-250" name="__codelineno-25-250"></a>    <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-25-251" name="__codelineno-25-251"></a>    <span class="c1"># Atualizando a posição dos meteoros</span>
<a id="__codelineno-25-252" name="__codelineno-25-252"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-25-253" name="__codelineno-25-253"></a>
<a id="__codelineno-25-254" name="__codelineno-25-254"></a>    <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">PLAYING</span><span class="p">:</span>
<a id="__codelineno-25-255" name="__codelineno-25-255"></a>        <span class="c1"># Verifica se houve colisão entre tiro e meteoro</span>
<a id="__codelineno-25-256" name="__codelineno-25-256"></a>        <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">groupcollide</span><span class="p">(</span><span class="n">all_meteors</span><span class="p">,</span> <span class="n">all_bullets</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">collide_mask</span><span class="p">)</span>
<a id="__codelineno-25-257" name="__codelineno-25-257"></a>        <span class="k">for</span> <span class="n">meteor</span> <span class="ow">in</span> <span class="n">hits</span><span class="p">:</span> <span class="c1"># As chaves são os elementos do primeiro grupo (meteoros) que colidiram com alguma bala</span>
<a id="__codelineno-25-258" name="__codelineno-25-258"></a>            <span class="c1"># O meteoro e destruido e precisa ser recriado</span>
<a id="__codelineno-25-259" name="__codelineno-25-259"></a>            <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;destroy_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-25-260" name="__codelineno-25-260"></a>            <span class="n">m</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-25-261" name="__codelineno-25-261"></a>            <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-25-262" name="__codelineno-25-262"></a>            <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-25-263" name="__codelineno-25-263"></a>
<a id="__codelineno-25-264" name="__codelineno-25-264"></a>            <span class="c1"># No lugar do meteoro antigo, adicionar uma explosão.</span>
<a id="__codelineno-25-265" name="__codelineno-25-265"></a>            <span class="n">explosao</span> <span class="o">=</span> <span class="n">Explosion</span><span class="p">(</span><span class="n">meteor</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-25-266" name="__codelineno-25-266"></a>            <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">explosao</span><span class="p">)</span>
<a id="__codelineno-25-267" name="__codelineno-25-267"></a>
<a id="__codelineno-25-268" name="__codelineno-25-268"></a>            <span class="c1"># Ganhou pontos!</span>
<a id="__codelineno-25-269" name="__codelineno-25-269"></a>            <span class="n">score</span> <span class="o">+=</span> <span class="mi">100</span>
<a id="__codelineno-25-270" name="__codelineno-25-270"></a>            <span class="k">if</span> <span class="n">score</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-25-271" name="__codelineno-25-271"></a>                <span class="n">lives</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-25-272" name="__codelineno-25-272"></a>
<a id="__codelineno-25-273" name="__codelineno-25-273"></a>        <span class="c1"># Verifica se houve colisão entre nave e meteoro</span>
<a id="__codelineno-25-274" name="__codelineno-25-274"></a>        <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">spritecollide</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">all_meteors</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">collide_mask</span><span class="p">)</span>
<a id="__codelineno-25-275" name="__codelineno-25-275"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hits</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-25-276" name="__codelineno-25-276"></a>            <span class="c1"># Toca o som da colisão</span>
<a id="__codelineno-25-277" name="__codelineno-25-277"></a>            <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;boom_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-25-278" name="__codelineno-25-278"></a>            <span class="n">player</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-25-279" name="__codelineno-25-279"></a>            <span class="n">lives</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-25-280" name="__codelineno-25-280"></a>            <span class="n">explosao</span> <span class="o">=</span> <span class="n">Explosion</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-25-281" name="__codelineno-25-281"></a>            <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">explosao</span><span class="p">)</span>
<a id="__codelineno-25-282" name="__codelineno-25-282"></a>            <span class="n">state</span> <span class="o">=</span> <span class="n">EXPLODING</span>
<a id="__codelineno-25-283" name="__codelineno-25-283"></a>            <span class="n">keys_down</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-25-284" name="__codelineno-25-284"></a>            <span class="n">explosion_tick</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-25-285" name="__codelineno-25-285"></a>            <span class="n">explosion_duration</span> <span class="o">=</span> <span class="n">explosao</span><span class="o">.</span><span class="n">frame_ticks</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">explosao</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">)</span> <span class="o">+</span> <span class="mi">400</span>
<a id="__codelineno-25-286" name="__codelineno-25-286"></a>    <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="n">EXPLODING</span><span class="p">:</span>
<a id="__codelineno-25-287" name="__codelineno-25-287"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-25-288" name="__codelineno-25-288"></a>        <span class="k">if</span> <span class="n">now</span> <span class="o">-</span> <span class="n">explosion_tick</span> <span class="o">&gt;</span> <span class="n">explosion_duration</span><span class="p">:</span>
<a id="__codelineno-25-289" name="__codelineno-25-289"></a>            <span class="k">if</span> <span class="n">lives</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-25-290" name="__codelineno-25-290"></a>                <span class="n">state</span> <span class="o">=</span> <span class="n">DONE</span>
<a id="__codelineno-25-291" name="__codelineno-25-291"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-25-292" name="__codelineno-25-292"></a>                <span class="n">state</span> <span class="o">=</span> <span class="n">PLAYING</span>
<a id="__codelineno-25-293" name="__codelineno-25-293"></a>                <span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-25-294" name="__codelineno-25-294"></a>                <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-25-295" name="__codelineno-25-295"></a>
<a id="__codelineno-25-296" name="__codelineno-25-296"></a>    <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-25-297" name="__codelineno-25-297"></a>    <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-25-298" name="__codelineno-25-298"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-25-299" name="__codelineno-25-299"></a>    <span class="c1"># Desenhando meteoros</span>
<a id="__codelineno-25-300" name="__codelineno-25-300"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-25-301" name="__codelineno-25-301"></a>
<a id="__codelineno-25-302" name="__codelineno-25-302"></a>    <span class="c1"># Desenhando o score</span>
<a id="__codelineno-25-303" name="__codelineno-25-303"></a>    <span class="n">text_surface</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;score_font&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:08d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">score</span><span class="p">),</span> <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-25-304" name="__codelineno-25-304"></a>    <span class="n">text_rect</span> <span class="o">=</span> <span class="n">text_surface</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-25-305" name="__codelineno-25-305"></a>    <span class="n">text_rect</span><span class="o">.</span><span class="n">midtop</span> <span class="o">=</span> <span class="p">(</span><span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-25-306" name="__codelineno-25-306"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">text_surface</span><span class="p">,</span> <span class="n">text_rect</span><span class="p">)</span>
<a id="__codelineno-25-307" name="__codelineno-25-307"></a>
<a id="__codelineno-25-308" name="__codelineno-25-308"></a>    <span class="c1"># Desenhando as vidas</span>
<a id="__codelineno-25-309" name="__codelineno-25-309"></a>    <span class="n">text_surface</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;score_font&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="mi">9829</span><span class="p">)</span> <span class="o">*</span> <span class="n">lives</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-25-310" name="__codelineno-25-310"></a>    <span class="n">text_rect</span> <span class="o">=</span> <span class="n">text_surface</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-25-311" name="__codelineno-25-311"></a>    <span class="n">text_rect</span><span class="o">.</span><span class="n">bottomleft</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-25-312" name="__codelineno-25-312"></a>    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">text_surface</span><span class="p">,</span> <span class="n">text_rect</span><span class="p">)</span>
<a id="__codelineno-25-313" name="__codelineno-25-313"></a>
<a id="__codelineno-25-314" name="__codelineno-25-314"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-25-315" name="__codelineno-25-315"></a>
<a id="__codelineno-25-316" name="__codelineno-25-316"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-25-317" name="__codelineno-25-317"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<ul>
<li>Linhas 52, 96 e 123: cria as máscaras de colisão a partir da imagem do sprite;</li>
<li>Linhas 256 e 274: define que as colisões devem ser realizadas usando máscaras;</li>
<li>Linhas 270 e 271: resposta do exercício 18.</li>
</ul>
<h2 id="separando-o-codigo-em-mais-funcoes">Separando o código em mais funções</h2>
<p>Este código está ficando muito grande! Está na hora de quebrar esse monolito em funções simples. Isso vai facilitar o desenvolvimento de novas telas de jogo. O <code class="language-python highlight"><span class="n">jogo_v20</span><span class="o">.</span><span class="n">py</span></code> cria as funções <code class="language-python highlight"><span class="n">load_assets</span></code> e <code class="language-python highlight"><span class="n">game_screen</span></code> que extraem o carregamento dos assets e a lógica do jogo. Nessa versão não existe nenhuma mudança, visualmente falando, mas essa refatoração vai ser bastante útil para o próximo passo. Principais mudanças:</p>
<details class="info">
<summary>Código <code>referencia/jogo_v20.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">  1</a></span>
<span class="normal"><a href="#__codelineno-26-2">  2</a></span>
<span class="normal"><a href="#__codelineno-26-3">  3</a></span>
<span class="normal"><a href="#__codelineno-26-4">  4</a></span>
<span class="normal"><a href="#__codelineno-26-5">  5</a></span>
<span class="normal"><a href="#__codelineno-26-6">  6</a></span>
<span class="normal"><a href="#__codelineno-26-7">  7</a></span>
<span class="normal"><a href="#__codelineno-26-8">  8</a></span>
<span class="normal"><a href="#__codelineno-26-9">  9</a></span>
<span class="normal"><a href="#__codelineno-26-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-26-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-26-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-26-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-26-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-26-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-26-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-26-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-26-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-26-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-26-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-26-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-26-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-26-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-26-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-26-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-26-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-26-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-26-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-26-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-26-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-26-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-26-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-26-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-26-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-26-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-26-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-26-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-26-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-26-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-26-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-26-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-26-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-26-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-26-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-26-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-26-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-26-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-26-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-26-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-26-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-26-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-26-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-26-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-26-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-26-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-26-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-26-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-26-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-26-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-26-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-26-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-26-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-26-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-26-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-26-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-26-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-26-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-26-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-26-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-26-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-26-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-26-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-26-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-26-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-26-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-26-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-26-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-26-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-26-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-26-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-26-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-26-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-26-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-26-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-26-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-26-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-26-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-26-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-26-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-26-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-26-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-26-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-26-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-26-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-26-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-26-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-26-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-26-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-26-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-26-100">100</a></span>
<span class="normal"><a href="#__codelineno-26-101">101</a></span>
<span class="normal"><a href="#__codelineno-26-102">102</a></span>
<span class="normal"><a href="#__codelineno-26-103">103</a></span>
<span class="normal"><a href="#__codelineno-26-104">104</a></span>
<span class="normal"><a href="#__codelineno-26-105">105</a></span>
<span class="normal"><a href="#__codelineno-26-106">106</a></span>
<span class="normal"><a href="#__codelineno-26-107">107</a></span>
<span class="normal"><a href="#__codelineno-26-108">108</a></span>
<span class="normal"><a href="#__codelineno-26-109">109</a></span>
<span class="normal"><a href="#__codelineno-26-110">110</a></span>
<span class="normal"><a href="#__codelineno-26-111">111</a></span>
<span class="normal"><a href="#__codelineno-26-112">112</a></span>
<span class="normal"><a href="#__codelineno-26-113">113</a></span>
<span class="normal"><a href="#__codelineno-26-114">114</a></span>
<span class="normal"><a href="#__codelineno-26-115">115</a></span>
<span class="normal"><a href="#__codelineno-26-116">116</a></span>
<span class="normal"><a href="#__codelineno-26-117">117</a></span>
<span class="normal"><a href="#__codelineno-26-118">118</a></span>
<span class="normal"><a href="#__codelineno-26-119">119</a></span>
<span class="normal"><a href="#__codelineno-26-120">120</a></span>
<span class="normal"><a href="#__codelineno-26-121">121</a></span>
<span class="normal"><a href="#__codelineno-26-122">122</a></span>
<span class="normal"><a href="#__codelineno-26-123">123</a></span>
<span class="normal"><a href="#__codelineno-26-124">124</a></span>
<span class="normal"><a href="#__codelineno-26-125">125</a></span>
<span class="normal"><a href="#__codelineno-26-126">126</a></span>
<span class="normal"><a href="#__codelineno-26-127">127</a></span>
<span class="normal"><a href="#__codelineno-26-128">128</a></span>
<span class="normal"><a href="#__codelineno-26-129">129</a></span>
<span class="normal"><a href="#__codelineno-26-130">130</a></span>
<span class="normal"><a href="#__codelineno-26-131">131</a></span>
<span class="normal"><a href="#__codelineno-26-132">132</a></span>
<span class="normal"><a href="#__codelineno-26-133">133</a></span>
<span class="normal"><a href="#__codelineno-26-134">134</a></span>
<span class="normal"><a href="#__codelineno-26-135">135</a></span>
<span class="normal"><a href="#__codelineno-26-136">136</a></span>
<span class="normal"><a href="#__codelineno-26-137">137</a></span>
<span class="normal"><a href="#__codelineno-26-138">138</a></span>
<span class="normal"><a href="#__codelineno-26-139">139</a></span>
<span class="normal"><a href="#__codelineno-26-140">140</a></span>
<span class="normal"><a href="#__codelineno-26-141">141</a></span>
<span class="normal"><a href="#__codelineno-26-142">142</a></span>
<span class="normal"><a href="#__codelineno-26-143">143</a></span>
<span class="normal"><a href="#__codelineno-26-144">144</a></span>
<span class="normal"><a href="#__codelineno-26-145">145</a></span>
<span class="normal"><a href="#__codelineno-26-146">146</a></span>
<span class="normal"><a href="#__codelineno-26-147">147</a></span>
<span class="normal"><a href="#__codelineno-26-148">148</a></span>
<span class="normal"><a href="#__codelineno-26-149">149</a></span>
<span class="normal"><a href="#__codelineno-26-150">150</a></span>
<span class="normal"><a href="#__codelineno-26-151">151</a></span>
<span class="normal"><a href="#__codelineno-26-152">152</a></span>
<span class="normal"><a href="#__codelineno-26-153">153</a></span>
<span class="normal"><a href="#__codelineno-26-154">154</a></span>
<span class="normal"><a href="#__codelineno-26-155">155</a></span>
<span class="normal"><a href="#__codelineno-26-156">156</a></span>
<span class="normal"><a href="#__codelineno-26-157">157</a></span>
<span class="normal"><a href="#__codelineno-26-158">158</a></span>
<span class="normal"><a href="#__codelineno-26-159">159</a></span>
<span class="normal"><a href="#__codelineno-26-160">160</a></span>
<span class="normal"><a href="#__codelineno-26-161">161</a></span>
<span class="normal"><a href="#__codelineno-26-162">162</a></span>
<span class="normal"><a href="#__codelineno-26-163">163</a></span>
<span class="normal"><a href="#__codelineno-26-164">164</a></span>
<span class="normal"><a href="#__codelineno-26-165">165</a></span>
<span class="normal"><a href="#__codelineno-26-166">166</a></span>
<span class="normal"><a href="#__codelineno-26-167">167</a></span>
<span class="normal"><a href="#__codelineno-26-168">168</a></span>
<span class="normal"><a href="#__codelineno-26-169">169</a></span>
<span class="normal"><a href="#__codelineno-26-170">170</a></span>
<span class="normal"><a href="#__codelineno-26-171">171</a></span>
<span class="normal"><a href="#__codelineno-26-172">172</a></span>
<span class="normal"><a href="#__codelineno-26-173">173</a></span>
<span class="normal"><a href="#__codelineno-26-174">174</a></span>
<span class="normal"><a href="#__codelineno-26-175">175</a></span>
<span class="normal"><a href="#__codelineno-26-176">176</a></span>
<span class="normal"><a href="#__codelineno-26-177">177</a></span>
<span class="normal"><a href="#__codelineno-26-178">178</a></span>
<span class="normal"><a href="#__codelineno-26-179">179</a></span>
<span class="normal"><a href="#__codelineno-26-180">180</a></span>
<span class="normal"><a href="#__codelineno-26-181">181</a></span>
<span class="normal"><a href="#__codelineno-26-182">182</a></span>
<span class="normal"><a href="#__codelineno-26-183">183</a></span>
<span class="normal"><a href="#__codelineno-26-184">184</a></span>
<span class="normal"><a href="#__codelineno-26-185">185</a></span>
<span class="normal"><a href="#__codelineno-26-186">186</a></span>
<span class="normal"><a href="#__codelineno-26-187">187</a></span>
<span class="normal"><a href="#__codelineno-26-188">188</a></span>
<span class="normal"><a href="#__codelineno-26-189">189</a></span>
<span class="normal"><a href="#__codelineno-26-190">190</a></span>
<span class="normal"><a href="#__codelineno-26-191">191</a></span>
<span class="normal"><a href="#__codelineno-26-192">192</a></span>
<span class="normal"><a href="#__codelineno-26-193">193</a></span>
<span class="normal"><a href="#__codelineno-26-194">194</a></span>
<span class="normal"><a href="#__codelineno-26-195">195</a></span>
<span class="normal"><a href="#__codelineno-26-196">196</a></span>
<span class="normal"><a href="#__codelineno-26-197">197</a></span>
<span class="normal"><a href="#__codelineno-26-198">198</a></span>
<span class="normal"><a href="#__codelineno-26-199">199</a></span>
<span class="normal"><a href="#__codelineno-26-200">200</a></span>
<span class="normal"><a href="#__codelineno-26-201">201</a></span>
<span class="normal"><a href="#__codelineno-26-202">202</a></span>
<span class="normal"><a href="#__codelineno-26-203">203</a></span>
<span class="normal"><a href="#__codelineno-26-204">204</a></span>
<span class="normal"><a href="#__codelineno-26-205">205</a></span>
<span class="normal"><a href="#__codelineno-26-206">206</a></span>
<span class="normal"><a href="#__codelineno-26-207">207</a></span>
<span class="normal"><a href="#__codelineno-26-208">208</a></span>
<span class="normal"><a href="#__codelineno-26-209">209</a></span>
<span class="normal"><a href="#__codelineno-26-210">210</a></span>
<span class="normal"><a href="#__codelineno-26-211">211</a></span>
<span class="normal"><a href="#__codelineno-26-212">212</a></span>
<span class="normal"><a href="#__codelineno-26-213">213</a></span>
<span class="normal"><a href="#__codelineno-26-214">214</a></span>
<span class="normal"><a href="#__codelineno-26-215">215</a></span>
<span class="normal"><a href="#__codelineno-26-216">216</a></span>
<span class="normal"><a href="#__codelineno-26-217">217</a></span>
<span class="normal"><a href="#__codelineno-26-218">218</a></span>
<span class="normal"><a href="#__codelineno-26-219">219</a></span>
<span class="normal"><a href="#__codelineno-26-220">220</a></span>
<span class="normal"><a href="#__codelineno-26-221">221</a></span>
<span class="normal"><a href="#__codelineno-26-222">222</a></span>
<span class="normal"><a href="#__codelineno-26-223">223</a></span>
<span class="normal"><a href="#__codelineno-26-224">224</a></span>
<span class="normal"><a href="#__codelineno-26-225">225</a></span>
<span class="normal"><a href="#__codelineno-26-226">226</a></span>
<span class="normal"><a href="#__codelineno-26-227">227</a></span>
<span class="normal"><a href="#__codelineno-26-228">228</a></span>
<span class="normal"><a href="#__codelineno-26-229">229</a></span>
<span class="normal"><a href="#__codelineno-26-230">230</a></span>
<span class="normal"><a href="#__codelineno-26-231">231</a></span>
<span class="normal"><a href="#__codelineno-26-232">232</a></span>
<span class="normal"><a href="#__codelineno-26-233">233</a></span>
<span class="normal"><a href="#__codelineno-26-234">234</a></span>
<span class="normal"><a href="#__codelineno-26-235">235</a></span>
<span class="normal"><a href="#__codelineno-26-236">236</a></span>
<span class="normal"><a href="#__codelineno-26-237">237</a></span>
<span class="normal"><a href="#__codelineno-26-238">238</a></span>
<span class="normal"><a href="#__codelineno-26-239">239</a></span>
<span class="normal"><a href="#__codelineno-26-240">240</a></span>
<span class="normal"><a href="#__codelineno-26-241">241</a></span>
<span class="normal"><a href="#__codelineno-26-242">242</a></span>
<span class="normal"><a href="#__codelineno-26-243">243</a></span>
<span class="normal"><a href="#__codelineno-26-244">244</a></span>
<span class="normal"><a href="#__codelineno-26-245">245</a></span>
<span class="normal"><a href="#__codelineno-26-246">246</a></span>
<span class="normal"><a href="#__codelineno-26-247">247</a></span>
<span class="normal"><a href="#__codelineno-26-248">248</a></span>
<span class="normal"><a href="#__codelineno-26-249">249</a></span>
<span class="normal"><a href="#__codelineno-26-250">250</a></span>
<span class="normal"><a href="#__codelineno-26-251">251</a></span>
<span class="normal"><a href="#__codelineno-26-252">252</a></span>
<span class="normal"><a href="#__codelineno-26-253">253</a></span>
<span class="normal"><a href="#__codelineno-26-254">254</a></span>
<span class="normal"><a href="#__codelineno-26-255">255</a></span>
<span class="normal"><a href="#__codelineno-26-256">256</a></span>
<span class="normal"><a href="#__codelineno-26-257">257</a></span>
<span class="normal"><a href="#__codelineno-26-258">258</a></span>
<span class="normal"><a href="#__codelineno-26-259">259</a></span>
<span class="normal"><a href="#__codelineno-26-260">260</a></span>
<span class="normal"><a href="#__codelineno-26-261">261</a></span>
<span class="normal"><a href="#__codelineno-26-262">262</a></span>
<span class="normal"><a href="#__codelineno-26-263">263</a></span>
<span class="normal"><a href="#__codelineno-26-264">264</a></span>
<span class="normal"><a href="#__codelineno-26-265">265</a></span>
<span class="normal"><a href="#__codelineno-26-266">266</a></span>
<span class="normal"><a href="#__codelineno-26-267">267</a></span>
<span class="normal"><a href="#__codelineno-26-268">268</a></span>
<span class="normal"><a href="#__codelineno-26-269">269</a></span>
<span class="normal"><a href="#__codelineno-26-270">270</a></span>
<span class="normal"><a href="#__codelineno-26-271">271</a></span>
<span class="normal"><a href="#__codelineno-26-272">272</a></span>
<span class="normal"><a href="#__codelineno-26-273">273</a></span>
<span class="normal"><a href="#__codelineno-26-274">274</a></span>
<span class="normal"><a href="#__codelineno-26-275">275</a></span>
<span class="normal"><a href="#__codelineno-26-276">276</a></span>
<span class="normal"><a href="#__codelineno-26-277">277</a></span>
<span class="normal"><a href="#__codelineno-26-278">278</a></span>
<span class="normal"><a href="#__codelineno-26-279">279</a></span>
<span class="normal"><a href="#__codelineno-26-280">280</a></span>
<span class="normal"><a href="#__codelineno-26-281">281</a></span>
<span class="normal"><a href="#__codelineno-26-282">282</a></span>
<span class="normal"><a href="#__codelineno-26-283">283</a></span>
<span class="normal"><a href="#__codelineno-26-284">284</a></span>
<span class="normal"><a href="#__codelineno-26-285">285</a></span>
<span class="normal"><a href="#__codelineno-26-286">286</a></span>
<span class="normal"><a href="#__codelineno-26-287">287</a></span>
<span class="normal"><a href="#__codelineno-26-288">288</a></span>
<span class="normal"><a href="#__codelineno-26-289">289</a></span>
<span class="normal"><a href="#__codelineno-26-290">290</a></span>
<span class="normal"><a href="#__codelineno-26-291">291</a></span>
<span class="normal"><a href="#__codelineno-26-292">292</a></span>
<span class="normal"><a href="#__codelineno-26-293">293</a></span>
<span class="normal"><a href="#__codelineno-26-294">294</a></span>
<span class="normal"><a href="#__codelineno-26-295">295</a></span>
<span class="normal"><a href="#__codelineno-26-296">296</a></span>
<span class="normal"><a href="#__codelineno-26-297">297</a></span>
<span class="normal"><a href="#__codelineno-26-298">298</a></span>
<span class="normal"><a href="#__codelineno-26-299">299</a></span>
<span class="normal"><a href="#__codelineno-26-300">300</a></span>
<span class="normal"><a href="#__codelineno-26-301">301</a></span>
<span class="normal"><a href="#__codelineno-26-302">302</a></span>
<span class="normal"><a href="#__codelineno-26-303">303</a></span>
<span class="normal"><a href="#__codelineno-26-304">304</a></span>
<span class="normal"><a href="#__codelineno-26-305">305</a></span>
<span class="normal"><a href="#__codelineno-26-306">306</a></span>
<span class="normal"><a href="#__codelineno-26-307">307</a></span>
<span class="normal"><a href="#__codelineno-26-308">308</a></span>
<span class="normal"><a href="#__codelineno-26-309">309</a></span>
<span class="normal"><a href="#__codelineno-26-310">310</a></span>
<span class="normal"><a href="#__codelineno-26-311">311</a></span>
<span class="normal"><a href="#__codelineno-26-312">312</a></span>
<span class="normal"><a href="#__codelineno-26-313">313</a></span>
<span class="normal"><a href="#__codelineno-26-314">314</a></span>
<span class="normal"><a href="#__codelineno-26-315">315</a></span>
<span class="normal"><a href="#__codelineno-26-316">316</a></span>
<span class="normal"><a href="#__codelineno-26-317">317</a></span>
<span class="normal"><a href="#__codelineno-26-318">318</a></span>
<span class="normal"><a href="#__codelineno-26-319">319</a></span>
<span class="normal"><a href="#__codelineno-26-320">320</a></span>
<span class="normal"><a href="#__codelineno-26-321">321</a></span>
<span class="normal"><a href="#__codelineno-26-322">322</a></span>
<span class="normal"><a href="#__codelineno-26-323">323</a></span>
<span class="normal"><a href="#__codelineno-26-324">324</a></span>
<span class="normal"><a href="#__codelineno-26-325">325</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-26-5" name="__codelineno-26-5"></a>
<a id="__codelineno-26-6" name="__codelineno-26-6"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-26-7" name="__codelineno-26-7"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-26-8" name="__codelineno-26-8"></a>
<a id="__codelineno-26-9" name="__codelineno-26-9"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-26-10" name="__codelineno-26-10"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">480</span>
<a id="__codelineno-26-11" name="__codelineno-26-11"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-26-12" name="__codelineno-26-12"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-26-13" name="__codelineno-26-13"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-26-14" name="__codelineno-26-14"></a>
<a id="__codelineno-26-15" name="__codelineno-26-15"></a><span class="c1"># ----- Inicia assets</span>
<a id="__codelineno-26-16" name="__codelineno-26-16"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">30</span>
<a id="__codelineno-26-17" name="__codelineno-26-17"></a><span class="n">METEOR_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-26-18" name="__codelineno-26-18"></a><span class="n">METEOR_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-26-19" name="__codelineno-26-19"></a><span class="n">SHIP_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-26-20" name="__codelineno-26-20"></a><span class="n">SHIP_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-26-21" name="__codelineno-26-21"></a>
<a id="__codelineno-26-22" name="__codelineno-26-22"></a><span class="k">def</span> <span class="nf">load_assets</span><span class="p">():</span>
<a id="__codelineno-26-23" name="__codelineno-26-23"></a>    <span class="n">assets</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-26-24" name="__codelineno-26-24"></a>    <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/starfield.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-26-25" name="__codelineno-26-25"></a>    <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/meteorBrown_med1.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-26-26" name="__codelineno-26-26"></a>    <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">],</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-26-27" name="__codelineno-26-27"></a>    <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/playerShip1_orange.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-26-28" name="__codelineno-26-28"></a>    <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">],</span> <span class="p">(</span><span class="n">SHIP_WIDTH</span><span class="p">,</span> <span class="n">SHIP_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-26-29" name="__codelineno-26-29"></a>    <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;bullet_img&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/img/laserRed16.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-26-30" name="__codelineno-26-30"></a>    <span class="n">explosion_anim</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-26-31" name="__codelineno-26-31"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
<a id="__codelineno-26-32" name="__codelineno-26-32"></a>        <span class="c1"># Os arquivos de animação são numerados de 00 a 08</span>
<a id="__codelineno-26-33" name="__codelineno-26-33"></a>        <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;assets/img/regularExplosion0</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-26-34" name="__codelineno-26-34"></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-26-35" name="__codelineno-26-35"></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
<a id="__codelineno-26-36" name="__codelineno-26-36"></a>        <span class="n">explosion_anim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<a id="__codelineno-26-37" name="__codelineno-26-37"></a>    <span class="n">assets</span><span class="p">[</span><span class="s2">&quot;explosion_anim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">explosion_anim</span>
<a id="__codelineno-26-38" name="__codelineno-26-38"></a>    <span class="n">assets</span><span class="p">[</span><span class="s2">&quot;score_font&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="s1">&#39;assets/font/PressStart2P.ttf&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
<a id="__codelineno-26-39" name="__codelineno-26-39"></a>
<a id="__codelineno-26-40" name="__codelineno-26-40"></a>    <span class="c1"># Carrega os sons do jogo</span>
<a id="__codelineno-26-41" name="__codelineno-26-41"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;assets/snd/tgfcoder-FrozenJam-SeamlessLoop.ogg&#39;</span><span class="p">)</span>
<a id="__codelineno-26-42" name="__codelineno-26-42"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">set_volume</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
<a id="__codelineno-26-43" name="__codelineno-26-43"></a>    <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;boom_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/expl3.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-26-44" name="__codelineno-26-44"></a>    <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;destroy_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/expl6.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-26-45" name="__codelineno-26-45"></a>    <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;pew_sound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;assets/snd/pew.wav&#39;</span><span class="p">)</span>
<a id="__codelineno-26-46" name="__codelineno-26-46"></a>    <span class="k">return</span> <span class="n">assets</span>
<a id="__codelineno-26-47" name="__codelineno-26-47"></a>
<a id="__codelineno-26-48" name="__codelineno-26-48"></a><span class="c1"># ----- Inicia estruturas de dados</span>
<a id="__codelineno-26-49" name="__codelineno-26-49"></a><span class="c1"># Definindo os novos tipos</span>
<a id="__codelineno-26-50" name="__codelineno-26-50"></a><span class="k">class</span> <span class="nc">Ship</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-26-51" name="__codelineno-26-51"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-26-52" name="__codelineno-26-52"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-26-53" name="__codelineno-26-53"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-26-54" name="__codelineno-26-54"></a>
<a id="__codelineno-26-55" name="__codelineno-26-55"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">]</span>
<a id="__codelineno-26-56" name="__codelineno-26-56"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">from_surface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
<a id="__codelineno-26-57" name="__codelineno-26-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-26-58" name="__codelineno-26-58"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-26-59" name="__codelineno-26-59"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span>
<a id="__codelineno-26-60" name="__codelineno-26-60"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-26-61" name="__codelineno-26-61"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="o">=</span> <span class="n">groups</span>
<a id="__codelineno-26-62" name="__codelineno-26-62"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assets</span> <span class="o">=</span> <span class="n">assets</span>
<a id="__codelineno-26-63" name="__codelineno-26-63"></a>
<a id="__codelineno-26-64" name="__codelineno-26-64"></a>        <span class="c1"># Só será possível atirar uma vez a cada 500 milissegundos</span>
<a id="__codelineno-26-65" name="__codelineno-26-65"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-26-66" name="__codelineno-26-66"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shoot_ticks</span> <span class="o">=</span> <span class="mi">500</span>
<a id="__codelineno-26-67" name="__codelineno-26-67"></a>
<a id="__codelineno-26-68" name="__codelineno-26-68"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-26-69" name="__codelineno-26-69"></a>        <span class="c1"># Atualização da posição da nave</span>
<a id="__codelineno-26-70" name="__codelineno-26-70"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-26-71" name="__codelineno-26-71"></a>
<a id="__codelineno-26-72" name="__codelineno-26-72"></a>        <span class="c1"># Mantem dentro da tela</span>
<a id="__codelineno-26-73" name="__codelineno-26-73"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-26-74" name="__codelineno-26-74"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">WIDTH</span>
<a id="__codelineno-26-75" name="__codelineno-26-75"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-26-76" name="__codelineno-26-76"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-26-77" name="__codelineno-26-77"></a>
<a id="__codelineno-26-78" name="__codelineno-26-78"></a>    <span class="k">def</span> <span class="nf">shoot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-26-79" name="__codelineno-26-79"></a>        <span class="c1"># Verifica se pode atirar</span>
<a id="__codelineno-26-80" name="__codelineno-26-80"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-26-81" name="__codelineno-26-81"></a>        <span class="c1"># Verifica quantos ticks se passaram desde o último tiro.</span>
<a id="__codelineno-26-82" name="__codelineno-26-82"></a>        <span class="n">elapsed_ticks</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span>
<a id="__codelineno-26-83" name="__codelineno-26-83"></a>
<a id="__codelineno-26-84" name="__codelineno-26-84"></a>        <span class="c1"># Se já pode atirar novamente...</span>
<a id="__codelineno-26-85" name="__codelineno-26-85"></a>        <span class="k">if</span> <span class="n">elapsed_ticks</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">shoot_ticks</span><span class="p">:</span>
<a id="__codelineno-26-86" name="__codelineno-26-86"></a>            <span class="c1"># Marca o tick da nova imagem.</span>
<a id="__codelineno-26-87" name="__codelineno-26-87"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span> <span class="o">=</span> <span class="n">now</span>
<a id="__codelineno-26-88" name="__codelineno-26-88"></a>            <span class="c1"># A nova bala vai ser criada logo acima e no centro horizontal da nave</span>
<a id="__codelineno-26-89" name="__codelineno-26-89"></a>            <span class="n">new_bullet</span> <span class="o">=</span> <span class="n">Bullet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span><span class="p">)</span>
<a id="__codelineno-26-90" name="__codelineno-26-90"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_sprites&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-26-91" name="__codelineno-26-91"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_bullets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-26-92" name="__codelineno-26-92"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;pew_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-26-93" name="__codelineno-26-93"></a>
<a id="__codelineno-26-94" name="__codelineno-26-94"></a><span class="k">class</span> <span class="nc">Meteor</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-26-95" name="__codelineno-26-95"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-26-96" name="__codelineno-26-96"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-26-97" name="__codelineno-26-97"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-26-98" name="__codelineno-26-98"></a>
<a id="__codelineno-26-99" name="__codelineno-26-99"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">]</span>
<a id="__codelineno-26-100" name="__codelineno-26-100"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">from_surface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
<a id="__codelineno-26-101" name="__codelineno-26-101"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-26-102" name="__codelineno-26-102"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-26-103" name="__codelineno-26-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-26-104" name="__codelineno-26-104"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-26-105" name="__codelineno-26-105"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-26-106" name="__codelineno-26-106"></a>
<a id="__codelineno-26-107" name="__codelineno-26-107"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-26-108" name="__codelineno-26-108"></a>        <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-26-109" name="__codelineno-26-109"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-26-110" name="__codelineno-26-110"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-26-111" name="__codelineno-26-111"></a>        <span class="c1"># Se o meteoro passar do final da tela, volta para cima e sorteia</span>
<a id="__codelineno-26-112" name="__codelineno-26-112"></a>        <span class="c1"># novas posições e velocidades</span>
<a id="__codelineno-26-113" name="__codelineno-26-113"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-26-114" name="__codelineno-26-114"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-26-115" name="__codelineno-26-115"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-26-116" name="__codelineno-26-116"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-26-117" name="__codelineno-26-117"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-26-118" name="__codelineno-26-118"></a>
<a id="__codelineno-26-119" name="__codelineno-26-119"></a><span class="c1"># Classe Bullet que representa os tiros</span>
<a id="__codelineno-26-120" name="__codelineno-26-120"></a><span class="k">class</span> <span class="nc">Bullet</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-26-121" name="__codelineno-26-121"></a>    <span class="c1"># Construtor da classe.</span>
<a id="__codelineno-26-122" name="__codelineno-26-122"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assets</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">centerx</span><span class="p">):</span>
<a id="__codelineno-26-123" name="__codelineno-26-123"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-26-124" name="__codelineno-26-124"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-26-125" name="__codelineno-26-125"></a>
<a id="__codelineno-26-126" name="__codelineno-26-126"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;bullet_img&#39;</span><span class="p">]</span>
<a id="__codelineno-26-127" name="__codelineno-26-127"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">from_surface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
<a id="__codelineno-26-128" name="__codelineno-26-128"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-26-129" name="__codelineno-26-129"></a>
<a id="__codelineno-26-130" name="__codelineno-26-130"></a>        <span class="c1"># Coloca no lugar inicial definido em x, y do constutor</span>
<a id="__codelineno-26-131" name="__codelineno-26-131"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">centerx</span>
<a id="__codelineno-26-132" name="__codelineno-26-132"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">bottom</span>
<a id="__codelineno-26-133" name="__codelineno-26-133"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>  <span class="c1"># Velocidade fixa para cima</span>
<a id="__codelineno-26-134" name="__codelineno-26-134"></a>
<a id="__codelineno-26-135" name="__codelineno-26-135"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-26-136" name="__codelineno-26-136"></a>        <span class="c1"># A bala só se move no eixo y</span>
<a id="__codelineno-26-137" name="__codelineno-26-137"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-26-138" name="__codelineno-26-138"></a>
<a id="__codelineno-26-139" name="__codelineno-26-139"></a>        <span class="c1"># Se o tiro passar do inicio da tela, morre.</span>
<a id="__codelineno-26-140" name="__codelineno-26-140"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-26-141" name="__codelineno-26-141"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-26-142" name="__codelineno-26-142"></a>
<a id="__codelineno-26-143" name="__codelineno-26-143"></a><span class="c1"># Classe que representa uma explosão de meteoro</span>
<a id="__codelineno-26-144" name="__codelineno-26-144"></a><span class="k">class</span> <span class="nc">Explosion</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-26-145" name="__codelineno-26-145"></a>    <span class="c1"># Construtor da classe.</span>
<a id="__codelineno-26-146" name="__codelineno-26-146"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-26-147" name="__codelineno-26-147"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-26-148" name="__codelineno-26-148"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-26-149" name="__codelineno-26-149"></a>
<a id="__codelineno-26-150" name="__codelineno-26-150"></a>        <span class="c1"># Armazena a animação de explosão</span>
<a id="__codelineno-26-151" name="__codelineno-26-151"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;explosion_anim&#39;</span><span class="p">]</span>
<a id="__codelineno-26-152" name="__codelineno-26-152"></a>
<a id="__codelineno-26-153" name="__codelineno-26-153"></a>        <span class="c1"># Inicia o processo de animação colocando a primeira imagem na tela.</span>
<a id="__codelineno-26-154" name="__codelineno-26-154"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Armazena o índice atual na animação</span>
<a id="__codelineno-26-155" name="__codelineno-26-155"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span>  <span class="c1"># Pega a primeira imagem</span>
<a id="__codelineno-26-156" name="__codelineno-26-156"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-26-157" name="__codelineno-26-157"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>  <span class="c1"># Posiciona o centro da imagem</span>
<a id="__codelineno-26-158" name="__codelineno-26-158"></a>
<a id="__codelineno-26-159" name="__codelineno-26-159"></a>        <span class="c1"># Guarda o tick da primeira imagem, ou seja, o momento em que a imagem foi mostrada</span>
<a id="__codelineno-26-160" name="__codelineno-26-160"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-26-161" name="__codelineno-26-161"></a>
<a id="__codelineno-26-162" name="__codelineno-26-162"></a>        <span class="c1"># Controle de ticks de animação: troca de imagem a cada self.frame_ticks milissegundos.</span>
<a id="__codelineno-26-163" name="__codelineno-26-163"></a>        <span class="c1"># Quando pygame.time.get_ticks() - self.last_update &gt; self.frame_ticks a</span>
<a id="__codelineno-26-164" name="__codelineno-26-164"></a>        <span class="c1"># próxima imagem da animação será mostrada</span>
<a id="__codelineno-26-165" name="__codelineno-26-165"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frame_ticks</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-26-166" name="__codelineno-26-166"></a>
<a id="__codelineno-26-167" name="__codelineno-26-167"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-26-168" name="__codelineno-26-168"></a>        <span class="c1"># Verifica o tick atual.</span>
<a id="__codelineno-26-169" name="__codelineno-26-169"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-26-170" name="__codelineno-26-170"></a>        <span class="c1"># Verifica quantos ticks se passaram desde a ultima mudança de frame.</span>
<a id="__codelineno-26-171" name="__codelineno-26-171"></a>        <span class="n">elapsed_ticks</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span>
<a id="__codelineno-26-172" name="__codelineno-26-172"></a>
<a id="__codelineno-26-173" name="__codelineno-26-173"></a>        <span class="c1"># Se já está na hora de mudar de imagem...</span>
<a id="__codelineno-26-174" name="__codelineno-26-174"></a>        <span class="k">if</span> <span class="n">elapsed_ticks</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_ticks</span><span class="p">:</span>
<a id="__codelineno-26-175" name="__codelineno-26-175"></a>            <span class="c1"># Marca o tick da nova imagem.</span>
<a id="__codelineno-26-176" name="__codelineno-26-176"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span> <span class="o">=</span> <span class="n">now</span>
<a id="__codelineno-26-177" name="__codelineno-26-177"></a>
<a id="__codelineno-26-178" name="__codelineno-26-178"></a>            <span class="c1"># Avança um quadro.</span>
<a id="__codelineno-26-179" name="__codelineno-26-179"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-26-180" name="__codelineno-26-180"></a>
<a id="__codelineno-26-181" name="__codelineno-26-181"></a>            <span class="c1"># Verifica se já chegou no final da animação.</span>
<a id="__codelineno-26-182" name="__codelineno-26-182"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">):</span>
<a id="__codelineno-26-183" name="__codelineno-26-183"></a>                <span class="c1"># Se sim, tchau explosão!</span>
<a id="__codelineno-26-184" name="__codelineno-26-184"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-26-185" name="__codelineno-26-185"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-26-186" name="__codelineno-26-186"></a>                <span class="c1"># Se ainda não chegou ao fim da explosão, troca de imagem.</span>
<a id="__codelineno-26-187" name="__codelineno-26-187"></a>                <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span>
<a id="__codelineno-26-188" name="__codelineno-26-188"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span>
<a id="__codelineno-26-189" name="__codelineno-26-189"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-26-190" name="__codelineno-26-190"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
<a id="__codelineno-26-191" name="__codelineno-26-191"></a>
<a id="__codelineno-26-192" name="__codelineno-26-192"></a><span class="k">def</span> <span class="nf">game_screen</span><span class="p">(</span><span class="n">window</span><span class="p">):</span>
<a id="__codelineno-26-193" name="__codelineno-26-193"></a>    <span class="c1"># Variável para o ajuste de velocidade</span>
<a id="__codelineno-26-194" name="__codelineno-26-194"></a>    <span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<a id="__codelineno-26-195" name="__codelineno-26-195"></a>
<a id="__codelineno-26-196" name="__codelineno-26-196"></a>    <span class="n">assets</span> <span class="o">=</span> <span class="n">load_assets</span><span class="p">()</span>
<a id="__codelineno-26-197" name="__codelineno-26-197"></a>
<a id="__codelineno-26-198" name="__codelineno-26-198"></a>    <span class="c1"># Criando um grupo de meteoros</span>
<a id="__codelineno-26-199" name="__codelineno-26-199"></a>    <span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-26-200" name="__codelineno-26-200"></a>    <span class="n">all_meteors</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-26-201" name="__codelineno-26-201"></a>    <span class="n">all_bullets</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-26-202" name="__codelineno-26-202"></a>    <span class="n">groups</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-26-203" name="__codelineno-26-203"></a>    <span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_sprites&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_sprites</span>
<a id="__codelineno-26-204" name="__codelineno-26-204"></a>    <span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_meteors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_meteors</span>
<a id="__codelineno-26-205" name="__codelineno-26-205"></a>    <span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_bullets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_bullets</span>
<a id="__codelineno-26-206" name="__codelineno-26-206"></a>
<a id="__codelineno-26-207" name="__codelineno-26-207"></a>    <span class="c1"># Criando o jogador</span>
<a id="__codelineno-26-208" name="__codelineno-26-208"></a>    <span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-26-209" name="__codelineno-26-209"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-26-210" name="__codelineno-26-210"></a>    <span class="c1"># Criando os meteoros</span>
<a id="__codelineno-26-211" name="__codelineno-26-211"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a id="__codelineno-26-212" name="__codelineno-26-212"></a>        <span class="n">meteor</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-26-213" name="__codelineno-26-213"></a>        <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-26-214" name="__codelineno-26-214"></a>        <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-26-215" name="__codelineno-26-215"></a>
<a id="__codelineno-26-216" name="__codelineno-26-216"></a>    <span class="n">DONE</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-26-217" name="__codelineno-26-217"></a>    <span class="n">PLAYING</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-26-218" name="__codelineno-26-218"></a>    <span class="n">EXPLODING</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-26-219" name="__codelineno-26-219"></a>    <span class="n">state</span> <span class="o">=</span> <span class="n">PLAYING</span>
<a id="__codelineno-26-220" name="__codelineno-26-220"></a>
<a id="__codelineno-26-221" name="__codelineno-26-221"></a>    <span class="n">keys_down</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-26-222" name="__codelineno-26-222"></a>    <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-26-223" name="__codelineno-26-223"></a>    <span class="n">lives</span> <span class="o">=</span> <span class="mi">3</span>
<a id="__codelineno-26-224" name="__codelineno-26-224"></a>
<a id="__codelineno-26-225" name="__codelineno-26-225"></a>    <span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-26-226" name="__codelineno-26-226"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">loops</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-26-227" name="__codelineno-26-227"></a>    <span class="k">while</span> <span class="n">state</span> <span class="o">!=</span> <span class="n">DONE</span><span class="p">:</span>
<a id="__codelineno-26-228" name="__codelineno-26-228"></a>        <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
<a id="__codelineno-26-229" name="__codelineno-26-229"></a>
<a id="__codelineno-26-230" name="__codelineno-26-230"></a>        <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-26-231" name="__codelineno-26-231"></a>        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-26-232" name="__codelineno-26-232"></a>            <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-26-233" name="__codelineno-26-233"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-26-234" name="__codelineno-26-234"></a>                <span class="n">state</span> <span class="o">=</span> <span class="n">DONE</span>
<a id="__codelineno-26-235" name="__codelineno-26-235"></a>            <span class="c1"># Só verifica o teclado se está no estado de jogo</span>
<a id="__codelineno-26-236" name="__codelineno-26-236"></a>            <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">PLAYING</span><span class="p">:</span>
<a id="__codelineno-26-237" name="__codelineno-26-237"></a>                <span class="c1"># Verifica se apertou alguma tecla.</span>
<a id="__codelineno-26-238" name="__codelineno-26-238"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>
<a id="__codelineno-26-239" name="__codelineno-26-239"></a>                    <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-26-240" name="__codelineno-26-240"></a>                    <span class="n">keys_down</span><span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-26-241" name="__codelineno-26-241"></a>                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-26-242" name="__codelineno-26-242"></a>                        <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-26-243" name="__codelineno-26-243"></a>                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-26-244" name="__codelineno-26-244"></a>                        <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-26-245" name="__codelineno-26-245"></a>                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_SPACE</span><span class="p">:</span>
<a id="__codelineno-26-246" name="__codelineno-26-246"></a>                        <span class="n">player</span><span class="o">.</span><span class="n">shoot</span><span class="p">()</span>
<a id="__codelineno-26-247" name="__codelineno-26-247"></a>                <span class="c1"># Verifica se soltou alguma tecla.</span>
<a id="__codelineno-26-248" name="__codelineno-26-248"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYUP</span><span class="p">:</span>
<a id="__codelineno-26-249" name="__codelineno-26-249"></a>                    <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-26-250" name="__codelineno-26-250"></a>                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="ow">in</span> <span class="n">keys_down</span> <span class="ow">and</span> <span class="n">keys_down</span><span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">]:</span>
<a id="__codelineno-26-251" name="__codelineno-26-251"></a>                        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-26-252" name="__codelineno-26-252"></a>                            <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-26-253" name="__codelineno-26-253"></a>                        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-26-254" name="__codelineno-26-254"></a>                            <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-26-255" name="__codelineno-26-255"></a>
<a id="__codelineno-26-256" name="__codelineno-26-256"></a>        <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-26-257" name="__codelineno-26-257"></a>        <span class="c1"># Atualizando a posição dos meteoros</span>
<a id="__codelineno-26-258" name="__codelineno-26-258"></a>        <span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-26-259" name="__codelineno-26-259"></a>
<a id="__codelineno-26-260" name="__codelineno-26-260"></a>        <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">PLAYING</span><span class="p">:</span>
<a id="__codelineno-26-261" name="__codelineno-26-261"></a>            <span class="c1"># Verifica se houve colisão entre tiro e meteoro</span>
<a id="__codelineno-26-262" name="__codelineno-26-262"></a>            <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">groupcollide</span><span class="p">(</span><span class="n">all_meteors</span><span class="p">,</span> <span class="n">all_bullets</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">collide_mask</span><span class="p">)</span>
<a id="__codelineno-26-263" name="__codelineno-26-263"></a>            <span class="k">for</span> <span class="n">meteor</span> <span class="ow">in</span> <span class="n">hits</span><span class="p">:</span> <span class="c1"># As chaves são os elementos do primeiro grupo (meteoros) que colidiram com alguma bala</span>
<a id="__codelineno-26-264" name="__codelineno-26-264"></a>                <span class="c1"># O meteoro e destruido e precisa ser recriado</span>
<a id="__codelineno-26-265" name="__codelineno-26-265"></a>                <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;destroy_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-26-266" name="__codelineno-26-266"></a>                <span class="n">m</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-26-267" name="__codelineno-26-267"></a>                <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-26-268" name="__codelineno-26-268"></a>                <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-26-269" name="__codelineno-26-269"></a>
<a id="__codelineno-26-270" name="__codelineno-26-270"></a>                <span class="c1"># No lugar do meteoro antigo, adicionar uma explosão.</span>
<a id="__codelineno-26-271" name="__codelineno-26-271"></a>                <span class="n">explosao</span> <span class="o">=</span> <span class="n">Explosion</span><span class="p">(</span><span class="n">meteor</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-26-272" name="__codelineno-26-272"></a>                <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">explosao</span><span class="p">)</span>
<a id="__codelineno-26-273" name="__codelineno-26-273"></a>
<a id="__codelineno-26-274" name="__codelineno-26-274"></a>                <span class="c1"># Ganhou pontos!</span>
<a id="__codelineno-26-275" name="__codelineno-26-275"></a>                <span class="n">score</span> <span class="o">+=</span> <span class="mi">100</span>
<a id="__codelineno-26-276" name="__codelineno-26-276"></a>                <span class="k">if</span> <span class="n">score</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-26-277" name="__codelineno-26-277"></a>                    <span class="n">lives</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-26-278" name="__codelineno-26-278"></a>
<a id="__codelineno-26-279" name="__codelineno-26-279"></a>            <span class="c1"># Verifica se houve colisão entre nave e meteoro</span>
<a id="__codelineno-26-280" name="__codelineno-26-280"></a>            <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">spritecollide</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">all_meteors</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">collide_mask</span><span class="p">)</span>
<a id="__codelineno-26-281" name="__codelineno-26-281"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hits</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-26-282" name="__codelineno-26-282"></a>                <span class="c1"># Toca o som da colisão</span>
<a id="__codelineno-26-283" name="__codelineno-26-283"></a>                <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;boom_sound&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-26-284" name="__codelineno-26-284"></a>                <span class="n">player</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-26-285" name="__codelineno-26-285"></a>                <span class="n">lives</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-26-286" name="__codelineno-26-286"></a>                <span class="n">explosao</span> <span class="o">=</span> <span class="n">Explosion</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-26-287" name="__codelineno-26-287"></a>                <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">explosao</span><span class="p">)</span>
<a id="__codelineno-26-288" name="__codelineno-26-288"></a>                <span class="n">state</span> <span class="o">=</span> <span class="n">EXPLODING</span>
<a id="__codelineno-26-289" name="__codelineno-26-289"></a>                <span class="n">keys_down</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-26-290" name="__codelineno-26-290"></a>                <span class="n">explosion_tick</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-26-291" name="__codelineno-26-291"></a>                <span class="n">explosion_duration</span> <span class="o">=</span> <span class="n">explosao</span><span class="o">.</span><span class="n">frame_ticks</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">explosao</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">)</span> <span class="o">+</span> <span class="mi">400</span>
<a id="__codelineno-26-292" name="__codelineno-26-292"></a>        <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="n">EXPLODING</span><span class="p">:</span>
<a id="__codelineno-26-293" name="__codelineno-26-293"></a>            <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-26-294" name="__codelineno-26-294"></a>            <span class="k">if</span> <span class="n">now</span> <span class="o">-</span> <span class="n">explosion_tick</span> <span class="o">&gt;</span> <span class="n">explosion_duration</span><span class="p">:</span>
<a id="__codelineno-26-295" name="__codelineno-26-295"></a>                <span class="k">if</span> <span class="n">lives</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-26-296" name="__codelineno-26-296"></a>                    <span class="n">state</span> <span class="o">=</span> <span class="n">DONE</span>
<a id="__codelineno-26-297" name="__codelineno-26-297"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-26-298" name="__codelineno-26-298"></a>                    <span class="n">state</span> <span class="o">=</span> <span class="n">PLAYING</span>
<a id="__codelineno-26-299" name="__codelineno-26-299"></a>                    <span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-26-300" name="__codelineno-26-300"></a>                    <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-26-301" name="__codelineno-26-301"></a>
<a id="__codelineno-26-302" name="__codelineno-26-302"></a>        <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-26-303" name="__codelineno-26-303"></a>        <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-26-304" name="__codelineno-26-304"></a>        <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-26-305" name="__codelineno-26-305"></a>        <span class="c1"># Desenhando meteoros</span>
<a id="__codelineno-26-306" name="__codelineno-26-306"></a>        <span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-26-307" name="__codelineno-26-307"></a>
<a id="__codelineno-26-308" name="__codelineno-26-308"></a>        <span class="c1"># Desenhando o score</span>
<a id="__codelineno-26-309" name="__codelineno-26-309"></a>        <span class="n">text_surface</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;score_font&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:08d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">score</span><span class="p">),</span> <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-26-310" name="__codelineno-26-310"></a>        <span class="n">text_rect</span> <span class="o">=</span> <span class="n">text_surface</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-26-311" name="__codelineno-26-311"></a>        <span class="n">text_rect</span><span class="o">.</span><span class="n">midtop</span> <span class="o">=</span> <span class="p">(</span><span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-26-312" name="__codelineno-26-312"></a>        <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">text_surface</span><span class="p">,</span> <span class="n">text_rect</span><span class="p">)</span>
<a id="__codelineno-26-313" name="__codelineno-26-313"></a>
<a id="__codelineno-26-314" name="__codelineno-26-314"></a>        <span class="c1"># Desenhando as vidas</span>
<a id="__codelineno-26-315" name="__codelineno-26-315"></a>        <span class="n">text_surface</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="s1">&#39;score_font&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="mi">9829</span><span class="p">)</span> <span class="o">*</span> <span class="n">lives</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-26-316" name="__codelineno-26-316"></a>        <span class="n">text_rect</span> <span class="o">=</span> <span class="n">text_surface</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-26-317" name="__codelineno-26-317"></a>        <span class="n">text_rect</span><span class="o">.</span><span class="n">bottomleft</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-26-318" name="__codelineno-26-318"></a>        <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">text_surface</span><span class="p">,</span> <span class="n">text_rect</span><span class="p">)</span>
<a id="__codelineno-26-319" name="__codelineno-26-319"></a>
<a id="__codelineno-26-320" name="__codelineno-26-320"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
<a id="__codelineno-26-321" name="__codelineno-26-321"></a>
<a id="__codelineno-26-322" name="__codelineno-26-322"></a><span class="n">game_screen</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-26-323" name="__codelineno-26-323"></a>
<a id="__codelineno-26-324" name="__codelineno-26-324"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-26-325" name="__codelineno-26-325"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<ul>
<li>Linhas 22 a 46: função que carrega os assets. É exatamente o mesmo código de antes, mas agora dentro de uma função;</li>
<li>Linhas 192 a 320: função que executa o loop principal. É exatamente o mesmo código de antes, mas agora dentro de uma função.</li>
</ul>
<h2 id="separando-o-codigo-em-arquivos-diferentes">Separando o código em arquivos diferentes</h2>
<p>Abra o arquivo <code class="language-python highlight"><span class="n">jogo_21</span><span class="o">.</span><span class="n">py</span></code>. Onde está todo aquele código? O código do arquivo <code class="language-python highlight"><span class="n">jogo_20</span><span class="o">.</span><span class="n">py</span></code> foi separado em 5 arquivos:</p>
<ul>
<li><code class="language-python highlight"><span class="n">jogo_21</span><span class="o">.</span><span class="n">py</span></code> - possui apenas a lógica mais geral do jogo: inicializa o pygame, chama a tela do jogo e finaliza o pygame;</li>
</ul>
<details class="info">
<summary>Código <code>referencia/jogo_v21.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-27-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-27-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-27-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-27-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-27-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-27-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-27-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-27-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-27-10">10</a></span>
<span class="normal"><a href="#__codelineno-27-11">11</a></span>
<span class="normal"><a href="#__codelineno-27-12">12</a></span>
<span class="normal"><a href="#__codelineno-27-13">13</a></span>
<span class="normal"><a href="#__codelineno-27-14">14</a></span>
<span class="normal"><a href="#__codelineno-27-15">15</a></span>
<span class="normal"><a href="#__codelineno-27-16">16</a></span>
<span class="normal"><a href="#__codelineno-27-17">17</a></span>
<span class="normal"><a href="#__codelineno-27-18">18</a></span>
<span class="normal"><a href="#__codelineno-27-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-27-3" name="__codelineno-27-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-27-4" name="__codelineno-27-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-27-5" name="__codelineno-27-5"></a><span class="kn">from</span> <span class="nn">config</span> <span class="kn">import</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span>
<a id="__codelineno-27-6" name="__codelineno-27-6"></a><span class="kn">from</span> <span class="nn">game_screen</span> <span class="kn">import</span> <span class="n">game_screen</span>
<a id="__codelineno-27-7" name="__codelineno-27-7"></a>
<a id="__codelineno-27-8" name="__codelineno-27-8"></a>
<a id="__codelineno-27-9" name="__codelineno-27-9"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-27-10" name="__codelineno-27-10"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-27-11" name="__codelineno-27-11"></a>
<a id="__codelineno-27-12" name="__codelineno-27-12"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-27-13" name="__codelineno-27-13"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-27-14" name="__codelineno-27-14"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-27-15" name="__codelineno-27-15"></a>
<a id="__codelineno-27-16" name="__codelineno-27-16"></a><span class="n">game_screen</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-27-17" name="__codelineno-27-17"></a>
<a id="__codelineno-27-18" name="__codelineno-27-18"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-27-19" name="__codelineno-27-19"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<ul>
<li><code class="language-python highlight"><span class="n">game_screen</span><span class="o">.</span><span class="n">py</span></code> - função com o loop principal do jogo;</li>
</ul>
<details class="info">
<summary>Código <code>referencia/game_screen.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1">  1</a></span>
<span class="normal"><a href="#__codelineno-28-2">  2</a></span>
<span class="normal"><a href="#__codelineno-28-3">  3</a></span>
<span class="normal"><a href="#__codelineno-28-4">  4</a></span>
<span class="normal"><a href="#__codelineno-28-5">  5</a></span>
<span class="normal"><a href="#__codelineno-28-6">  6</a></span>
<span class="normal"><a href="#__codelineno-28-7">  7</a></span>
<span class="normal"><a href="#__codelineno-28-8">  8</a></span>
<span class="normal"><a href="#__codelineno-28-9">  9</a></span>
<span class="normal"><a href="#__codelineno-28-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-28-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-28-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-28-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-28-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-28-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-28-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-28-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-28-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-28-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-28-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-28-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-28-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-28-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-28-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-28-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-28-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-28-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-28-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-28-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-28-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-28-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-28-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-28-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-28-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-28-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-28-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-28-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-28-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-28-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-28-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-28-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-28-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-28-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-28-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-28-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-28-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-28-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-28-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-28-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-28-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-28-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-28-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-28-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-28-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-28-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-28-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-28-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-28-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-28-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-28-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-28-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-28-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-28-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-28-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-28-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-28-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-28-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-28-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-28-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-28-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-28-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-28-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-28-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-28-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-28-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-28-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-28-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-28-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-28-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-28-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-28-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-28-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-28-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-28-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-28-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-28-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-28-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-28-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-28-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-28-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-28-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-28-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-28-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-28-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-28-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-28-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-28-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-28-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-28-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-28-100">100</a></span>
<span class="normal"><a href="#__codelineno-28-101">101</a></span>
<span class="normal"><a href="#__codelineno-28-102">102</a></span>
<span class="normal"><a href="#__codelineno-28-103">103</a></span>
<span class="normal"><a href="#__codelineno-28-104">104</a></span>
<span class="normal"><a href="#__codelineno-28-105">105</a></span>
<span class="normal"><a href="#__codelineno-28-106">106</a></span>
<span class="normal"><a href="#__codelineno-28-107">107</a></span>
<span class="normal"><a href="#__codelineno-28-108">108</a></span>
<span class="normal"><a href="#__codelineno-28-109">109</a></span>
<span class="normal"><a href="#__codelineno-28-110">110</a></span>
<span class="normal"><a href="#__codelineno-28-111">111</a></span>
<span class="normal"><a href="#__codelineno-28-112">112</a></span>
<span class="normal"><a href="#__codelineno-28-113">113</a></span>
<span class="normal"><a href="#__codelineno-28-114">114</a></span>
<span class="normal"><a href="#__codelineno-28-115">115</a></span>
<span class="normal"><a href="#__codelineno-28-116">116</a></span>
<span class="normal"><a href="#__codelineno-28-117">117</a></span>
<span class="normal"><a href="#__codelineno-28-118">118</a></span>
<span class="normal"><a href="#__codelineno-28-119">119</a></span>
<span class="normal"><a href="#__codelineno-28-120">120</a></span>
<span class="normal"><a href="#__codelineno-28-121">121</a></span>
<span class="normal"><a href="#__codelineno-28-122">122</a></span>
<span class="normal"><a href="#__codelineno-28-123">123</a></span>
<span class="normal"><a href="#__codelineno-28-124">124</a></span>
<span class="normal"><a href="#__codelineno-28-125">125</a></span>
<span class="normal"><a href="#__codelineno-28-126">126</a></span>
<span class="normal"><a href="#__codelineno-28-127">127</a></span>
<span class="normal"><a href="#__codelineno-28-128">128</a></span>
<span class="normal"><a href="#__codelineno-28-129">129</a></span>
<span class="normal"><a href="#__codelineno-28-130">130</a></span>
<span class="normal"><a href="#__codelineno-28-131">131</a></span>
<span class="normal"><a href="#__codelineno-28-132">132</a></span>
<span class="normal"><a href="#__codelineno-28-133">133</a></span>
<span class="normal"><a href="#__codelineno-28-134">134</a></span>
<span class="normal"><a href="#__codelineno-28-135">135</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="kn">from</span> <span class="nn">config</span> <span class="kn">import</span> <span class="n">FPS</span><span class="p">,</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">,</span> <span class="n">BLACK</span><span class="p">,</span> <span class="n">YELLOW</span><span class="p">,</span> <span class="n">RED</span>
<a id="__codelineno-28-3" name="__codelineno-28-3"></a><span class="kn">from</span> <span class="nn">assets</span> <span class="kn">import</span> <span class="n">load_assets</span><span class="p">,</span> <span class="n">DESTROY_SOUND</span><span class="p">,</span> <span class="n">BOOM_SOUND</span><span class="p">,</span> <span class="n">BACKGROUND</span><span class="p">,</span> <span class="n">SCORE_FONT</span>
<a id="__codelineno-28-4" name="__codelineno-28-4"></a><span class="kn">from</span> <span class="nn">sprites</span> <span class="kn">import</span> <span class="n">Ship</span><span class="p">,</span> <span class="n">Meteor</span><span class="p">,</span> <span class="n">Bullet</span><span class="p">,</span> <span class="n">Explosion</span>
<a id="__codelineno-28-5" name="__codelineno-28-5"></a>
<a id="__codelineno-28-6" name="__codelineno-28-6"></a>
<a id="__codelineno-28-7" name="__codelineno-28-7"></a><span class="k">def</span> <span class="nf">game_screen</span><span class="p">(</span><span class="n">window</span><span class="p">):</span>
<a id="__codelineno-28-8" name="__codelineno-28-8"></a>    <span class="c1"># Variável para o ajuste de velocidade</span>
<a id="__codelineno-28-9" name="__codelineno-28-9"></a>    <span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<a id="__codelineno-28-10" name="__codelineno-28-10"></a>
<a id="__codelineno-28-11" name="__codelineno-28-11"></a>    <span class="n">assets</span> <span class="o">=</span> <span class="n">load_assets</span><span class="p">()</span>
<a id="__codelineno-28-12" name="__codelineno-28-12"></a>
<a id="__codelineno-28-13" name="__codelineno-28-13"></a>    <span class="c1"># Criando um grupo de meteoros</span>
<a id="__codelineno-28-14" name="__codelineno-28-14"></a>    <span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-28-15" name="__codelineno-28-15"></a>    <span class="n">all_meteors</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-28-16" name="__codelineno-28-16"></a>    <span class="n">all_bullets</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<a id="__codelineno-28-17" name="__codelineno-28-17"></a>    <span class="n">groups</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-28-18" name="__codelineno-28-18"></a>    <span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_sprites&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_sprites</span>
<a id="__codelineno-28-19" name="__codelineno-28-19"></a>    <span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_meteors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_meteors</span>
<a id="__codelineno-28-20" name="__codelineno-28-20"></a>    <span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_bullets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_bullets</span>
<a id="__codelineno-28-21" name="__codelineno-28-21"></a>
<a id="__codelineno-28-22" name="__codelineno-28-22"></a>    <span class="c1"># Criando o jogador</span>
<a id="__codelineno-28-23" name="__codelineno-28-23"></a>    <span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-28-24" name="__codelineno-28-24"></a>    <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-28-25" name="__codelineno-28-25"></a>    <span class="c1"># Criando os meteoros</span>
<a id="__codelineno-28-26" name="__codelineno-28-26"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a id="__codelineno-28-27" name="__codelineno-28-27"></a>        <span class="n">meteor</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-28-28" name="__codelineno-28-28"></a>        <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-28-29" name="__codelineno-28-29"></a>        <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meteor</span><span class="p">)</span>
<a id="__codelineno-28-30" name="__codelineno-28-30"></a>
<a id="__codelineno-28-31" name="__codelineno-28-31"></a>    <span class="n">DONE</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-28-32" name="__codelineno-28-32"></a>    <span class="n">PLAYING</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-28-33" name="__codelineno-28-33"></a>    <span class="n">EXPLODING</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-28-34" name="__codelineno-28-34"></a>    <span class="n">state</span> <span class="o">=</span> <span class="n">PLAYING</span>
<a id="__codelineno-28-35" name="__codelineno-28-35"></a>
<a id="__codelineno-28-36" name="__codelineno-28-36"></a>    <span class="n">keys_down</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-28-37" name="__codelineno-28-37"></a>    <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-28-38" name="__codelineno-28-38"></a>    <span class="n">lives</span> <span class="o">=</span> <span class="mi">3</span>
<a id="__codelineno-28-39" name="__codelineno-28-39"></a>
<a id="__codelineno-28-40" name="__codelineno-28-40"></a>    <span class="c1"># ===== Loop principal =====</span>
<a id="__codelineno-28-41" name="__codelineno-28-41"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">loops</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-28-42" name="__codelineno-28-42"></a>    <span class="k">while</span> <span class="n">state</span> <span class="o">!=</span> <span class="n">DONE</span><span class="p">:</span>
<a id="__codelineno-28-43" name="__codelineno-28-43"></a>        <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
<a id="__codelineno-28-44" name="__codelineno-28-44"></a>
<a id="__codelineno-28-45" name="__codelineno-28-45"></a>        <span class="c1"># ----- Trata eventos</span>
<a id="__codelineno-28-46" name="__codelineno-28-46"></a>        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
<a id="__codelineno-28-47" name="__codelineno-28-47"></a>            <span class="c1"># ----- Verifica consequências</span>
<a id="__codelineno-28-48" name="__codelineno-28-48"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-28-49" name="__codelineno-28-49"></a>                <span class="n">state</span> <span class="o">=</span> <span class="n">DONE</span>
<a id="__codelineno-28-50" name="__codelineno-28-50"></a>            <span class="c1"># Só verifica o teclado se está no estado de jogo</span>
<a id="__codelineno-28-51" name="__codelineno-28-51"></a>            <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">PLAYING</span><span class="p">:</span>
<a id="__codelineno-28-52" name="__codelineno-28-52"></a>                <span class="c1"># Verifica se apertou alguma tecla.</span>
<a id="__codelineno-28-53" name="__codelineno-28-53"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYDOWN</span><span class="p">:</span>
<a id="__codelineno-28-54" name="__codelineno-28-54"></a>                    <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-28-55" name="__codelineno-28-55"></a>                    <span class="n">keys_down</span><span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-28-56" name="__codelineno-28-56"></a>                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-28-57" name="__codelineno-28-57"></a>                        <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-28-58" name="__codelineno-28-58"></a>                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-28-59" name="__codelineno-28-59"></a>                        <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-28-60" name="__codelineno-28-60"></a>                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_SPACE</span><span class="p">:</span>
<a id="__codelineno-28-61" name="__codelineno-28-61"></a>                        <span class="n">player</span><span class="o">.</span><span class="n">shoot</span><span class="p">()</span>
<a id="__codelineno-28-62" name="__codelineno-28-62"></a>                <span class="c1"># Verifica se soltou alguma tecla.</span>
<a id="__codelineno-28-63" name="__codelineno-28-63"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">KEYUP</span><span class="p">:</span>
<a id="__codelineno-28-64" name="__codelineno-28-64"></a>                    <span class="c1"># Dependendo da tecla, altera a velocidade.</span>
<a id="__codelineno-28-65" name="__codelineno-28-65"></a>                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="ow">in</span> <span class="n">keys_down</span> <span class="ow">and</span> <span class="n">keys_down</span><span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">]:</span>
<a id="__codelineno-28-66" name="__codelineno-28-66"></a>                        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">:</span>
<a id="__codelineno-28-67" name="__codelineno-28-67"></a>                            <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">+=</span> <span class="mi">8</span>
<a id="__codelineno-28-68" name="__codelineno-28-68"></a>                        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">:</span>
<a id="__codelineno-28-69" name="__codelineno-28-69"></a>                            <span class="n">player</span><span class="o">.</span><span class="n">speedx</span> <span class="o">-=</span> <span class="mi">8</span>
<a id="__codelineno-28-70" name="__codelineno-28-70"></a>
<a id="__codelineno-28-71" name="__codelineno-28-71"></a>        <span class="c1"># ----- Atualiza estado do jogo</span>
<a id="__codelineno-28-72" name="__codelineno-28-72"></a>        <span class="c1"># Atualizando a posição dos meteoros</span>
<a id="__codelineno-28-73" name="__codelineno-28-73"></a>        <span class="n">all_sprites</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a id="__codelineno-28-74" name="__codelineno-28-74"></a>
<a id="__codelineno-28-75" name="__codelineno-28-75"></a>        <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">PLAYING</span><span class="p">:</span>
<a id="__codelineno-28-76" name="__codelineno-28-76"></a>            <span class="c1"># Verifica se houve colisão entre tiro e meteoro</span>
<a id="__codelineno-28-77" name="__codelineno-28-77"></a>            <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">groupcollide</span><span class="p">(</span><span class="n">all_meteors</span><span class="p">,</span> <span class="n">all_bullets</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">collide_mask</span><span class="p">)</span>
<a id="__codelineno-28-78" name="__codelineno-28-78"></a>            <span class="k">for</span> <span class="n">meteor</span> <span class="ow">in</span> <span class="n">hits</span><span class="p">:</span> <span class="c1"># As chaves são os elementos do primeiro grupo (meteoros) que colidiram com alguma bala</span>
<a id="__codelineno-28-79" name="__codelineno-28-79"></a>                <span class="c1"># O meteoro e destruido e precisa ser recriado</span>
<a id="__codelineno-28-80" name="__codelineno-28-80"></a>                <span class="n">assets</span><span class="p">[</span><span class="n">DESTROY_SOUND</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-28-81" name="__codelineno-28-81"></a>                <span class="n">m</span> <span class="o">=</span> <span class="n">Meteor</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-28-82" name="__codelineno-28-82"></a>                <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-28-83" name="__codelineno-28-83"></a>                <span class="n">all_meteors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-28-84" name="__codelineno-28-84"></a>
<a id="__codelineno-28-85" name="__codelineno-28-85"></a>                <span class="c1"># No lugar do meteoro antigo, adicionar uma explosão.</span>
<a id="__codelineno-28-86" name="__codelineno-28-86"></a>                <span class="n">explosao</span> <span class="o">=</span> <span class="n">Explosion</span><span class="p">(</span><span class="n">meteor</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-28-87" name="__codelineno-28-87"></a>                <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">explosao</span><span class="p">)</span>
<a id="__codelineno-28-88" name="__codelineno-28-88"></a>
<a id="__codelineno-28-89" name="__codelineno-28-89"></a>                <span class="c1"># Ganhou pontos!</span>
<a id="__codelineno-28-90" name="__codelineno-28-90"></a>                <span class="n">score</span> <span class="o">+=</span> <span class="mi">100</span>
<a id="__codelineno-28-91" name="__codelineno-28-91"></a>                <span class="k">if</span> <span class="n">score</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-28-92" name="__codelineno-28-92"></a>                    <span class="n">lives</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-28-93" name="__codelineno-28-93"></a>
<a id="__codelineno-28-94" name="__codelineno-28-94"></a>            <span class="c1"># Verifica se houve colisão entre nave e meteoro</span>
<a id="__codelineno-28-95" name="__codelineno-28-95"></a>            <span class="n">hits</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">spritecollide</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">all_meteors</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">collide_mask</span><span class="p">)</span>
<a id="__codelineno-28-96" name="__codelineno-28-96"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hits</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-28-97" name="__codelineno-28-97"></a>                <span class="c1"># Toca o som da colisão</span>
<a id="__codelineno-28-98" name="__codelineno-28-98"></a>                <span class="n">assets</span><span class="p">[</span><span class="n">BOOM_SOUND</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-28-99" name="__codelineno-28-99"></a>                <span class="n">player</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-28-100" name="__codelineno-28-100"></a>                <span class="n">lives</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-28-101" name="__codelineno-28-101"></a>                <span class="n">explosao</span> <span class="o">=</span> <span class="n">Explosion</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-28-102" name="__codelineno-28-102"></a>                <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">explosao</span><span class="p">)</span>
<a id="__codelineno-28-103" name="__codelineno-28-103"></a>                <span class="n">state</span> <span class="o">=</span> <span class="n">EXPLODING</span>
<a id="__codelineno-28-104" name="__codelineno-28-104"></a>                <span class="n">keys_down</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-28-105" name="__codelineno-28-105"></a>                <span class="n">explosion_tick</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-28-106" name="__codelineno-28-106"></a>                <span class="n">explosion_duration</span> <span class="o">=</span> <span class="n">explosao</span><span class="o">.</span><span class="n">frame_ticks</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">explosao</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">)</span> <span class="o">+</span> <span class="mi">400</span>
<a id="__codelineno-28-107" name="__codelineno-28-107"></a>        <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="n">EXPLODING</span><span class="p">:</span>
<a id="__codelineno-28-108" name="__codelineno-28-108"></a>            <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-28-109" name="__codelineno-28-109"></a>            <span class="k">if</span> <span class="n">now</span> <span class="o">-</span> <span class="n">explosion_tick</span> <span class="o">&gt;</span> <span class="n">explosion_duration</span><span class="p">:</span>
<a id="__codelineno-28-110" name="__codelineno-28-110"></a>                <span class="k">if</span> <span class="n">lives</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-28-111" name="__codelineno-28-111"></a>                    <span class="n">state</span> <span class="o">=</span> <span class="n">DONE</span>
<a id="__codelineno-28-112" name="__codelineno-28-112"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-28-113" name="__codelineno-28-113"></a>                    <span class="n">state</span> <span class="o">=</span> <span class="n">PLAYING</span>
<a id="__codelineno-28-114" name="__codelineno-28-114"></a>                    <span class="n">player</span> <span class="o">=</span> <span class="n">Ship</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">)</span>
<a id="__codelineno-28-115" name="__codelineno-28-115"></a>                    <span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-28-116" name="__codelineno-28-116"></a>
<a id="__codelineno-28-117" name="__codelineno-28-117"></a>        <span class="c1"># ----- Gera saídas</span>
<a id="__codelineno-28-118" name="__codelineno-28-118"></a>        <span class="n">window</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">BLACK</span><span class="p">)</span>  <span class="c1"># Preenche com a cor branca</span>
<a id="__codelineno-28-119" name="__codelineno-28-119"></a>        <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="n">BACKGROUND</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-28-120" name="__codelineno-28-120"></a>        <span class="c1"># Desenhando meteoros</span>
<a id="__codelineno-28-121" name="__codelineno-28-121"></a>        <span class="n">all_sprites</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-28-122" name="__codelineno-28-122"></a>
<a id="__codelineno-28-123" name="__codelineno-28-123"></a>        <span class="c1"># Desenhando o score</span>
<a id="__codelineno-28-124" name="__codelineno-28-124"></a>        <span class="n">text_surface</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="n">SCORE_FONT</span><span class="p">]</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:08d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">score</span><span class="p">),</span> <span class="kc">True</span><span class="p">,</span> <span class="n">YELLOW</span><span class="p">)</span>
<a id="__codelineno-28-125" name="__codelineno-28-125"></a>        <span class="n">text_rect</span> <span class="o">=</span> <span class="n">text_surface</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-28-126" name="__codelineno-28-126"></a>        <span class="n">text_rect</span><span class="o">.</span><span class="n">midtop</span> <span class="o">=</span> <span class="p">(</span><span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-28-127" name="__codelineno-28-127"></a>        <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">text_surface</span><span class="p">,</span> <span class="n">text_rect</span><span class="p">)</span>
<a id="__codelineno-28-128" name="__codelineno-28-128"></a>
<a id="__codelineno-28-129" name="__codelineno-28-129"></a>        <span class="c1"># Desenhando as vidas</span>
<a id="__codelineno-28-130" name="__codelineno-28-130"></a>        <span class="n">text_surface</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="n">SCORE_FONT</span><span class="p">]</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="mi">9829</span><span class="p">)</span> <span class="o">*</span> <span class="n">lives</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">RED</span><span class="p">)</span>
<a id="__codelineno-28-131" name="__codelineno-28-131"></a>        <span class="n">text_rect</span> <span class="o">=</span> <span class="n">text_surface</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-28-132" name="__codelineno-28-132"></a>        <span class="n">text_rect</span><span class="o">.</span><span class="n">bottomleft</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-28-133" name="__codelineno-28-133"></a>        <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">text_surface</span><span class="p">,</span> <span class="n">text_rect</span><span class="p">)</span>
<a id="__codelineno-28-134" name="__codelineno-28-134"></a>
<a id="__codelineno-28-135" name="__codelineno-28-135"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Mostra o novo frame para o jogador</span>
</code></pre></div></td></tr></table></div>
</details>
<ul>
<li><code class="language-python highlight"><span class="n">sprites</span><span class="o">.</span><span class="n">py</span></code> - definição das classes do jogo;</li>
</ul>
<details class="info">
<summary>referencia/sprites.py</summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">  1</a></span>
<span class="normal"><a href="#__codelineno-29-2">  2</a></span>
<span class="normal"><a href="#__codelineno-29-3">  3</a></span>
<span class="normal"><a href="#__codelineno-29-4">  4</a></span>
<span class="normal"><a href="#__codelineno-29-5">  5</a></span>
<span class="normal"><a href="#__codelineno-29-6">  6</a></span>
<span class="normal"><a href="#__codelineno-29-7">  7</a></span>
<span class="normal"><a href="#__codelineno-29-8">  8</a></span>
<span class="normal"><a href="#__codelineno-29-9">  9</a></span>
<span class="normal"><a href="#__codelineno-29-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-29-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-29-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-29-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-29-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-29-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-29-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-29-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-29-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-29-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-29-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-29-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-29-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-29-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-29-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-29-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-29-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-29-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-29-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-29-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-29-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-29-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-29-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-29-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-29-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-29-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-29-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-29-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-29-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-29-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-29-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-29-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-29-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-29-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-29-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-29-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-29-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-29-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-29-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-29-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-29-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-29-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-29-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-29-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-29-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-29-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-29-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-29-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-29-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-29-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-29-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-29-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-29-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-29-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-29-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-29-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-29-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-29-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-29-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-29-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-29-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-29-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-29-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-29-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-29-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-29-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-29-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-29-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-29-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-29-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-29-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-29-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-29-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-29-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-29-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-29-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-29-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-29-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-29-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-29-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-29-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-29-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-29-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-29-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-29-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-29-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-29-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-29-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-29-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-29-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-29-100">100</a></span>
<span class="normal"><a href="#__codelineno-29-101">101</a></span>
<span class="normal"><a href="#__codelineno-29-102">102</a></span>
<span class="normal"><a href="#__codelineno-29-103">103</a></span>
<span class="normal"><a href="#__codelineno-29-104">104</a></span>
<span class="normal"><a href="#__codelineno-29-105">105</a></span>
<span class="normal"><a href="#__codelineno-29-106">106</a></span>
<span class="normal"><a href="#__codelineno-29-107">107</a></span>
<span class="normal"><a href="#__codelineno-29-108">108</a></span>
<span class="normal"><a href="#__codelineno-29-109">109</a></span>
<span class="normal"><a href="#__codelineno-29-110">110</a></span>
<span class="normal"><a href="#__codelineno-29-111">111</a></span>
<span class="normal"><a href="#__codelineno-29-112">112</a></span>
<span class="normal"><a href="#__codelineno-29-113">113</a></span>
<span class="normal"><a href="#__codelineno-29-114">114</a></span>
<span class="normal"><a href="#__codelineno-29-115">115</a></span>
<span class="normal"><a href="#__codelineno-29-116">116</a></span>
<span class="normal"><a href="#__codelineno-29-117">117</a></span>
<span class="normal"><a href="#__codelineno-29-118">118</a></span>
<span class="normal"><a href="#__codelineno-29-119">119</a></span>
<span class="normal"><a href="#__codelineno-29-120">120</a></span>
<span class="normal"><a href="#__codelineno-29-121">121</a></span>
<span class="normal"><a href="#__codelineno-29-122">122</a></span>
<span class="normal"><a href="#__codelineno-29-123">123</a></span>
<span class="normal"><a href="#__codelineno-29-124">124</a></span>
<span class="normal"><a href="#__codelineno-29-125">125</a></span>
<span class="normal"><a href="#__codelineno-29-126">126</a></span>
<span class="normal"><a href="#__codelineno-29-127">127</a></span>
<span class="normal"><a href="#__codelineno-29-128">128</a></span>
<span class="normal"><a href="#__codelineno-29-129">129</a></span>
<span class="normal"><a href="#__codelineno-29-130">130</a></span>
<span class="normal"><a href="#__codelineno-29-131">131</a></span>
<span class="normal"><a href="#__codelineno-29-132">132</a></span>
<span class="normal"><a href="#__codelineno-29-133">133</a></span>
<span class="normal"><a href="#__codelineno-29-134">134</a></span>
<span class="normal"><a href="#__codelineno-29-135">135</a></span>
<span class="normal"><a href="#__codelineno-29-136">136</a></span>
<span class="normal"><a href="#__codelineno-29-137">137</a></span>
<span class="normal"><a href="#__codelineno-29-138">138</a></span>
<span class="normal"><a href="#__codelineno-29-139">139</a></span>
<span class="normal"><a href="#__codelineno-29-140">140</a></span>
<span class="normal"><a href="#__codelineno-29-141">141</a></span>
<span class="normal"><a href="#__codelineno-29-142">142</a></span>
<span class="normal"><a href="#__codelineno-29-143">143</a></span>
<span class="normal"><a href="#__codelineno-29-144">144</a></span>
<span class="normal"><a href="#__codelineno-29-145">145</a></span>
<span class="normal"><a href="#__codelineno-29-146">146</a></span>
<span class="normal"><a href="#__codelineno-29-147">147</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="kn">from</span> <span class="nn">config</span> <span class="kn">import</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">,</span> <span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">,</span> <span class="n">SHIP_WIDTH</span><span class="p">,</span> <span class="n">SHIP_HEIGHT</span>
<a id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="kn">from</span> <span class="nn">assets</span> <span class="kn">import</span> <span class="n">SHIP_IMG</span><span class="p">,</span> <span class="n">PEW_SOUND</span><span class="p">,</span> <span class="n">METEOR_IMG</span><span class="p">,</span> <span class="n">BULLET_IMG</span><span class="p">,</span> <span class="n">EXPLOSION_ANIM</span>
<a id="__codelineno-29-5" name="__codelineno-29-5"></a>
<a id="__codelineno-29-6" name="__codelineno-29-6"></a>
<a id="__codelineno-29-7" name="__codelineno-29-7"></a><span class="k">class</span> <span class="nc">Ship</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-29-8" name="__codelineno-29-8"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-29-9" name="__codelineno-29-9"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-29-10" name="__codelineno-29-10"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-29-11" name="__codelineno-29-11"></a>
<a id="__codelineno-29-12" name="__codelineno-29-12"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="n">SHIP_IMG</span><span class="p">]</span>
<a id="__codelineno-29-13" name="__codelineno-29-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">from_surface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
<a id="__codelineno-29-14" name="__codelineno-29-14"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-29-15" name="__codelineno-29-15"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-29-16" name="__codelineno-29-16"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">HEIGHT</span> <span class="o">-</span> <span class="mi">10</span>
<a id="__codelineno-29-17" name="__codelineno-29-17"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-29-18" name="__codelineno-29-18"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="o">=</span> <span class="n">groups</span>
<a id="__codelineno-29-19" name="__codelineno-29-19"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assets</span> <span class="o">=</span> <span class="n">assets</span>
<a id="__codelineno-29-20" name="__codelineno-29-20"></a>
<a id="__codelineno-29-21" name="__codelineno-29-21"></a>        <span class="c1"># Só será possível atirar uma vez a cada 500 milissegundos</span>
<a id="__codelineno-29-22" name="__codelineno-29-22"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-29-23" name="__codelineno-29-23"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shoot_ticks</span> <span class="o">=</span> <span class="mi">500</span>
<a id="__codelineno-29-24" name="__codelineno-29-24"></a>
<a id="__codelineno-29-25" name="__codelineno-29-25"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-29-26" name="__codelineno-29-26"></a>        <span class="c1"># Atualização da posição da nave</span>
<a id="__codelineno-29-27" name="__codelineno-29-27"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-29-28" name="__codelineno-29-28"></a>
<a id="__codelineno-29-29" name="__codelineno-29-29"></a>        <span class="c1"># Mantem dentro da tela</span>
<a id="__codelineno-29-30" name="__codelineno-29-30"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-29-31" name="__codelineno-29-31"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">WIDTH</span>
<a id="__codelineno-29-32" name="__codelineno-29-32"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-29-33" name="__codelineno-29-33"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-29-34" name="__codelineno-29-34"></a>
<a id="__codelineno-29-35" name="__codelineno-29-35"></a>    <span class="k">def</span> <span class="nf">shoot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-29-36" name="__codelineno-29-36"></a>        <span class="c1"># Verifica se pode atirar</span>
<a id="__codelineno-29-37" name="__codelineno-29-37"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-29-38" name="__codelineno-29-38"></a>        <span class="c1"># Verifica quantos ticks se passaram desde o último tiro.</span>
<a id="__codelineno-29-39" name="__codelineno-29-39"></a>        <span class="n">elapsed_ticks</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span>
<a id="__codelineno-29-40" name="__codelineno-29-40"></a>
<a id="__codelineno-29-41" name="__codelineno-29-41"></a>        <span class="c1"># Se já pode atirar novamente...</span>
<a id="__codelineno-29-42" name="__codelineno-29-42"></a>        <span class="k">if</span> <span class="n">elapsed_ticks</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">shoot_ticks</span><span class="p">:</span>
<a id="__codelineno-29-43" name="__codelineno-29-43"></a>            <span class="c1"># Marca o tick da nova imagem.</span>
<a id="__codelineno-29-44" name="__codelineno-29-44"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_shot</span> <span class="o">=</span> <span class="n">now</span>
<a id="__codelineno-29-45" name="__codelineno-29-45"></a>            <span class="c1"># A nova bala vai ser criada logo acima e no centro horizontal da nave</span>
<a id="__codelineno-29-46" name="__codelineno-29-46"></a>            <span class="n">new_bullet</span> <span class="o">=</span> <span class="n">Bullet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span><span class="p">)</span>
<a id="__codelineno-29-47" name="__codelineno-29-47"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_sprites&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-29-48" name="__codelineno-29-48"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;all_bullets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_bullet</span><span class="p">)</span>
<a id="__codelineno-29-49" name="__codelineno-29-49"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="n">PEW_SOUND</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-29-50" name="__codelineno-29-50"></a>
<a id="__codelineno-29-51" name="__codelineno-29-51"></a><span class="k">class</span> <span class="nc">Meteor</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-29-52" name="__codelineno-29-52"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-29-53" name="__codelineno-29-53"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-29-54" name="__codelineno-29-54"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-29-55" name="__codelineno-29-55"></a>
<a id="__codelineno-29-56" name="__codelineno-29-56"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="n">METEOR_IMG</span><span class="p">]</span>
<a id="__codelineno-29-57" name="__codelineno-29-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">from_surface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
<a id="__codelineno-29-58" name="__codelineno-29-58"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-29-59" name="__codelineno-29-59"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-29-60" name="__codelineno-29-60"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-29-61" name="__codelineno-29-61"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-29-62" name="__codelineno-29-62"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-29-63" name="__codelineno-29-63"></a>
<a id="__codelineno-29-64" name="__codelineno-29-64"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-29-65" name="__codelineno-29-65"></a>        <span class="c1"># Atualizando a posição do meteoro</span>
<a id="__codelineno-29-66" name="__codelineno-29-66"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span>
<a id="__codelineno-29-67" name="__codelineno-29-67"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-29-68" name="__codelineno-29-68"></a>        <span class="c1"># Se o meteoro passar do final da tela, volta para cima e sorteia</span>
<a id="__codelineno-29-69" name="__codelineno-29-69"></a>        <span class="c1"># novas posições e velocidades</span>
<a id="__codelineno-29-70" name="__codelineno-29-70"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">HEIGHT</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">WIDTH</span><span class="p">:</span>
<a id="__codelineno-29-71" name="__codelineno-29-71"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="o">-</span><span class="n">METEOR_WIDTH</span><span class="p">)</span>
<a id="__codelineno-29-72" name="__codelineno-29-72"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="n">METEOR_HEIGHT</span><span class="p">)</span>
<a id="__codelineno-29-73" name="__codelineno-29-73"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-29-74" name="__codelineno-29-74"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-29-75" name="__codelineno-29-75"></a>
<a id="__codelineno-29-76" name="__codelineno-29-76"></a><span class="c1"># Classe Bullet que representa os tiros</span>
<a id="__codelineno-29-77" name="__codelineno-29-77"></a><span class="k">class</span> <span class="nc">Bullet</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-29-78" name="__codelineno-29-78"></a>    <span class="c1"># Construtor da classe.</span>
<a id="__codelineno-29-79" name="__codelineno-29-79"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assets</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">centerx</span><span class="p">):</span>
<a id="__codelineno-29-80" name="__codelineno-29-80"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-29-81" name="__codelineno-29-81"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-29-82" name="__codelineno-29-82"></a>
<a id="__codelineno-29-83" name="__codelineno-29-83"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="n">BULLET_IMG</span><span class="p">]</span>
<a id="__codelineno-29-84" name="__codelineno-29-84"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">from_surface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
<a id="__codelineno-29-85" name="__codelineno-29-85"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-29-86" name="__codelineno-29-86"></a>
<a id="__codelineno-29-87" name="__codelineno-29-87"></a>        <span class="c1"># Coloca no lugar inicial definido em x, y do constutor</span>
<a id="__codelineno-29-88" name="__codelineno-29-88"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">centerx</span> <span class="o">=</span> <span class="n">centerx</span>
<a id="__codelineno-29-89" name="__codelineno-29-89"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">bottom</span>
<a id="__codelineno-29-90" name="__codelineno-29-90"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>  <span class="c1"># Velocidade fixa para cima</span>
<a id="__codelineno-29-91" name="__codelineno-29-91"></a>
<a id="__codelineno-29-92" name="__codelineno-29-92"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-29-93" name="__codelineno-29-93"></a>        <span class="c1"># A bala só se move no eixo y</span>
<a id="__codelineno-29-94" name="__codelineno-29-94"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speedy</span>
<a id="__codelineno-29-95" name="__codelineno-29-95"></a>
<a id="__codelineno-29-96" name="__codelineno-29-96"></a>        <span class="c1"># Se o tiro passar do inicio da tela, morre.</span>
<a id="__codelineno-29-97" name="__codelineno-29-97"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-29-98" name="__codelineno-29-98"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-29-99" name="__codelineno-29-99"></a>
<a id="__codelineno-29-100" name="__codelineno-29-100"></a><span class="c1"># Classe que representa uma explosão de meteoro</span>
<a id="__codelineno-29-101" name="__codelineno-29-101"></a><span class="k">class</span> <span class="nc">Explosion</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
<a id="__codelineno-29-102" name="__codelineno-29-102"></a>    <span class="c1"># Construtor da classe.</span>
<a id="__codelineno-29-103" name="__codelineno-29-103"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">assets</span><span class="p">):</span>
<a id="__codelineno-29-104" name="__codelineno-29-104"></a>        <span class="c1"># Construtor da classe mãe (Sprite).</span>
<a id="__codelineno-29-105" name="__codelineno-29-105"></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-29-106" name="__codelineno-29-106"></a>
<a id="__codelineno-29-107" name="__codelineno-29-107"></a>        <span class="c1"># Armazena a animação de explosão</span>
<a id="__codelineno-29-108" name="__codelineno-29-108"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span> <span class="o">=</span> <span class="n">assets</span><span class="p">[</span><span class="n">EXPLOSION_ANIM</span><span class="p">]</span>
<a id="__codelineno-29-109" name="__codelineno-29-109"></a>
<a id="__codelineno-29-110" name="__codelineno-29-110"></a>        <span class="c1"># Inicia o processo de animação colocando a primeira imagem na tela.</span>
<a id="__codelineno-29-111" name="__codelineno-29-111"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Armazena o índice atual na animação</span>
<a id="__codelineno-29-112" name="__codelineno-29-112"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span>  <span class="c1"># Pega a primeira imagem</span>
<a id="__codelineno-29-113" name="__codelineno-29-113"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-29-114" name="__codelineno-29-114"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>  <span class="c1"># Posiciona o centro da imagem</span>
<a id="__codelineno-29-115" name="__codelineno-29-115"></a>
<a id="__codelineno-29-116" name="__codelineno-29-116"></a>        <span class="c1"># Guarda o tick da primeira imagem, ou seja, o momento em que a imagem foi mostrada</span>
<a id="__codelineno-29-117" name="__codelineno-29-117"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-29-118" name="__codelineno-29-118"></a>
<a id="__codelineno-29-119" name="__codelineno-29-119"></a>        <span class="c1"># Controle de ticks de animação: troca de imagem a cada self.frame_ticks milissegundos.</span>
<a id="__codelineno-29-120" name="__codelineno-29-120"></a>        <span class="c1"># Quando pygame.time.get_ticks() - self.last_update &gt; self.frame_ticks a</span>
<a id="__codelineno-29-121" name="__codelineno-29-121"></a>        <span class="c1"># próxima imagem da animação será mostrada</span>
<a id="__codelineno-29-122" name="__codelineno-29-122"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frame_ticks</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-29-123" name="__codelineno-29-123"></a>
<a id="__codelineno-29-124" name="__codelineno-29-124"></a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-29-125" name="__codelineno-29-125"></a>        <span class="c1"># Verifica o tick atual.</span>
<a id="__codelineno-29-126" name="__codelineno-29-126"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-29-127" name="__codelineno-29-127"></a>        <span class="c1"># Verifica quantos ticks se passaram desde a ultima mudança de frame.</span>
<a id="__codelineno-29-128" name="__codelineno-29-128"></a>        <span class="n">elapsed_ticks</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span>
<a id="__codelineno-29-129" name="__codelineno-29-129"></a>
<a id="__codelineno-29-130" name="__codelineno-29-130"></a>        <span class="c1"># Se já está na hora de mudar de imagem...</span>
<a id="__codelineno-29-131" name="__codelineno-29-131"></a>        <span class="k">if</span> <span class="n">elapsed_ticks</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_ticks</span><span class="p">:</span>
<a id="__codelineno-29-132" name="__codelineno-29-132"></a>            <span class="c1"># Marca o tick da nova imagem.</span>
<a id="__codelineno-29-133" name="__codelineno-29-133"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_update</span> <span class="o">=</span> <span class="n">now</span>
<a id="__codelineno-29-134" name="__codelineno-29-134"></a>
<a id="__codelineno-29-135" name="__codelineno-29-135"></a>            <span class="c1"># Avança um quadro.</span>
<a id="__codelineno-29-136" name="__codelineno-29-136"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-29-137" name="__codelineno-29-137"></a>
<a id="__codelineno-29-138" name="__codelineno-29-138"></a>            <span class="c1"># Verifica se já chegou no final da animação.</span>
<a id="__codelineno-29-139" name="__codelineno-29-139"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">):</span>
<a id="__codelineno-29-140" name="__codelineno-29-140"></a>                <span class="c1"># Se sim, tchau explosão!</span>
<a id="__codelineno-29-141" name="__codelineno-29-141"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
<a id="__codelineno-29-142" name="__codelineno-29-142"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-29-143" name="__codelineno-29-143"></a>                <span class="c1"># Se ainda não chegou ao fim da explosão, troca de imagem.</span>
<a id="__codelineno-29-144" name="__codelineno-29-144"></a>                <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span>
<a id="__codelineno-29-145" name="__codelineno-29-145"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explosion_anim</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span>
<a id="__codelineno-29-146" name="__codelineno-29-146"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
<a id="__codelineno-29-147" name="__codelineno-29-147"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
</code></pre></div></td></tr></table></div>
</details>
<ul>
<li><code class="language-python highlight"><span class="n">assets</span><span class="o">.</span><span class="n">py</span></code> - função de carregamento de assets do jogo;</li>
</ul>
<details class="info">
<summary>Código <code>referencia/assets.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-30-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-30-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-30-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-30-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-30-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-30-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-30-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-30-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-30-10">10</a></span>
<span class="normal"><a href="#__codelineno-30-11">11</a></span>
<span class="normal"><a href="#__codelineno-30-12">12</a></span>
<span class="normal"><a href="#__codelineno-30-13">13</a></span>
<span class="normal"><a href="#__codelineno-30-14">14</a></span>
<span class="normal"><a href="#__codelineno-30-15">15</a></span>
<span class="normal"><a href="#__codelineno-30-16">16</a></span>
<span class="normal"><a href="#__codelineno-30-17">17</a></span>
<span class="normal"><a href="#__codelineno-30-18">18</a></span>
<span class="normal"><a href="#__codelineno-30-19">19</a></span>
<span class="normal"><a href="#__codelineno-30-20">20</a></span>
<span class="normal"><a href="#__codelineno-30-21">21</a></span>
<span class="normal"><a href="#__codelineno-30-22">22</a></span>
<span class="normal"><a href="#__codelineno-30-23">23</a></span>
<span class="normal"><a href="#__codelineno-30-24">24</a></span>
<span class="normal"><a href="#__codelineno-30-25">25</a></span>
<span class="normal"><a href="#__codelineno-30-26">26</a></span>
<span class="normal"><a href="#__codelineno-30-27">27</a></span>
<span class="normal"><a href="#__codelineno-30-28">28</a></span>
<span class="normal"><a href="#__codelineno-30-29">29</a></span>
<span class="normal"><a href="#__codelineno-30-30">30</a></span>
<span class="normal"><a href="#__codelineno-30-31">31</a></span>
<span class="normal"><a href="#__codelineno-30-32">32</a></span>
<span class="normal"><a href="#__codelineno-30-33">33</a></span>
<span class="normal"><a href="#__codelineno-30-34">34</a></span>
<span class="normal"><a href="#__codelineno-30-35">35</a></span>
<span class="normal"><a href="#__codelineno-30-36">36</a></span>
<span class="normal"><a href="#__codelineno-30-37">37</a></span>
<span class="normal"><a href="#__codelineno-30-38">38</a></span>
<span class="normal"><a href="#__codelineno-30-39">39</a></span>
<span class="normal"><a href="#__codelineno-30-40">40</a></span>
<span class="normal"><a href="#__codelineno-30-41">41</a></span>
<span class="normal"><a href="#__codelineno-30-42">42</a></span>
<span class="normal"><a href="#__codelineno-30-43">43</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="kn">import</span> <span class="nn">os</span>
<a id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="kn">from</span> <span class="nn">config</span> <span class="kn">import</span> <span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">,</span> <span class="n">SHIP_WIDTH</span><span class="p">,</span> <span class="n">SHIP_HEIGHT</span><span class="p">,</span> <span class="n">IMG_DIR</span><span class="p">,</span> <span class="n">SND_DIR</span><span class="p">,</span> <span class="n">FNT_DIR</span>
<a id="__codelineno-30-4" name="__codelineno-30-4"></a>
<a id="__codelineno-30-5" name="__codelineno-30-5"></a>
<a id="__codelineno-30-6" name="__codelineno-30-6"></a><span class="n">BACKGROUND</span> <span class="o">=</span> <span class="s1">&#39;background&#39;</span>
<a id="__codelineno-30-7" name="__codelineno-30-7"></a><span class="n">METEOR_IMG</span> <span class="o">=</span> <span class="s1">&#39;meteor_img&#39;</span>
<a id="__codelineno-30-8" name="__codelineno-30-8"></a><span class="n">METEOR_IMG</span> <span class="o">=</span> <span class="s1">&#39;meteor_img&#39;</span>
<a id="__codelineno-30-9" name="__codelineno-30-9"></a><span class="n">SHIP_IMG</span> <span class="o">=</span> <span class="s1">&#39;ship_img&#39;</span>
<a id="__codelineno-30-10" name="__codelineno-30-10"></a><span class="n">SHIP_IMG</span> <span class="o">=</span> <span class="s1">&#39;ship_img&#39;</span>
<a id="__codelineno-30-11" name="__codelineno-30-11"></a><span class="n">BULLET_IMG</span> <span class="o">=</span> <span class="s1">&#39;bullet_img&#39;</span>
<a id="__codelineno-30-12" name="__codelineno-30-12"></a><span class="n">EXPLOSION_ANIM</span> <span class="o">=</span> <span class="s1">&#39;explosion_anim&#39;</span>
<a id="__codelineno-30-13" name="__codelineno-30-13"></a><span class="n">SCORE_FONT</span> <span class="o">=</span> <span class="s1">&#39;score_font&#39;</span>
<a id="__codelineno-30-14" name="__codelineno-30-14"></a><span class="n">BOOM_SOUND</span> <span class="o">=</span> <span class="s1">&#39;boom_sound&#39;</span>
<a id="__codelineno-30-15" name="__codelineno-30-15"></a><span class="n">DESTROY_SOUND</span> <span class="o">=</span> <span class="s1">&#39;destroy_sound&#39;</span>
<a id="__codelineno-30-16" name="__codelineno-30-16"></a><span class="n">PEW_SOUND</span> <span class="o">=</span> <span class="s1">&#39;pew_sound&#39;</span>
<a id="__codelineno-30-17" name="__codelineno-30-17"></a>
<a id="__codelineno-30-18" name="__codelineno-30-18"></a>
<a id="__codelineno-30-19" name="__codelineno-30-19"></a><span class="k">def</span> <span class="nf">load_assets</span><span class="p">():</span>
<a id="__codelineno-30-20" name="__codelineno-30-20"></a>    <span class="n">assets</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-30-21" name="__codelineno-30-21"></a>    <span class="n">assets</span><span class="p">[</span><span class="n">BACKGROUND</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IMG_DIR</span><span class="p">,</span> <span class="s1">&#39;starfield.png&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-30-22" name="__codelineno-30-22"></a>    <span class="n">assets</span><span class="p">[</span><span class="n">METEOR_IMG</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IMG_DIR</span><span class="p">,</span> <span class="s1">&#39;meteorBrown_med1.png&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-30-23" name="__codelineno-30-23"></a>    <span class="n">assets</span><span class="p">[</span><span class="n">METEOR_IMG</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;meteor_img&#39;</span><span class="p">],</span> <span class="p">(</span><span class="n">METEOR_WIDTH</span><span class="p">,</span> <span class="n">METEOR_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-30-24" name="__codelineno-30-24"></a>    <span class="n">assets</span><span class="p">[</span><span class="n">SHIP_IMG</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IMG_DIR</span><span class="p">,</span> <span class="s1">&#39;playerShip1_orange.png&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-30-25" name="__codelineno-30-25"></a>    <span class="n">assets</span><span class="p">[</span><span class="n">SHIP_IMG</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="s1">&#39;ship_img&#39;</span><span class="p">],</span> <span class="p">(</span><span class="n">SHIP_WIDTH</span><span class="p">,</span> <span class="n">SHIP_HEIGHT</span><span class="p">))</span>
<a id="__codelineno-30-26" name="__codelineno-30-26"></a>    <span class="n">assets</span><span class="p">[</span><span class="n">BULLET_IMG</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IMG_DIR</span><span class="p">,</span> <span class="s1">&#39;laserRed16.png&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
<a id="__codelineno-30-27" name="__codelineno-30-27"></a>    <span class="n">explosion_anim</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-30-28" name="__codelineno-30-28"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
<a id="__codelineno-30-29" name="__codelineno-30-29"></a>        <span class="c1"># Os arquivos de animação são numerados de 00 a 08</span>
<a id="__codelineno-30-30" name="__codelineno-30-30"></a>        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IMG_DIR</span><span class="p">,</span> <span class="s1">&#39;regularExplosion0</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a id="__codelineno-30-31" name="__codelineno-30-31"></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-30-32" name="__codelineno-30-32"></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
<a id="__codelineno-30-33" name="__codelineno-30-33"></a>        <span class="n">explosion_anim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<a id="__codelineno-30-34" name="__codelineno-30-34"></a>    <span class="n">assets</span><span class="p">[</span><span class="n">EXPLOSION_ANIM</span><span class="p">]</span> <span class="o">=</span> <span class="n">explosion_anim</span>
<a id="__codelineno-30-35" name="__codelineno-30-35"></a>    <span class="n">assets</span><span class="p">[</span><span class="n">SCORE_FONT</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FNT_DIR</span><span class="p">,</span> <span class="s1">&#39;PressStart2P.ttf&#39;</span><span class="p">),</span> <span class="mi">28</span><span class="p">)</span>
<a id="__codelineno-30-36" name="__codelineno-30-36"></a>
<a id="__codelineno-30-37" name="__codelineno-30-37"></a>    <span class="c1"># Carrega os sons do jogo</span>
<a id="__codelineno-30-38" name="__codelineno-30-38"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SND_DIR</span><span class="p">,</span> <span class="s1">&#39;tgfcoder-FrozenJam-SeamlessLoop.ogg&#39;</span><span class="p">))</span>
<a id="__codelineno-30-39" name="__codelineno-30-39"></a>    <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">set_volume</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
<a id="__codelineno-30-40" name="__codelineno-30-40"></a>    <span class="n">assets</span><span class="p">[</span><span class="n">BOOM_SOUND</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SND_DIR</span><span class="p">,</span> <span class="s1">&#39;expl3.wav&#39;</span><span class="p">))</span>
<a id="__codelineno-30-41" name="__codelineno-30-41"></a>    <span class="n">assets</span><span class="p">[</span><span class="n">DESTROY_SOUND</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SND_DIR</span><span class="p">,</span> <span class="s1">&#39;expl6.wav&#39;</span><span class="p">))</span>
<a id="__codelineno-30-42" name="__codelineno-30-42"></a>    <span class="n">assets</span><span class="p">[</span><span class="n">PEW_SOUND</span><span class="p">]</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SND_DIR</span><span class="p">,</span> <span class="s1">&#39;pew.wav&#39;</span><span class="p">))</span>
<a id="__codelineno-30-43" name="__codelineno-30-43"></a>    <span class="k">return</span> <span class="n">assets</span>
</code></pre></div></td></tr></table></div>
</details>
<ul>
<li><code class="language-python highlight"><span class="n">config</span><span class="o">.</span><span class="n">py</span></code>- constantes.</li>
</ul>
<details class="info">
<summary>Código <code>referencia/config.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-31-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-31-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-31-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-31-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-31-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-31-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-31-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-31-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-31-10">10</a></span>
<span class="normal"><a href="#__codelineno-31-11">11</a></span>
<span class="normal"><a href="#__codelineno-31-12">12</a></span>
<span class="normal"><a href="#__codelineno-31-13">13</a></span>
<span class="normal"><a href="#__codelineno-31-14">14</a></span>
<span class="normal"><a href="#__codelineno-31-15">15</a></span>
<span class="normal"><a href="#__codelineno-31-16">16</a></span>
<span class="normal"><a href="#__codelineno-31-17">17</a></span>
<span class="normal"><a href="#__codelineno-31-18">18</a></span>
<span class="normal"><a href="#__codelineno-31-19">19</a></span>
<span class="normal"><a href="#__codelineno-31-20">20</a></span>
<span class="normal"><a href="#__codelineno-31-21">21</a></span>
<span class="normal"><a href="#__codelineno-31-22">22</a></span>
<span class="normal"><a href="#__codelineno-31-23">23</a></span>
<span class="normal"><a href="#__codelineno-31-24">24</a></span>
<span class="normal"><a href="#__codelineno-31-25">25</a></span>
<span class="normal"><a href="#__codelineno-31-26">26</a></span>
<span class="normal"><a href="#__codelineno-31-27">27</a></span>
<span class="normal"><a href="#__codelineno-31-28">28</a></span>
<span class="normal"><a href="#__codelineno-31-29">29</a></span>
<span class="normal"><a href="#__codelineno-31-30">30</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">path</span>
<a id="__codelineno-31-2" name="__codelineno-31-2"></a>
<a id="__codelineno-31-3" name="__codelineno-31-3"></a><span class="c1"># Estabelece a pasta que contem as figuras e sons.</span>
<a id="__codelineno-31-4" name="__codelineno-31-4"></a><span class="n">IMG_DIR</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;assets&#39;</span><span class="p">,</span> <span class="s1">&#39;img&#39;</span><span class="p">)</span>
<a id="__codelineno-31-5" name="__codelineno-31-5"></a><span class="n">SND_DIR</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;assets&#39;</span><span class="p">,</span> <span class="s1">&#39;snd&#39;</span><span class="p">)</span>
<a id="__codelineno-31-6" name="__codelineno-31-6"></a><span class="n">FNT_DIR</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;assets&#39;</span><span class="p">,</span> <span class="s1">&#39;font&#39;</span><span class="p">)</span>
<a id="__codelineno-31-7" name="__codelineno-31-7"></a>
<a id="__codelineno-31-8" name="__codelineno-31-8"></a><span class="c1"># Dados gerais do jogo.</span>
<a id="__codelineno-31-9" name="__codelineno-31-9"></a><span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">480</span> <span class="c1"># Largura da tela</span>
<a id="__codelineno-31-10" name="__codelineno-31-10"></a><span class="n">HEIGHT</span> <span class="o">=</span> <span class="mi">600</span> <span class="c1"># Altura da tela</span>
<a id="__codelineno-31-11" name="__codelineno-31-11"></a><span class="n">FPS</span> <span class="o">=</span> <span class="mi">60</span> <span class="c1"># Frames por segundo</span>
<a id="__codelineno-31-12" name="__codelineno-31-12"></a>
<a id="__codelineno-31-13" name="__codelineno-31-13"></a><span class="c1"># Define tamanhos</span>
<a id="__codelineno-31-14" name="__codelineno-31-14"></a><span class="n">METEOR_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-31-15" name="__codelineno-31-15"></a><span class="n">METEOR_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-31-16" name="__codelineno-31-16"></a><span class="n">SHIP_WIDTH</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-31-17" name="__codelineno-31-17"></a><span class="n">SHIP_HEIGHT</span> <span class="o">=</span> <span class="mi">38</span>
<a id="__codelineno-31-18" name="__codelineno-31-18"></a>
<a id="__codelineno-31-19" name="__codelineno-31-19"></a><span class="c1"># Define algumas variáveis com as cores básicas</span>
<a id="__codelineno-31-20" name="__codelineno-31-20"></a><span class="n">WHITE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<a id="__codelineno-31-21" name="__codelineno-31-21"></a><span class="n">BLACK</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-31-22" name="__codelineno-31-22"></a><span class="n">RED</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-31-23" name="__codelineno-31-23"></a><span class="n">GREEN</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-31-24" name="__codelineno-31-24"></a><span class="n">BLUE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<a id="__codelineno-31-25" name="__codelineno-31-25"></a><span class="n">YELLOW</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-31-26" name="__codelineno-31-26"></a>
<a id="__codelineno-31-27" name="__codelineno-31-27"></a><span class="c1"># Estados para controle do fluxo da aplicação</span>
<a id="__codelineno-31-28" name="__codelineno-31-28"></a><span class="n">INIT</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-31-29" name="__codelineno-31-29"></a><span class="n">GAME</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-31-30" name="__codelineno-31-30"></a><span class="n">QUIT</span> <span class="o">=</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
</details>
<p>Lembra quando precisamos de uma função da biblioteca de matemática e damos um <code class="language-python highlight"><span class="kn">import</span> <span class="nn">math</span></code>? Quando queremos utilizar um valor ou função que foi definida em outro arquivo também usamos o <code class="language-python highlight"><span class="kn">import</span></code>. Essa divisão em arquivos facilita o desenvolvimento concorrente do jogo pelos membros da equipe.</p>
<h2 id="adicionando-uma-tela-inicial">Adicionando uma tela inicial</h2>
<p>Essa refatoração toda não foi em vão. No <code class="language-python highlight"><span class="n">jogo_v22</span><span class="o">.</span><span class="n">py</span></code> vemos como essa refatoração ajudou a desenvolver uma nova tela de jogo! Vemos também o truque da máquina de estados para organizar a aplicação principal. Agora não temos muitas, linhas, mas as mudanças estão nas linhas 17 a 24.</p>
<details class="info">
<summary>Código <code>referencia/jogo_v22.py</code></summary>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-32-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-32-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-32-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-32-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-32-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-32-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-32-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-32-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-32-10">10</a></span>
<span class="normal"><a href="#__codelineno-32-11">11</a></span>
<span class="normal"><a href="#__codelineno-32-12">12</a></span>
<span class="normal"><a href="#__codelineno-32-13">13</a></span>
<span class="normal"><a href="#__codelineno-32-14">14</a></span>
<span class="normal"><a href="#__codelineno-32-15">15</a></span>
<span class="normal"><a href="#__codelineno-32-16">16</a></span>
<span class="normal"><a href="#__codelineno-32-17">17</a></span>
<span class="normal"><a href="#__codelineno-32-18">18</a></span>
<span class="normal"><a href="#__codelineno-32-19">19</a></span>
<span class="normal"><a href="#__codelineno-32-20">20</a></span>
<span class="normal"><a href="#__codelineno-32-21">21</a></span>
<span class="normal"><a href="#__codelineno-32-22">22</a></span>
<span class="normal"><a href="#__codelineno-32-23">23</a></span>
<span class="normal"><a href="#__codelineno-32-24">24</a></span>
<span class="normal"><a href="#__codelineno-32-25">25</a></span>
<span class="normal"><a href="#__codelineno-32-26">26</a></span>
<span class="normal"><a href="#__codelineno-32-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="c1"># ===== Inicialização =====</span>
<a id="__codelineno-32-2" name="__codelineno-32-2"></a><span class="c1"># ----- Importa e inicia pacotes</span>
<a id="__codelineno-32-3" name="__codelineno-32-3"></a><span class="kn">import</span> <span class="nn">pygame</span>
<a id="__codelineno-32-4" name="__codelineno-32-4"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-32-5" name="__codelineno-32-5"></a><span class="kn">from</span> <span class="nn">config</span> <span class="kn">import</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">,</span> <span class="n">INIT</span><span class="p">,</span> <span class="n">GAME</span><span class="p">,</span> <span class="n">QUIT</span>
<a id="__codelineno-32-6" name="__codelineno-32-6"></a><span class="kn">from</span> <span class="nn">init_screen</span> <span class="kn">import</span> <span class="n">init_screen</span>
<a id="__codelineno-32-7" name="__codelineno-32-7"></a><span class="kn">from</span> <span class="nn">game_screen</span> <span class="kn">import</span> <span class="n">game_screen</span>
<a id="__codelineno-32-8" name="__codelineno-32-8"></a>
<a id="__codelineno-32-9" name="__codelineno-32-9"></a>
<a id="__codelineno-32-10" name="__codelineno-32-10"></a><span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-32-11" name="__codelineno-32-11"></a><span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<a id="__codelineno-32-12" name="__codelineno-32-12"></a>
<a id="__codelineno-32-13" name="__codelineno-32-13"></a><span class="c1"># ----- Gera tela principal</span>
<a id="__codelineno-32-14" name="__codelineno-32-14"></a><span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">))</span>
<a id="__codelineno-32-15" name="__codelineno-32-15"></a><span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;Navinha&#39;</span><span class="p">)</span>
<a id="__codelineno-32-16" name="__codelineno-32-16"></a>
<a id="__codelineno-32-17" name="__codelineno-32-17"></a><span class="n">state</span> <span class="o">=</span> <span class="n">INIT</span>
<a id="__codelineno-32-18" name="__codelineno-32-18"></a><span class="k">while</span> <span class="n">state</span> <span class="o">!=</span> <span class="n">QUIT</span><span class="p">:</span>
<a id="__codelineno-32-19" name="__codelineno-32-19"></a>    <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">INIT</span><span class="p">:</span>
<a id="__codelineno-32-20" name="__codelineno-32-20"></a>        <span class="n">state</span> <span class="o">=</span> <span class="n">init_screen</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-32-21" name="__codelineno-32-21"></a>    <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="n">GAME</span><span class="p">:</span>
<a id="__codelineno-32-22" name="__codelineno-32-22"></a>        <span class="n">state</span> <span class="o">=</span> <span class="n">game_screen</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<a id="__codelineno-32-23" name="__codelineno-32-23"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-32-24" name="__codelineno-32-24"></a>        <span class="n">state</span> <span class="o">=</span> <span class="n">QUIT</span>
<a id="__codelineno-32-25" name="__codelineno-32-25"></a>
<a id="__codelineno-32-26" name="__codelineno-32-26"></a><span class="c1"># ===== Finalização =====</span>
<a id="__codelineno-32-27" name="__codelineno-32-27"></a><span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Função do PyGame que finaliza os recursos utilizados</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="admonition exercise self-progress" data-slug="pygame/handout/exercise_19" id="exercise_19_0">
<p class="admonition-title">EXERCÍCIO 19</p>
<form class="exercise-form">
<p>Modifique o <code class="language-python highlight"><span class="n">jogo_v22</span><span class="o">.</span><span class="n">py</span></code> para adicionar uma tela de game over.</p>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Enviar" value="Marcar como feito" />
</div>
</form>
</div>
<h1 id="referencias">Referências</h1>
<ul>
<li><a href="https://www.youtube.com/playlist?list=PLtxxzP8ZeBUsMrPgEbNbZ7GCAMiwoNccv">Vídeos do professor Luciano Soares</a></li>
<li><a href="https://www.pygame.org/docs/">https://www.pygame.org/docs/</a></li>
<li><a href="http://kidscancode.org/blog/2016/08/pygame_shmup_part_1/">http://kidscancode.org/blog/2016/08/pygame_shmup_part_1/</a></li>
</ul>


</section>
          
        
      </main>
      <footer class="ah-footer ah-typeset">
        <div class="ah-footer-nav">
          
            <a href="../../arquivo/handout/"
               class="ah-prev"
               title="Armazenamento permanente em arquivos">
              <span class="nav-label">Anterior</span>
              <span class="nav-title">Armazenamento permanente em arquivos</span>
            </a>
          
          
        </div>
      </footer>
    </div>
    
      <script src="../../js/tabs.js"></script><script src="../../js/termynal.js"></script><script src="../../js/custom.js"></script>
    
  </body>
</html>